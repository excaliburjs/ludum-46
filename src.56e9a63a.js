parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"rBuz":[function(require,module,exports) {
var o=Math.ceil,r=Math.floor;module.exports=function(t){return isNaN(t=+t)?0:(t>0?r:o)(t)};
},{}],"H2B4":[function(require,module,exports) {
module.exports=function(o){if(null==o)throw TypeError("Can't call method on "+o);return o};
},{}],"OMAC":[function(require,module,exports) {
var e=require("../internals/to-integer"),r=require("../internals/require-object-coercible"),t=function(t){return function(n,i){var c,o,a=String(r(n)),u=e(i),l=a.length;return u<0||u>=l?t?"":void 0:(c=a.charCodeAt(u))<55296||c>56319||u+1===l||(o=a.charCodeAt(u+1))<56320||o>57343?t?a.charAt(u):c:t?a.slice(u,u+2):o-56320+(c-55296<<10)+65536}};module.exports={codeAt:t(!1),charAt:t(!0)};
},{"../internals/to-integer":"rBuz","../internals/require-object-coercible":"H2B4"}],"RdwD":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3],o=function(t){return t&&t.Math==Math&&t};module.exports=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof t&&t)||Function("return this")();
},{}],"HhtF":[function(require,module,exports) {
module.exports=function(r){try{return!!r()}catch(t){return!0}};
},{}],"r2hA":[function(require,module,exports) {
var e=require("../internals/fails");module.exports=!e(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]});
},{"../internals/fails":"HhtF"}],"QYQv":[function(require,module,exports) {
module.exports=function(o){return"object"==typeof o?null!==o:"function"==typeof o};
},{}],"hMem":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/is-object"),t=e.document,n=r(t)&&r(t.createElement);module.exports=function(e){return n?t.createElement(e):{}};
},{"../internals/global":"RdwD","../internals/is-object":"QYQv"}],"L6FV":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/fails"),n=require("../internals/document-create-element");module.exports=!e&&!r(function(){return 7!=Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a});
},{"../internals/descriptors":"r2hA","../internals/fails":"HhtF","../internals/document-create-element":"hMem"}],"vY5p":[function(require,module,exports) {
var r=require("../internals/is-object");module.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e};
},{"../internals/is-object":"QYQv"}],"rm5K":[function(require,module,exports) {
var t=require("../internals/is-object");module.exports=function(r,e){if(!t(r))return r;var n,o;if(e&&"function"==typeof(n=r.toString)&&!t(o=n.call(r)))return o;if("function"==typeof(n=r.valueOf)&&!t(o=n.call(r)))return o;if(!e&&"function"==typeof(n=r.toString)&&!t(o=n.call(r)))return o;throw TypeError("Can't convert object to primitive value")};
},{"../internals/is-object":"QYQv"}],"lxmH":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/ie8-dom-define"),i=require("../internals/an-object"),t=require("../internals/to-primitive"),n=Object.defineProperty;exports.f=e?n:function(e,o,s){if(i(e),o=t(o,!0),i(s),r)try{return n(e,o,s)}catch(u){}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(e[o]=s.value),e};
},{"../internals/descriptors":"r2hA","../internals/ie8-dom-define":"L6FV","../internals/an-object":"vY5p","../internals/to-primitive":"rm5K"}],"aTKp":[function(require,module,exports) {
module.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}};
},{}],"XRrN":[function(require,module,exports) {
var r=require("../internals/descriptors"),e=require("../internals/object-define-property"),t=require("../internals/create-property-descriptor");module.exports=r?function(r,n,i){return e.f(r,n,t(1,i))}:function(r,e,t){return r[e]=t,r};
},{"../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH","../internals/create-property-descriptor":"aTKp"}],"AcoG":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/create-non-enumerable-property");module.exports=function(n,t){try{r(e,n,t)}catch(a){e[n]=t}return t};
},{"../internals/global":"RdwD","../internals/create-non-enumerable-property":"XRrN"}],"Q5DL":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/set-global"),l="__core-js_shared__",a=e[l]||r(l,{});module.exports=a;
},{"../internals/global":"RdwD","../internals/set-global":"AcoG"}],"dQBG":[function(require,module,exports) {
var e=require("../internals/shared-store"),n=Function.toString;"function"!=typeof e.inspectSource&&(e.inspectSource=function(e){return n.call(e)}),module.exports=e.inspectSource;
},{"../internals/shared-store":"Q5DL"}],"pMwR":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/inspect-source"),t=e.WeakMap;module.exports="function"==typeof t&&/native code/.test(r(t));
},{"../internals/global":"RdwD","../internals/inspect-source":"dQBG"}],"Gdzi":[function(require,module,exports) {
var r={}.hasOwnProperty;module.exports=function(e,n){return r.call(e,n)};
},{}],"pi8Y":[function(require,module,exports) {
module.exports=!1;
},{}],"AP6n":[function(require,module,exports) {
var r=require("../internals/is-pure"),e=require("../internals/shared-store");(module.exports=function(r,i){return e[r]||(e[r]=void 0!==i?i:{})})("versions",[]).push({version:"3.6.4",mode:r?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"});
},{"../internals/is-pure":"pi8Y","../internals/shared-store":"Q5DL"}],"aUJY":[function(require,module,exports) {
var o=0,r=Math.random();module.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++o+r).toString(36)};
},{}],"Hosz":[function(require,module,exports) {
var e=require("../internals/shared"),r=require("../internals/uid"),n=e("keys");module.exports=function(e){return n[e]||(n[e]=r(e))};
},{"../internals/shared":"AP6n","../internals/uid":"aUJY"}],"u6aE":[function(require,module,exports) {
module.exports={};
},{}],"FDlA":[function(require,module,exports) {

var e,r,n,t=require("../internals/native-weak-map"),i=require("../internals/global"),a=require("../internals/is-object"),u=require("../internals/create-non-enumerable-property"),o=require("../internals/has"),l=require("../internals/shared-key"),s=require("../internals/hidden-keys"),c=i.WeakMap,f=function(t){return n(t)?r(t):e(t,{})},p=function(e){return function(n){var t;if(!a(n)||(t=r(n)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return t}};if(t){var q=new c,h=q.get,v=q.has,d=q.set;e=function(e,r){return d.call(q,e,r),r},r=function(e){return h.call(q,e)||{}},n=function(e){return v.call(q,e)}}else{var y=l("state");s[y]=!0,e=function(e,r){return u(e,y,r),r},r=function(e){return o(e,y)?e[y]:{}},n=function(e){return o(e,y)}}module.exports={set:e,get:r,has:n,enforce:f,getterFor:p};
},{"../internals/native-weak-map":"pMwR","../internals/global":"RdwD","../internals/is-object":"QYQv","../internals/create-non-enumerable-property":"XRrN","../internals/has":"Gdzi","../internals/shared-key":"Hosz","../internals/hidden-keys":"u6aE"}],"J64n":[function(require,module,exports) {
"use strict";var r={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!r.call({1:2},1);exports.f=t?function(r){var t=e(this,r);return!!t&&t.enumerable}:r;
},{}],"oWVo":[function(require,module,exports) {
var r={}.toString;module.exports=function(t){return r.call(t).slice(8,-1)};
},{}],"wRpf":[function(require,module,exports) {
var r=require("../internals/fails"),e=require("../internals/classof-raw"),t="".split;module.exports=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(r){return"String"==e(r)?t.call(r,""):Object(r)}:Object;
},{"../internals/fails":"HhtF","../internals/classof-raw":"oWVo"}],"xooR":[function(require,module,exports) {
var e=require("../internals/indexed-object"),r=require("../internals/require-object-coercible");module.exports=function(i){return e(r(i))};
},{"../internals/indexed-object":"wRpf","../internals/require-object-coercible":"H2B4"}],"NkfH":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/object-property-is-enumerable"),i=require("../internals/create-property-descriptor"),t=require("../internals/to-indexed-object"),n=require("../internals/to-primitive"),s=require("../internals/has"),a=require("../internals/ie8-dom-define"),o=Object.getOwnPropertyDescriptor;exports.f=e?o:function(e,c){if(e=t(e),c=n(c,!0),a)try{return o(e,c)}catch(u){}if(s(e,c))return i(!r.f.call(e,c),e[c])};
},{"../internals/descriptors":"r2hA","../internals/object-property-is-enumerable":"J64n","../internals/create-property-descriptor":"aTKp","../internals/to-indexed-object":"xooR","../internals/to-primitive":"rm5K","../internals/has":"Gdzi","../internals/ie8-dom-define":"L6FV"}],"PceW":[function(require,module,exports) {

var e=require("../internals/global"),n=require("../internals/create-non-enumerable-property"),r=require("../internals/has"),t=require("../internals/set-global"),i=require("../internals/inspect-source"),o=require("../internals/internal-state"),s=o.get,a=o.enforce,u=String(String).split("String");(module.exports=function(i,o,s,l){var c=!!l&&!!l.unsafe,p=!!l&&!!l.enumerable,f=!!l&&!!l.noTargetGet;"function"==typeof s&&("string"!=typeof o||r(s,"name")||n(s,"name",o),a(s).source=u.join("string"==typeof o?o:"")),i!==e?(c?!f&&i[o]&&(p=!0):delete i[o],p?i[o]=s:n(i,o,s)):p?i[o]=s:t(o,s)})(Function.prototype,"toString",function(){return"function"==typeof this&&s(this).source||i(this)});
},{"../internals/global":"RdwD","../internals/create-non-enumerable-property":"XRrN","../internals/has":"Gdzi","../internals/set-global":"AcoG","../internals/inspect-source":"dQBG","../internals/internal-state":"FDlA"}],"FSlT":[function(require,module,exports) {

var e=require("../internals/global");module.exports=e;
},{"../internals/global":"RdwD"}],"tM1E":[function(require,module,exports) {

var n=require("../internals/path"),e=require("../internals/global"),r=function(n){return"function"==typeof n?n:void 0};module.exports=function(t,i){return arguments.length<2?r(n[t])||r(e[t]):n[t]&&n[t][i]||e[t]&&e[t][i]};
},{"../internals/path":"FSlT","../internals/global":"RdwD"}],"HnVY":[function(require,module,exports) {
var e=require("../internals/to-integer"),r=Math.min;module.exports=function(n){return n>0?r(e(n),9007199254740991):0};
},{"../internals/to-integer":"rBuz"}],"CYMe":[function(require,module,exports) {
var r=require("../internals/to-integer"),e=Math.max,t=Math.min;module.exports=function(n,a){var i=r(n);return i<0?e(i+a,0):t(i,a)};
},{"../internals/to-integer":"rBuz"}],"nH1t":[function(require,module,exports) {
var e=require("../internals/to-indexed-object"),r=require("../internals/to-length"),n=require("../internals/to-absolute-index"),t=function(t){return function(i,u,o){var l,f=e(i),s=r(f.length),a=n(o,s);if(t&&u!=u){for(;s>a;)if((l=f[a++])!=l)return!0}else for(;s>a;a++)if((t||a in f)&&f[a]===u)return t||a||0;return!t&&-1}};module.exports={includes:t(!0),indexOf:t(!1)};
},{"../internals/to-indexed-object":"xooR","../internals/to-length":"HnVY","../internals/to-absolute-index":"CYMe"}],"KrZT":[function(require,module,exports) {
var e=require("../internals/has"),r=require("../internals/to-indexed-object"),n=require("../internals/array-includes").indexOf,i=require("../internals/hidden-keys");module.exports=function(s,t){var u,a=r(s),d=0,l=[];for(u in a)!e(i,u)&&e(a,u)&&l.push(u);for(;t.length>d;)e(a,u=t[d++])&&(~n(l,u)||l.push(u));return l};
},{"../internals/has":"Gdzi","../internals/to-indexed-object":"xooR","../internals/array-includes":"nH1t","../internals/hidden-keys":"u6aE"}],"FsV0":[function(require,module,exports) {
module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];
},{}],"F6CC":[function(require,module,exports) {
var e=require("../internals/object-keys-internal"),r=require("../internals/enum-bug-keys"),t=r.concat("length","prototype");exports.f=Object.getOwnPropertyNames||function(r){return e(r,t)};
},{"../internals/object-keys-internal":"KrZT","../internals/enum-bug-keys":"FsV0"}],"TAPg":[function(require,module,exports) {
exports.f=Object.getOwnPropertySymbols;
},{}],"vYBh":[function(require,module,exports) {
var e=require("../internals/get-built-in"),r=require("../internals/object-get-own-property-names"),n=require("../internals/object-get-own-property-symbols"),t=require("../internals/an-object");module.exports=e("Reflect","ownKeys")||function(e){var o=r.f(t(e)),i=n.f;return i?o.concat(i(e)):o};
},{"../internals/get-built-in":"tM1E","../internals/object-get-own-property-names":"F6CC","../internals/object-get-own-property-symbols":"TAPg","../internals/an-object":"vY5p"}],"nWtI":[function(require,module,exports) {
var e=require("../internals/has"),r=require("../internals/own-keys"),n=require("../internals/object-get-own-property-descriptor"),t=require("../internals/object-define-property");module.exports=function(i,o){for(var a=r(o),s=t.f,l=n.f,p=0;p<a.length;p++){var u=a[p];e(i,u)||s(i,u,l(o,u))}};
},{"../internals/has":"Gdzi","../internals/own-keys":"vYBh","../internals/object-get-own-property-descriptor":"NkfH","../internals/object-define-property":"lxmH"}],"V7dp":[function(require,module,exports) {
var r=require("../internals/fails"),e=/#|\.prototype\./,t=function(e,t){var u=o[n(e)];return u==i||u!=a&&("function"==typeof t?r(t):!!t)},n=t.normalize=function(r){return String(r).replace(e,".").toLowerCase()},o=t.data={},a=t.NATIVE="N",i=t.POLYFILL="P";module.exports=t;
},{"../internals/fails":"HhtF"}],"EhLp":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/object-get-own-property-descriptor").f,t=require("../internals/create-non-enumerable-property"),n=require("../internals/redefine"),o=require("../internals/set-global"),i=require("../internals/copy-constructor-properties"),a=require("../internals/is-forced");module.exports=function(s,l){var p,u,f,c,q,d=s.target,g=s.global,y=s.stat;if(p=g?e:y?e[d]||o(d,{}):(e[d]||{}).prototype)for(u in l){if(c=l[u],f=s.noTargetGet?(q=r(p,u))&&q.value:p[u],!a(g?u:d+(y?".":"#")+u,s.forced)&&void 0!==f){if(typeof c==typeof f)continue;i(c,f)}(s.sham||f&&f.sham)&&t(c,"sham",!0),n(p,u,c,s)}};
},{"../internals/global":"RdwD","../internals/object-get-own-property-descriptor":"NkfH","../internals/create-non-enumerable-property":"XRrN","../internals/redefine":"PceW","../internals/set-global":"AcoG","../internals/copy-constructor-properties":"nWtI","../internals/is-forced":"V7dp"}],"jvja":[function(require,module,exports) {
var e=require("../internals/require-object-coercible");module.exports=function(r){return Object(e(r))};
},{"../internals/require-object-coercible":"H2B4"}],"ffM1":[function(require,module,exports) {
var t=require("../internals/fails");module.exports=!t(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype});
},{"../internals/fails":"HhtF"}],"wKQH":[function(require,module,exports) {
var t=require("../internals/has"),e=require("../internals/to-object"),r=require("../internals/shared-key"),o=require("../internals/correct-prototype-getter"),n=r("IE_PROTO"),c=Object.prototype;module.exports=o?Object.getPrototypeOf:function(r){return r=e(r),t(r,n)?r[n]:"function"==typeof r.constructor&&r instanceof r.constructor?r.constructor.prototype:r instanceof Object?c:null};
},{"../internals/has":"Gdzi","../internals/to-object":"jvja","../internals/shared-key":"Hosz","../internals/correct-prototype-getter":"ffM1"}],"SXW0":[function(require,module,exports) {
var r=require("../internals/fails");module.exports=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())});
},{"../internals/fails":"HhtF"}],"mSSr":[function(require,module,exports) {
var e=require("../internals/native-symbol");module.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator;
},{"../internals/native-symbol":"SXW0"}],"sPFN":[function(require,module,exports) {

var e=require("../internals/global"),r=require("../internals/shared"),i=require("../internals/has"),n=require("../internals/uid"),s=require("../internals/native-symbol"),t=require("../internals/use-symbol-as-uid"),l=r("wks"),u=e.Symbol,a=t?u:u&&u.withoutSetter||n;module.exports=function(e){return i(l,e)||(s&&i(u,e)?l[e]=u[e]:l[e]=a("Symbol."+e)),l[e]};
},{"../internals/global":"RdwD","../internals/shared":"AP6n","../internals/has":"Gdzi","../internals/uid":"aUJY","../internals/native-symbol":"SXW0","../internals/use-symbol-as-uid":"mSSr"}],"jbL0":[function(require,module,exports) {
"use strict";var e,r,t,n=require("../internals/object-get-prototype-of"),o=require("../internals/create-non-enumerable-property"),i=require("../internals/has"),s=require("../internals/well-known-symbol"),l=require("../internals/is-pure"),u=s("iterator"),a=!1,p=function(){return this};[].keys&&("next"in(t=[].keys())?(r=n(n(t)))!==Object.prototype&&(e=r):a=!0),null==e&&(e={}),l||i(e,u)||o(e,u,p),module.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:a};
},{"../internals/object-get-prototype-of":"wKQH","../internals/create-non-enumerable-property":"XRrN","../internals/has":"Gdzi","../internals/well-known-symbol":"sPFN","../internals/is-pure":"pi8Y"}],"tzYM":[function(require,module,exports) {
var e=require("../internals/object-keys-internal"),r=require("../internals/enum-bug-keys");module.exports=Object.keys||function(n){return e(n,r)};
},{"../internals/object-keys-internal":"KrZT","../internals/enum-bug-keys":"FsV0"}],"eVWU":[function(require,module,exports) {
var e=require("../internals/descriptors"),r=require("../internals/object-define-property"),n=require("../internals/an-object"),t=require("../internals/object-keys");module.exports=e?Object.defineProperties:function(e,i){n(e);for(var o,s=t(i),a=s.length,u=0;a>u;)r.f(e,o=s[u++],i[o]);return e};
},{"../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH","../internals/an-object":"vY5p","../internals/object-keys":"tzYM"}],"ZA3F":[function(require,module,exports) {
var e=require("../internals/get-built-in");module.exports=e("document","documentElement");
},{"../internals/get-built-in":"tM1E"}],"NYfz":[function(require,module,exports) {
var e,n=require("../internals/an-object"),r=require("../internals/object-define-properties"),t=require("../internals/enum-bug-keys"),i=require("../internals/hidden-keys"),u=require("../internals/html"),o=require("../internals/document-create-element"),c=require("../internals/shared-key"),l=">",a="<",s="prototype",d="script",m=c("IE_PROTO"),p=function(){},f=function(e){return a+d+l+e+a+"/"+d+l},v=function(e){e.write(f("")),e.close();var n=e.parentWindow.Object;return e=null,n},b=function(){var e,n=o("iframe"),r="java"+d+":";return n.style.display="none",u.appendChild(n),n.src=String(r),(e=n.contentWindow.document).open(),e.write(f("document.F=Object")),e.close(),e.F},h=function(){try{e=document.domain&&new ActiveXObject("htmlfile")}catch(r){}h=e?v(e):b();for(var n=t.length;n--;)delete h[s][t[n]];return h()};i[m]=!0,module.exports=Object.create||function(e,t){var i;return null!==e?(p[s]=n(e),i=new p,p[s]=null,i[m]=e):i=h(),void 0===t?i:r(i,t)};
},{"../internals/an-object":"vY5p","../internals/object-define-properties":"eVWU","../internals/enum-bug-keys":"FsV0","../internals/hidden-keys":"u6aE","../internals/html":"ZA3F","../internals/document-create-element":"hMem","../internals/shared-key":"Hosz"}],"F3Dn":[function(require,module,exports) {
var e=require("../internals/object-define-property").f,r=require("../internals/has"),n=require("../internals/well-known-symbol"),o=n("toStringTag");module.exports=function(n,t,i){n&&!r(n=i?n:n.prototype,o)&&e(n,o,{configurable:!0,value:t})};
},{"../internals/object-define-property":"lxmH","../internals/has":"Gdzi","../internals/well-known-symbol":"sPFN"}],"N9YG":[function(require,module,exports) {
"use strict";var r=require("../internals/iterators-core").IteratorPrototype,e=require("../internals/object-create"),t=require("../internals/create-property-descriptor"),i=require("../internals/set-to-string-tag"),n=require("../internals/iterators"),o=function(){return this};module.exports=function(a,s,u){var c=s+" Iterator";return a.prototype=e(r,{next:t(1,u)}),i(a,c,!1,!0),n[c]=o,a};
},{"../internals/iterators-core":"jbL0","../internals/object-create":"NYfz","../internals/create-property-descriptor":"aTKp","../internals/set-to-string-tag":"F3Dn","../internals/iterators":"u6aE"}],"zP4J":[function(require,module,exports) {
var r=require("../internals/is-object");module.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t};
},{"../internals/is-object":"QYQv"}],"nEq4":[function(require,module,exports) {
var t=require("../internals/an-object"),r=require("../internals/a-possible-prototype");module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,o=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),o=n instanceof Array}catch(c){}return function(n,c){return t(n),r(c),o?e.call(n,c):n.__proto__=c,n}}():void 0);
},{"../internals/an-object":"vY5p","../internals/a-possible-prototype":"zP4J"}],"A0h2":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/create-iterator-constructor"),t=require("../internals/object-get-prototype-of"),n=require("../internals/object-set-prototype-of"),i=require("../internals/set-to-string-tag"),o=require("../internals/create-non-enumerable-property"),s=require("../internals/redefine"),a=require("../internals/well-known-symbol"),u=require("../internals/is-pure"),c=require("../internals/iterators"),l=require("../internals/iterators-core"),f=l.IteratorPrototype,p=l.BUGGY_SAFARI_ITERATORS,q=a("iterator"),y="keys",w="values",b="entries",h=function(){return this};module.exports=function(a,l,g,m,v,A,I){r(g,l,m);var d,j,k,x=function(e){if(e===v&&T)return T;if(!p&&e in O)return O[e];switch(e){case y:case w:case b:return function(){return new g(this,e)}}return function(){return new g(this)}},R=l+" Iterator",G=!1,O=a.prototype,S=O[q]||O["@@iterator"]||v&&O[v],T=!p&&S||x(v),_="Array"==l&&O.entries||S;if(_&&(d=t(_.call(new a)),f!==Object.prototype&&d.next&&(u||t(d)===f||(n?n(d,f):"function"!=typeof d[q]&&o(d,q,h)),i(d,R,!0,!0),u&&(c[R]=h))),v==w&&S&&S.name!==w&&(G=!0,T=function(){return S.call(this)}),u&&!I||O[q]===T||o(O,q,T),c[l]=T,v)if(j={values:x(w),keys:A?T:x(y),entries:x(b)},I)for(k in j)!p&&!G&&k in O||s(O,k,j[k]);else e({target:l,proto:!0,forced:p||G},j);return j};
},{"../internals/export":"EhLp","../internals/create-iterator-constructor":"N9YG","../internals/object-get-prototype-of":"wKQH","../internals/object-set-prototype-of":"nEq4","../internals/set-to-string-tag":"F3Dn","../internals/create-non-enumerable-property":"XRrN","../internals/redefine":"PceW","../internals/well-known-symbol":"sPFN","../internals/is-pure":"pi8Y","../internals/iterators":"u6aE","../internals/iterators-core":"jbL0"}],"DV5e":[function(require,module,exports) {
"use strict";var t=require("../internals/string-multibyte").charAt,e=require("../internals/internal-state"),r=require("../internals/define-iterator"),n="String Iterator",i=e.set,a=e.getterFor(n);r(String,"String",function(t){i(this,{type:n,string:String(t),index:0})},function(){var e,r=a(this),n=r.string,i=r.index;return i>=n.length?{value:void 0,done:!0}:(e=t(n,i),r.index+=e.length,{value:e,done:!1})});
},{"../internals/string-multibyte":"OMAC","../internals/internal-state":"FDlA","../internals/define-iterator":"A0h2"}],"aHwm":[function(require,module,exports) {
module.exports=function(n){if("function"!=typeof n)throw TypeError(String(n)+" is not a function");return n};
},{}],"hoEO":[function(require,module,exports) {
var n=require("../internals/a-function");module.exports=function(r,t,e){if(n(r),void 0===t)return r;switch(e){case 0:return function(){return r.call(t)};case 1:return function(n){return r.call(t,n)};case 2:return function(n,e){return r.call(t,n,e)};case 3:return function(n,e,u){return r.call(t,n,e,u)}}return function(){return r.apply(t,arguments)}};
},{"../internals/a-function":"aHwm"}],"I2rg":[function(require,module,exports) {
var r=require("../internals/an-object");module.exports=function(t,e,n,a){try{return a?e(r(n)[0],n[1]):e(n)}catch(c){var o=t.return;throw void 0!==o&&r(o.call(t)),c}};
},{"../internals/an-object":"vY5p"}],"YCBX":[function(require,module,exports) {
var r=require("../internals/well-known-symbol"),e=require("../internals/iterators"),t=r("iterator"),o=Array.prototype;module.exports=function(r){return void 0!==r&&(e.Array===r||o[t]===r)};
},{"../internals/well-known-symbol":"sPFN","../internals/iterators":"u6aE"}],"cfb1":[function(require,module,exports) {
"use strict";var e=require("../internals/to-primitive"),r=require("../internals/object-define-property"),i=require("../internals/create-property-descriptor");module.exports=function(t,n,o){var p=e(n);p in t?r.f(t,p,i(0,o)):t[p]=o};
},{"../internals/to-primitive":"rm5K","../internals/object-define-property":"lxmH","../internals/create-property-descriptor":"aTKp"}],"YSRT":[function(require,module,exports) {
var e=require("../internals/well-known-symbol"),r=e("toStringTag"),n={};n[r]="z",module.exports="[object z]"===String(n);
},{"../internals/well-known-symbol":"sPFN"}],"ENb8":[function(require,module,exports) {
var n=require("../internals/to-string-tag-support"),r=require("../internals/classof-raw"),t=require("../internals/well-known-symbol"),e=t("toStringTag"),u="Arguments"==r(function(){return arguments}()),i=function(n,r){try{return n[r]}catch(t){}};module.exports=n?r:function(n){var t,o,l;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(o=i(t=Object(n),e))?o:u?r(t):"Object"==(l=r(t))&&"function"==typeof t.callee?"Arguments":l};
},{"../internals/to-string-tag-support":"YSRT","../internals/classof-raw":"oWVo","../internals/well-known-symbol":"sPFN"}],"OSUf":[function(require,module,exports) {
var r=require("../internals/classof"),e=require("../internals/iterators"),n=require("../internals/well-known-symbol"),t=n("iterator");module.exports=function(n){if(null!=n)return n[t]||n["@@iterator"]||e[r(n)]};
},{"../internals/classof":"ENb8","../internals/iterators":"u6aE","../internals/well-known-symbol":"sPFN"}],"J8mD":[function(require,module,exports) {
"use strict";var e=require("../internals/function-bind-context"),r=require("../internals/to-object"),t=require("../internals/call-with-safe-iteration-closing"),n=require("../internals/is-array-iterator-method"),i=require("../internals/to-length"),l=require("../internals/create-property"),a=require("../internals/get-iterator-method");module.exports=function(o){var s,u,c,h,d,f,q=r(o),v="function"==typeof this?this:Array,g=arguments.length,y=g>1?arguments[1]:void 0,p=void 0!==y,m=a(q),w=0;if(p&&(y=e(y,g>2?arguments[2]:void 0,2)),null==m||v==Array&&n(m))for(u=new v(s=i(q.length));s>w;w++)f=p?y(q[w],w):q[w],l(u,w,f);else for(d=(h=m.call(q)).next,u=new v;!(c=d.call(h)).done;w++)f=p?t(h,y,[c.value,w],!0):c.value,l(u,w,f);return u.length=w,u};
},{"../internals/function-bind-context":"hoEO","../internals/to-object":"jvja","../internals/call-with-safe-iteration-closing":"I2rg","../internals/is-array-iterator-method":"YCBX","../internals/to-length":"HnVY","../internals/create-property":"cfb1","../internals/get-iterator-method":"OSUf"}],"lybY":[function(require,module,exports) {
var r=require("../internals/well-known-symbol"),n=r("iterator"),t=!1;try{var e=0,o={next:function(){return{done:!!e++}},return:function(){t=!0}};o[n]=function(){return this},Array.from(o,function(){throw 2})}catch(u){}module.exports=function(r,e){if(!e&&!t)return!1;var o=!1;try{var i={};i[n]=function(){return{next:function(){return{done:o=!0}}}},r(i)}catch(u){}return o};
},{"../internals/well-known-symbol":"sPFN"}],"mYO5":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-from"),t=require("../internals/check-correctness-of-iteration"),a=!t(function(r){Array.from(r)});r({target:"Array",stat:!0,forced:a},{from:e});
},{"../internals/export":"EhLp","../internals/array-from":"J8mD","../internals/check-correctness-of-iteration":"lybY"}],"kQZP":[function(require,module,exports) {
var r=require("../internals/classof-raw");module.exports=Array.isArray||function(a){return"Array"==r(a)};
},{"../internals/classof-raw":"oWVo"}],"Kgm1":[function(require,module,exports) {
var r=require("../internals/export"),a=require("../internals/is-array");r({target:"Array",stat:!0},{isArray:a});
},{"../internals/export":"EhLp","../internals/is-array":"kQZP"}],"jmYt":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),t=require("../internals/fails"),e=require("../internals/create-property"),n=t(function(){function r(){}return!(Array.of.call(r)instanceof r)});r({target:"Array",stat:!0,forced:n},{of:function(){for(var r=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>r;)e(n,r,arguments[r++]);return n.length=t,n}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/create-property":"cfb1"}],"L85L":[function(require,module,exports) {
var r=require("../internals/is-object"),e=require("../internals/is-array"),n=require("../internals/well-known-symbol"),o=n("species");module.exports=function(n,i){var t;return e(n)&&("function"!=typeof(t=n.constructor)||t!==Array&&!e(t.prototype)?r(t)&&null===(t=t[o])&&(t=void 0):t=void 0),new(void 0===t?Array:t)(0===i?0:i)};
},{"../internals/is-object":"QYQv","../internals/is-array":"kQZP","../internals/well-known-symbol":"sPFN"}],"rPED":[function(require,module,exports) {
var e=require("../internals/get-built-in");module.exports=e("navigator","userAgent")||"";
},{"../internals/get-built-in":"tM1E"}],"o3qS":[function(require,module,exports) {


var e,r,s=require("../internals/global"),n=require("../internals/engine-user-agent"),a=s.process,i=a&&a.versions,t=i&&i.v8;t?r=(e=t.split("."))[0]+e[1]:n&&(!(e=n.match(/Edge\/(\d+)/))||e[1]>=74)&&(e=n.match(/Chrome\/(\d+)/))&&(r=e[1]),module.exports=r&&+r;
},{"../internals/global":"RdwD","../internals/engine-user-agent":"rPED"}],"JnhI":[function(require,module,exports) {
var n=require("../internals/fails"),e=require("../internals/well-known-symbol"),r=require("../internals/engine-v8-version"),o=e("species");module.exports=function(e){return r>=51||!n(function(){var n=[];return(n.constructor={})[o]=function(){return{foo:1}},1!==n[e](Boolean).foo})};
},{"../internals/fails":"HhtF","../internals/well-known-symbol":"sPFN","../internals/engine-v8-version":"o3qS"}],"bupr":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/fails"),n=require("../internals/is-array"),t=require("../internals/is-object"),i=require("../internals/to-object"),a=require("../internals/to-length"),o=require("../internals/create-property"),s=require("../internals/array-species-create"),l=require("../internals/array-method-has-species-support"),u=require("../internals/well-known-symbol"),c=require("../internals/engine-v8-version"),f=u("isConcatSpreadable"),p=9007199254740991,q="Maximum allowed index exceeded",h=c>=51||!e(function(){var r=[];return r[f]=!1,r.concat()[0]!==r}),d=l("concat"),y=function(r){if(!t(r))return!1;var e=r[f];return void 0!==e?!!e:n(r)},v=!h||!d;r({target:"Array",proto:!0,forced:v},{concat:function(r){var e,n,t,l,u,c=i(this),f=s(c,0),h=0;for(e=-1,t=arguments.length;e<t;e++)if(u=-1===e?c:arguments[e],y(u)){if(h+(l=a(u.length))>p)throw TypeError(q);for(n=0;n<l;n++,h++)n in u&&o(f,h,u[n])}else{if(h>=p)throw TypeError(q);o(f,h++,u)}return f.length=h,f}});
},{"../internals/export":"EhLp","../internals/fails":"HhtF","../internals/is-array":"kQZP","../internals/is-object":"QYQv","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/create-property":"cfb1","../internals/array-species-create":"L85L","../internals/array-method-has-species-support":"JnhI","../internals/well-known-symbol":"sPFN","../internals/engine-v8-version":"o3qS"}],"l1VS":[function(require,module,exports) {
"use strict";var e=require("../internals/to-object"),t=require("../internals/to-absolute-index"),i=require("../internals/to-length"),n=Math.min;module.exports=[].copyWithin||function(r,o){var l=e(this),s=i(l.length),u=t(r,s),a=t(o,s),h=arguments.length>2?arguments[2]:void 0,d=n((void 0===h?s:t(h,s))-a,s-u),c=1;for(a<u&&u<a+d&&(c=-1,a+=d-1,u+=d-1);d-- >0;)a in l?l[u]=l[a]:delete l[u],u+=c,a+=c;return l};
},{"../internals/to-object":"jvja","../internals/to-absolute-index":"CYMe","../internals/to-length":"HnVY"}],"xpMP":[function(require,module,exports) {
var e=require("../internals/well-known-symbol"),r=require("../internals/object-create"),n=require("../internals/object-define-property"),l=e("unscopables"),o=Array.prototype;null==o[l]&&n.f(o,l,{configurable:!0,value:r(null)}),module.exports=function(e){o[l][e]=!0};
},{"../internals/well-known-symbol":"sPFN","../internals/object-create":"NYfz","../internals/object-define-property":"lxmH"}],"vMH9":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-copy-within"),i=require("../internals/add-to-unscopables");r({target:"Array",proto:!0},{copyWithin:e}),i("copyWithin");
},{"../internals/export":"EhLp","../internals/array-copy-within":"l1VS","../internals/add-to-unscopables":"xpMP"}],"GJih":[function(require,module,exports) {
var e=require("../internals/function-bind-context"),r=require("../internals/indexed-object"),n=require("../internals/to-object"),i=require("../internals/to-length"),t=require("../internals/array-species-create"),a=[].push,s=function(s){var u=1==s,c=2==s,o=3==s,l=4==s,f=6==s,d=5==s||f;return function(h,q,v,p){for(var x,b,m=n(h),g=r(m),j=e(q,v,3),y=i(g.length),w=0,E=p||t,I=u?E(h,y):c?E(h,0):void 0;y>w;w++)if((d||w in g)&&(b=j(x=g[w],w,m),s))if(u)I[w]=b;else if(b)switch(s){case 3:return!0;case 5:return x;case 6:return w;case 2:a.call(I,x)}else if(l)return!1;return f?-1:o||l?l:I}};module.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6)};
},{"../internals/function-bind-context":"hoEO","../internals/indexed-object":"wRpf","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/array-species-create":"L85L"}],"MTB4":[function(require,module,exports) {
"use strict";var n=require("../internals/fails");module.exports=function(r,t){var u=[][r];return!!u&&n(function(){u.call(null,t||function(){throw 1},1)})};
},{"../internals/fails":"HhtF"}],"kEKL":[function(require,module,exports) {
var r=require("../internals/descriptors"),e=require("../internals/fails"),n=require("../internals/has"),t=Object.defineProperty,i={},u=function(r){throw r};module.exports=function(a,l){if(n(i,a))return i[a];l||(l={});var o=[][a],s=!!n(l,"ACCESSORS")&&l.ACCESSORS,f=n(l,0)?l[0]:u,c=n(l,1)?l[1]:void 0;return i[a]=!!o&&!e(function(){if(s&&!r)return!0;var e={length:-1};s?t(e,1,{enumerable:!0,get:u}):e[1]=1,o.call(e,f,c)})};
},{"../internals/descriptors":"r2hA","../internals/fails":"HhtF","../internals/has":"Gdzi"}],"wJSt":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").every,t=require("../internals/array-method-is-strict"),i=require("../internals/array-method-uses-to-length"),a=t("every"),n=i("every");r({target:"Array",proto:!0,forced:!a||!n},{every:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"Mbic":[function(require,module,exports) {
"use strict";var e=require("../internals/to-object"),t=require("../internals/to-absolute-index"),r=require("../internals/to-length");module.exports=function(i){for(var n=e(this),o=r(n.length),l=arguments.length,s=t(l>1?arguments[1]:void 0,o),u=l>2?arguments[2]:void 0,a=void 0===u?o:t(u,o);a>s;)n[s++]=i;return n};
},{"../internals/to-object":"jvja","../internals/to-absolute-index":"CYMe","../internals/to-length":"HnVY"}],"SShL":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-fill"),a=require("../internals/add-to-unscopables");r({target:"Array",proto:!0},{fill:e}),a("fill");
},{"../internals/export":"EhLp","../internals/array-fill":"Mbic","../internals/add-to-unscopables":"xpMP"}],"uVzF":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").filter,t=require("../internals/array-method-has-species-support"),i=require("../internals/array-method-uses-to-length"),a=t("filter"),n=i("filter");r({target:"Array",proto:!0,forced:!a||!n},{filter:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-has-species-support":"JnhI","../internals/array-method-uses-to-length":"kEKL"}],"Iz1a":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").find,n=require("../internals/add-to-unscopables"),t=require("../internals/array-method-uses-to-length"),i="find",a=!0,o=t(i);i in[]&&Array(1)[i](function(){a=!1}),r({target:"Array",proto:!0,forced:a||!o},{find:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}}),n(i);
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/add-to-unscopables":"xpMP","../internals/array-method-uses-to-length":"kEKL"}],"MqTg":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").findIndex,n=require("../internals/add-to-unscopables"),t=require("../internals/array-method-uses-to-length"),i="findIndex",a=!0,o=t(i);i in[]&&Array(1)[i](function(){a=!1}),r({target:"Array",proto:!0,forced:a||!o},{findIndex:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}}),n(i);
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/add-to-unscopables":"xpMP","../internals/array-method-uses-to-length":"kEKL"}],"QH08":[function(require,module,exports) {
"use strict";var e=require("../internals/is-array"),r=require("../internals/to-length"),t=require("../internals/function-bind-context"),n=function(i,a,l,o,s,u,c,f){for(var h,d=s,g=0,p=!!c&&t(c,f,3);g<o;){if(g in l){if(h=p?p(l[g],g,a):l[g],u>0&&e(h))d=n(i,a,h,r(h.length),d,u-1)-1;else{if(d>=9007199254740991)throw TypeError("Exceed the acceptable array length");i[d]=h}d++}g++}return d};module.exports=n;
},{"../internals/is-array":"kQZP","../internals/to-length":"HnVY","../internals/function-bind-context":"hoEO"}],"iI6T":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/flatten-into-array"),t=require("../internals/to-object"),n=require("../internals/to-length"),i=require("../internals/to-integer"),a=require("../internals/array-species-create");e({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,l=t(this),o=n(l.length),s=a(l,0);return s.length=r(s,l,l,o,0,void 0===e?1:i(e)),s}});
},{"../internals/export":"EhLp","../internals/flatten-into-array":"QH08","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/to-integer":"rBuz","../internals/array-species-create":"L85L"}],"T996":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/flatten-into-array"),t=require("../internals/to-object"),n=require("../internals/to-length"),a=require("../internals/a-function"),i=require("../internals/array-species-create");r({target:"Array",proto:!0},{flatMap:function(r){var l,s=t(this),o=n(s.length);return a(r),(l=i(s,0)).length=e(l,s,s,o,0,1,r,arguments.length>1?arguments[1]:void 0),l}});
},{"../internals/export":"EhLp","../internals/flatten-into-array":"QH08","../internals/to-object":"jvja","../internals/to-length":"HnVY","../internals/a-function":"aHwm","../internals/array-species-create":"L85L"}],"S2cL":[function(require,module,exports) {
"use strict";var r=require("../internals/array-iteration").forEach,e=require("../internals/array-method-is-strict"),t=require("../internals/array-method-uses-to-length"),a=e("forEach"),i=t("forEach");module.exports=a&&i?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)};
},{"../internals/array-iteration":"GJih","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"FQOo":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-for-each");r({target:"Array",proto:!0,forced:[].forEach!=e},{forEach:e});
},{"../internals/export":"EhLp","../internals/array-for-each":"S2cL"}],"QP13":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/array-includes").includes,n=require("../internals/add-to-unscopables"),t=require("../internals/array-method-uses-to-length"),i=t("indexOf",{ACCESSORS:!0,1:0});e({target:"Array",proto:!0,forced:!i},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n("includes");
},{"../internals/export":"EhLp","../internals/array-includes":"nH1t","../internals/add-to-unscopables":"xpMP","../internals/array-method-uses-to-length":"kEKL"}],"NlZ3":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/array-includes").indexOf,i=require("../internals/array-method-is-strict"),t=require("../internals/array-method-uses-to-length"),n=[].indexOf,a=!!n&&1/[1].indexOf(1,-0)<0,s=i("indexOf"),d=t("indexOf",{ACCESSORS:!0,1:0});e({target:"Array",proto:!0,forced:a||!s||!d},{indexOf:function(e){return a?n.apply(this,arguments)||0:r(this,e,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-includes":"nH1t","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"nY8y":[function(require,module,exports) {
"use strict";var e=require("../internals/to-indexed-object"),r=require("../internals/add-to-unscopables"),t=require("../internals/iterators"),n=require("../internals/internal-state"),a=require("../internals/define-iterator"),i="Array Iterator",s=n.set,u=n.getterFor(i);module.exports=a(Array,"Array",function(r,t){s(this,{type:i,target:e(r),index:0,kind:t})},function(){var e=u(this),r=e.target,t=e.kind,n=e.index++;return!r||n>=r.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==t?{value:n,done:!1}:"values"==t?{value:r[n],done:!1}:{value:[n,r[n]],done:!1}},"values"),t.Arguments=t.Array,r("keys"),r("values"),r("entries");
},{"../internals/to-indexed-object":"xooR","../internals/add-to-unscopables":"xpMP","../internals/iterators":"u6aE","../internals/internal-state":"FDlA","../internals/define-iterator":"A0h2"}],"aWLa":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/indexed-object"),t=require("../internals/to-indexed-object"),i=require("../internals/array-method-is-strict"),n=[].join,o=r!=Object,a=i("join",",");e({target:"Array",proto:!0,forced:o||!a},{join:function(e){return n.call(t(this),void 0===e?",":e)}});
},{"../internals/export":"EhLp","../internals/indexed-object":"wRpf","../internals/to-indexed-object":"xooR","../internals/array-method-is-strict":"MTB4"}],"lRdU":[function(require,module,exports) {
"use strict";var e=require("../internals/to-indexed-object"),r=require("../internals/to-integer"),t=require("../internals/to-length"),n=require("../internals/array-method-is-strict"),i=require("../internals/array-method-uses-to-length"),s=Math.min,a=[].lastIndexOf,l=!!a&&1/[1].lastIndexOf(1,-0)<0,u=n("lastIndexOf"),o=i("indexOf",{ACCESSORS:!0,1:0}),d=l||!u||!o;module.exports=d?function(n){if(l)return a.apply(this,arguments)||0;var i=e(this),u=t(i.length),o=u-1;for(arguments.length>1&&(o=s(o,r(arguments[1]))),o<0&&(o=u+o);o>=0;o--)if(o in i&&i[o]===n)return o||0;return-1}:a;
},{"../internals/to-indexed-object":"xooR","../internals/to-integer":"rBuz","../internals/to-length":"HnVY","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"MPaF":[function(require,module,exports) {
var r=require("../internals/export"),e=require("../internals/array-last-index-of");r({target:"Array",proto:!0,forced:e!==[].lastIndexOf},{lastIndexOf:e});
},{"../internals/export":"EhLp","../internals/array-last-index-of":"lRdU"}],"rc2N":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").map,t=require("../internals/array-method-has-species-support"),a=require("../internals/array-method-uses-to-length"),i=t("map"),n=a("map");r({target:"Array",proto:!0,forced:!i||!n},{map:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-has-species-support":"JnhI","../internals/array-method-uses-to-length":"kEKL"}],"VKCE":[function(require,module,exports) {
var e=require("../internals/a-function"),r=require("../internals/to-object"),n=require("../internals/indexed-object"),i=require("../internals/to-length"),t=function(t){return function(o,a,u,f){e(a);var l=r(o),c=n(l),h=i(l.length),s=t?h-1:0,d=t?-1:1;if(u<2)for(;;){if(s in c){f=c[s],s+=d;break}if(s+=d,t?s<0:h<=s)throw TypeError("Reduce of empty array with no initial value")}for(;t?s>=0:h>s;s+=d)s in c&&(f=a(f,c[s],s,l));return f}};module.exports={left:t(!1),right:t(!0)};
},{"../internals/a-function":"aHwm","../internals/to-object":"jvja","../internals/indexed-object":"wRpf","../internals/to-length":"HnVY"}],"Q91u":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-reduce").left,t=require("../internals/array-method-is-strict"),i=require("../internals/array-method-uses-to-length"),n=t("reduce"),a=i("reduce",{1:0});r({target:"Array",proto:!0,forced:!n||!a},{reduce:function(r){return e(this,r,arguments.length,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-reduce":"VKCE","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"xGpa":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-reduce").right,t=require("../internals/array-method-is-strict"),i=require("../internals/array-method-uses-to-length"),n=t("reduceRight"),a=i("reduce",{1:0});r({target:"Array",proto:!0,forced:!n||!a},{reduceRight:function(r){return e(this,r,arguments.length,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-reduce":"VKCE","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"jABb":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/is-array"),t=[].reverse,i=[1,2];r({target:"Array",proto:!0,forced:String(i)===String(i.reverse())},{reverse:function(){return e(this)&&(this.length=this.length),t.call(this)}});
},{"../internals/export":"EhLp","../internals/is-array":"kQZP"}],"EKbL":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/is-object"),t=require("../internals/is-array"),i=require("../internals/to-absolute-index"),n=require("../internals/to-length"),o=require("../internals/to-indexed-object"),s=require("../internals/create-property"),a=require("../internals/well-known-symbol"),l=require("../internals/array-method-has-species-support"),u=require("../internals/array-method-uses-to-length"),c=l("slice"),d=u("slice",{ACCESSORS:!0,0:0,1:2}),p=a("species"),y=[].slice,q=Math.max;e({target:"Array",proto:!0,forced:!c||!d},{slice:function(e,a){var l,u,c,d=o(this),h=n(d.length),v=i(e,h),f=i(void 0===a?h:a,h);if(t(d)&&("function"!=typeof(l=d.constructor)||l!==Array&&!t(l.prototype)?r(l)&&null===(l=l[p])&&(l=void 0):l=void 0,l===Array||void 0===l))return y.call(d,v,f);for(u=new(void 0===l?Array:l)(q(f-v,0)),c=0;v<f;v++,c++)v in d&&s(u,c,d[v]);return u.length=c,u}});
},{"../internals/export":"EhLp","../internals/is-object":"QYQv","../internals/is-array":"kQZP","../internals/to-absolute-index":"CYMe","../internals/to-length":"HnVY","../internals/to-indexed-object":"xooR","../internals/create-property":"cfb1","../internals/well-known-symbol":"sPFN","../internals/array-method-has-species-support":"JnhI","../internals/array-method-uses-to-length":"kEKL"}],"Zq1i":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),e=require("../internals/array-iteration").some,t=require("../internals/array-method-is-strict"),i=require("../internals/array-method-uses-to-length"),s=t("some"),a=i("some");r({target:"Array",proto:!0,forced:!s||!a},{some:function(r){return e(this,r,arguments.length>1?arguments[1]:void 0)}});
},{"../internals/export":"EhLp","../internals/array-iteration":"GJih","../internals/array-method-is-strict":"MTB4","../internals/array-method-uses-to-length":"kEKL"}],"iAXB":[function(require,module,exports) {
"use strict";var r=require("../internals/export"),t=require("../internals/a-function"),e=require("../internals/to-object"),i=require("../internals/fails"),n=require("../internals/array-method-is-strict"),o=[],s=o.sort,a=i(function(){o.sort(void 0)}),l=i(function(){o.sort(null)}),u=n("sort"),c=a||!l||!u;r({target:"Array",proto:!0,forced:c},{sort:function(r){return void 0===r?s.call(e(this)):s.call(e(this),t(r))}});
},{"../internals/export":"EhLp","../internals/a-function":"aHwm","../internals/to-object":"jvja","../internals/fails":"HhtF","../internals/array-method-is-strict":"MTB4"}],"mlrj":[function(require,module,exports) {
"use strict";var e=require("../internals/get-built-in"),r=require("../internals/object-define-property"),i=require("../internals/well-known-symbol"),n=require("../internals/descriptors"),t=i("species");module.exports=function(i){var s=e(i),u=r.f;n&&s&&!s[t]&&u(s,t,{configurable:!0,get:function(){return this}})};
},{"../internals/get-built-in":"tM1E","../internals/object-define-property":"lxmH","../internals/well-known-symbol":"sPFN","../internals/descriptors":"r2hA"}],"x9kn":[function(require,module,exports) {
var e=require("../internals/set-species");e("Array");
},{"../internals/set-species":"mlrj"}],"j0jg":[function(require,module,exports) {
"use strict";var e=require("../internals/export"),r=require("../internals/to-absolute-index"),t=require("../internals/to-integer"),i=require("../internals/to-length"),n=require("../internals/to-object"),a=require("../internals/array-species-create"),l=require("../internals/create-property"),s=require("../internals/array-method-has-species-support"),o=require("../internals/array-method-uses-to-length"),u=s("splice"),h=o("splice",{ACCESSORS:!0,0:0,1:2}),c=Math.max,p=Math.min,d=9007199254740991,f="Maximum allowed length exceeded";e({target:"Array",proto:!0,forced:!u||!h},{splice:function(e,s){var o,u,h,g,q,m,y=n(this),x=i(y.length),M=r(e,x),S=arguments.length;if(0===S?o=u=0:1===S?(o=0,u=x-M):(o=S-2,u=p(c(t(s),0),x-M)),x+o-u>d)throw TypeError(f);for(h=a(y,u),g=0;g<u;g++)(q=M+g)in y&&l(h,g,y[q]);if(h.length=u,o<u){for(g=M;g<x-u;g++)m=g+o,(q=g+u)in y?y[m]=y[q]:delete y[m];for(g=x;g>x-u+o;g--)delete y[g-1]}else if(o>u)for(g=x-u;g>M;g--)m=g+o-1,(q=g+u-1)in y?y[m]=y[q]:delete y[m];for(g=0;g<o;g++)y[g+M]=arguments[g+2];return y.length=x-u+o,h}});
},{"../internals/export":"EhLp","../internals/to-absolute-index":"CYMe","../internals/to-integer":"rBuz","../internals/to-length":"HnVY","../internals/to-object":"jvja","../internals/array-species-create":"L85L","../internals/create-property":"cfb1","../internals/array-method-has-species-support":"JnhI","../internals/array-method-uses-to-length":"kEKL"}],"LG5H":[function(require,module,exports) {
var a=require("../internals/add-to-unscopables");a("flat");
},{"../internals/add-to-unscopables":"xpMP"}],"fx1r":[function(require,module,exports) {
var a=require("../internals/add-to-unscopables");a("flatMap");
},{"../internals/add-to-unscopables":"xpMP"}],"I7hB":[function(require,module,exports) {
require("../../modules/es.string.iterator"),require("../../modules/es.array.from"),require("../../modules/es.array.is-array"),require("../../modules/es.array.of"),require("../../modules/es.array.concat"),require("../../modules/es.array.copy-within"),require("../../modules/es.array.every"),require("../../modules/es.array.fill"),require("../../modules/es.array.filter"),require("../../modules/es.array.find"),require("../../modules/es.array.find-index"),require("../../modules/es.array.flat"),require("../../modules/es.array.flat-map"),require("../../modules/es.array.for-each"),require("../../modules/es.array.includes"),require("../../modules/es.array.index-of"),require("../../modules/es.array.iterator"),require("../../modules/es.array.join"),require("../../modules/es.array.last-index-of"),require("../../modules/es.array.map"),require("../../modules/es.array.reduce"),require("../../modules/es.array.reduce-right"),require("../../modules/es.array.reverse"),require("../../modules/es.array.slice"),require("../../modules/es.array.some"),require("../../modules/es.array.sort"),require("../../modules/es.array.species"),require("../../modules/es.array.splice"),require("../../modules/es.array.unscopables.flat"),require("../../modules/es.array.unscopables.flat-map");var e=require("../../internals/path");module.exports=e.Array;
},{"../../modules/es.string.iterator":"DV5e","../../modules/es.array.from":"mYO5","../../modules/es.array.is-array":"Kgm1","../../modules/es.array.of":"jmYt","../../modules/es.array.concat":"bupr","../../modules/es.array.copy-within":"vMH9","../../modules/es.array.every":"wJSt","../../modules/es.array.fill":"SShL","../../modules/es.array.filter":"uVzF","../../modules/es.array.find":"Iz1a","../../modules/es.array.find-index":"MqTg","../../modules/es.array.flat":"iI6T","../../modules/es.array.flat-map":"T996","../../modules/es.array.for-each":"FQOo","../../modules/es.array.includes":"QP13","../../modules/es.array.index-of":"NlZ3","../../modules/es.array.iterator":"nY8y","../../modules/es.array.join":"aWLa","../../modules/es.array.last-index-of":"MPaF","../../modules/es.array.map":"rc2N","../../modules/es.array.reduce":"Q91u","../../modules/es.array.reduce-right":"xGpa","../../modules/es.array.reverse":"jABb","../../modules/es.array.slice":"EKbL","../../modules/es.array.some":"Zq1i","../../modules/es.array.sort":"iAXB","../../modules/es.array.species":"x9kn","../../modules/es.array.splice":"j0jg","../../modules/es.array.unscopables.flat":"LG5H","../../modules/es.array.unscopables.flat-map":"fx1r","../../internals/path":"FSlT"}],"RCMJ":[function(require,module,exports) {
"use strict";var n=require("../internals/a-function"),t=require("../internals/is-object"),r=[].slice,e={},i=function(n,t,r){if(!(t in e)){for(var i=[],o=0;o<t;o++)i[o]="a["+o+"]";e[t]=Function("C,a","return new C("+i.join(",")+")")}return e[t](n,r)};module.exports=Function.bind||function(e){var o=n(this),a=r.call(arguments,1),c=function(){var n=a.concat(r.call(arguments));return this instanceof c?i(o,n.length,n):o.apply(e,n)};return t(o.prototype)&&(c.prototype=o.prototype),c};
},{"../internals/a-function":"aHwm","../internals/is-object":"QYQv"}],"v828":[function(require,module,exports) {
var n=require("../internals/export"),r=require("../internals/function-bind");n({target:"Function",proto:!0},{bind:r});
},{"../internals/export":"EhLp","../internals/function-bind":"RCMJ"}],"f0G1":[function(require,module,exports) {
var r=require("../internals/descriptors"),t=require("../internals/object-define-property").f,e=Function.prototype,n=e.toString,i=/^\s*function ([^ (]*)/,c="name";!r||c in e||t(e,c,{configurable:!0,get:function(){try{return n.call(this).match(i)[1]}catch(r){return""}}});
},{"../internals/descriptors":"r2hA","../internals/object-define-property":"lxmH"}],"r1vU":[function(require,module,exports) {
"use strict";var e=require("../internals/is-object"),t=require("../internals/object-define-property"),r=require("../internals/object-get-prototype-of"),n=require("../internals/well-known-symbol"),i=n("hasInstance"),o=Function.prototype;i in o||t.f(o,i,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}});
},{"../internals/is-object":"QYQv","../internals/object-define-property":"lxmH","../internals/object-get-prototype-of":"wKQH","../internals/well-known-symbol":"sPFN"}],"CEqO":[function(require,module,exports) {
require("../../modules/es.function.bind"),require("../../modules/es.function.name"),require("../../modules/es.function.has-instance");var e=require("../../internals/path");module.exports=e.Function;
},{"../../modules/es.function.bind":"v828","../../modules/es.function.name":"f0G1","../../modules/es.function.has-instance":"r1vU","../../internals/path":"FSlT"}],"oh18":[function(require,module,exports) {
"use strict";function e(){"undefined"==typeof window&&(window={audioContext:function(){}}),"undefined"==typeof window||window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setInterval(e,1e3/60)}),"undefined"==typeof window||window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(){}),"undefined"==typeof window||window.AudioContext||(window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext),"undefined"==typeof window||window.devicePixelRatio||(window.devicePixelRatio=window.devicePixelRatio||1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.polyfill=e,require("core-js/es/array"),require("core-js/es/function");
},{"core-js/es/array":"I7hB","core-js/es/function":"CEqO"}],"yYMg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Random=void 0;var t=4294967295,i=function(){function i(t){this.seed=t,this._lowerMask=2147483647,this._upperMask=2147483648,this._w=32,this._n=624,this._m=397,this._a=2567483615,this._u=11,this._s=7,this._b=2636928640,this._t=15,this._c=4022730752,this._l=18,this._f=1812433253,this._mt=new Array(this._n),this._mt[0]=(t||Date.now())>>>0;for(var i=1;i<this._n;i++){var e=this._mt[i-1]^this._mt[i-1]>>>this._w-2;this._mt[i]=(this._f*((4294901760&e)>>>16)<<16)+this._f*(65535&e)+i>>>0}this._index=this._n}return i.prototype._twist=function(){for(var i=[0,this._a],e=0,n=0;n<this._n-this._m;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+this._m]^e>>>1^i[1&e]&t;for(;n<this._n-1;n++)e=this._mt[n]&this._upperMask|this._mt[n+1]&this._lowerMask,this._mt[n]=this._mt[n+(this._m-this._n)]^e>>>1^i[1&e]&t;e=this._mt[this._n-1]&this._upperMask|this._mt[0]&this._lowerMask,this._mt[this._n-1]=this._mt[this._m-1]^e>>>1^i[1&e]&t,this._index=0},i.prototype.nextInt=function(){this._index>=this._n&&this._twist();var t=this._mt[this._index++];return t^=t>>>this._u,t^=t<<this._s&this._b,t^=t<<this._t&this._c,(t^=t>>>this._l)>>>0},i.prototype.next=function(){return this.nextInt()*(1/4294967296)},i.prototype.floating=function(t,i){return(i-t)*this.next()+t},i.prototype.integer=function(t,i){return Math.floor((i-t+1)*this.next()+t)},i.prototype.bool=function(t){return void 0===t&&(t=.5),this.next()<=t},i.prototype.pickOne=function(t){return t[this.integer(0,t.length-1)]},i.prototype.pickSet=function(t,i,e){return void 0===e&&(e=!1),e?this._pickSetWithDuplicates(t,i):this._pickSetWithoutDuplicates(t,i)},i.prototype._pickSetWithoutDuplicates=function(t,i){if(i>t.length||i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 < n <= length");if(i===t.length)return t;for(var e=new Array(i),n=0,r=t.slice(0);n<i;){var s=this.integer(0,r.length-1);e[n++]=r[s],r.splice(s,1)}return e},i.prototype._pickSetWithDuplicates=function(t,i){if(i<0)throw new Error("Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT");for(var e=new Array(i),n=0;n<i;n++)e[n]=this.pickOne(t);return e},i.prototype.shuffle=function(t){for(var i=t.slice(0),e=null,n=0;n<i.length-2;n++){var r=this.integer(n,i.length-1);e=i[n],i[n]=i[r],i[r]=e}return i},i.prototype.range=function(t,i,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=this.integer(i,e);return n},i.prototype.d4=function(){return this.integer(1,4)},i.prototype.d6=function(){return this.integer(1,6)},i.prototype.d8=function(){return this.integer(1,8)},i.prototype.d10=function(){return this.integer(1,10)},i.prototype.d12=function(){return this.integer(1,12)},i.prototype.d20=function(){return this.integer(1,20)},i}();exports.Random=i;
},{}],"YM02":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Side=void 0,exports.Side=e,function(e){e.None="None",e.Top="Top",e.Bottom="Bottom",e.Left="Left",e.Right="Right"}(e||(exports.Side=e={}));
},{}],"Kkda":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.extend=a,exports.base64Encode=s,exports.nullish=u,exports.clamp=c,exports.randomInRange=f,exports.randomIntInRange=l,exports.canonicalizeAngle=h,exports.toDegrees=p,exports.toRadians=d,exports.getPosition=y,exports.addItemToArray=v,exports.removeItemFromArray=A,exports.contains=_,exports.getOppositeSide=x,exports.getSideFromDirection=g,exports.fail=P,exports.range=exports.Collection=exports.TwoPI=void 0;var t=require("../Algebra"),r=require("../Math/Random"),e=require("../Collision/Side"),n=function(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,o,i=e.call(t),a=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a},o=function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(n(arguments[r]));return t},i=2*Math.PI;function a(){var t={},r=!1,e=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(r=arguments[0],e++);var o="function"==typeof Object.assign,i=null;for(i=o?Object.assign:function(e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r&&"[object Object]"===Object.prototype.toString.call(e[n])?t[n]=a(!0,t[n],e[n]):t[n]=e[n])};e<n;e++){var s=arguments[e];o?i(t,s):i(s)}return t}function s(t){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="",n=0;n<t.length;){var o=255&t.charCodeAt(n++),i=255&t.charCodeAt(n++),a=255&t.charCodeAt(n++),s=o>>2,u=(3&o)<<4|i>>4,c=void 0,f=void 0;isNaN(i)?c=f=64:(c=(15&i)<<2|a>>6,f=isNaN(a)?64:63&a),e+=r.charAt(s)+r.charAt(u)+r.charAt(c)+r.charAt(f)}return e}function u(t,r){return null!=t?t:r}function c(t,r,e){return Math.min(Math.max(r,t),e)}function f(t,e,n){return void 0===n&&(n=new r.Random),n?n.floating(t,e):t+Math.random()*(e-t)}function l(t,e,n){return void 0===n&&(n=new r.Random),n?n.integer(t,e):Math.round(f(t,e))}function h(t){var r=t;if(t>i)for(;r>i;)r-=i;if(t<0)for(;r<0;)r+=i;return r}function p(t){return 180/Math.PI*t}function d(t){return t/180*Math.PI}function y(r){var e=0,n=0;return function t(r){e+=r.offsetLeft,r.offsetParent&&t(r.offsetParent)}(r),function t(r){n+=r.offsetTop,r.offsetParent&&t(r.offsetParent)}(r),new t.Vector(e,n)}function v(t,r){return-1===r.indexOf(t)&&(r.push(t),!0)}function A(t,r){var e;return(e=r.indexOf(t))>-1&&(r.splice(e,1),!0)}function _(t,r){for(var e=0;e<t.length;e++)if(t[e]===r)return!0;return!1}function x(t){return t===e.Side.Top?e.Side.Bottom:t===e.Side.Bottom?e.Side.Top:t===e.Side.Left?e.Side.Right:t===e.Side.Right?e.Side.Left:e.Side.None}function g(r){for(var n=[t.Vector.Left,t.Vector.Right,t.Vector.Up,t.Vector.Down],o=[e.Side.Left,e.Side.Right,e.Side.Top,e.Side.Bottom],i=-Number.MAX_VALUE,a=-1,s=0;s<n.length;s++)n[s].dot(r)>i&&(i=n[s].dot(r),a=s);return o[a]}exports.TwoPI=i;var m=function(){function t(r){void 0===r&&(r=t.DefaultSize),this._internalArray=null,this._endPointer=0,this._internalArray=new Array(r)}return t.prototype._resize=function(){for(var t=2*this._internalArray.length,r=new Array(t),e=this.count(),n=0;n<e;n++)r[n]=this._internalArray[n];delete this._internalArray,this._internalArray=r},t.prototype.push=function(t){return this._endPointer===this._internalArray.length&&this._resize(),this._internalArray[this._endPointer++]=t},t.prototype.pop=function(){return this._endPointer=this._endPointer-1<0?0:this._endPointer-1,this._internalArray[this._endPointer]},t.prototype.count=function(){return this._endPointer},t.prototype.clear=function(){this._endPointer=0},t.prototype.internalSize=function(){return this._internalArray.length},t.prototype.elementAt=function(t){if(t>=this.count())throw new Error("Invalid index "+t);return this._internalArray[t]},t.prototype.insert=function(t,r){return t>=this.count()&&this._resize(),this._internalArray[t]=r},t.prototype.remove=function(t){var r=this.count();if(0===r)throw new Error("Invalid parameter "+t);for(var e=this._internalArray[t],n=t;n<r;n++)this._internalArray[n]=this._internalArray[n+1];return this._endPointer--,e},t.prototype.removeElement=function(t){var r=this._internalArray.indexOf(t);this.remove(r)},t.prototype.toArray=function(){return this._internalArray.slice(0,this._endPointer)},t.prototype.forEach=function(t){for(var r=0,e=this.count();r<e;r++)t.call(this,this._internalArray[r],r)},t.prototype.map=function(t){for(var r=this.count(),e=0;e<r;e++)this._internalArray[e]=t.call(this,this._internalArray[e],e)},t.DefaultSize=200,t}();function P(t){throw new Error(t)}exports.Collection=m;var S=function(t,r){return o(Array(r+1).keys()).slice(t)};exports.range=S;
},{"../Algebra":"NGcQ","../Math/Random":"yYMg","../Collision/Side":"YM02"}],"p1Gn":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScreenAppender=exports.ConsoleAppender=exports.Logger=exports.LogLevel=void 0,exports.LogLevel=e,function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Fatal=4]="Fatal"}(e||(exports.LogLevel=e={}));var n=function(){function n(){if(this._appenders=[],this.defaultLevel=e.Info,n._instance)throw new Error("Logger is a singleton");return n._instance=this,n._instance.addAppender(new o),n._instance}return n.getInstance=function(){return null==n._instance&&(n._instance=new n),n._instance},n.prototype.addAppender=function(e){this._appenders.push(e)},n.prototype.clearAppenders=function(){this._appenders.length=0},n.prototype._log=function(e,n){null==e&&(e=this.defaultLevel);for(var o=this._appenders.length,t=0;t<o;t++)e>=this.defaultLevel&&this._appenders[t].log(e,n)},n.prototype.debug=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];this._log(e.Debug,n)},n.prototype.info=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];this._log(e.Info,n)},n.prototype.warn=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];this._log(e.Warn,n)},n.prototype.error=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];this._log(e.Error,n)},n.prototype.fatal=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];this._log(e.Fatal,n)},n._instance=null,n}();exports.Logger=n;var o=function(){function n(){}return n.prototype.log=function(n,o){if(console||console.log||!console.warn||!console.error){var t=[];t.unshift.apply(t,o),t.unshift("["+e[n]+"] : "),n<e.Warn?console.log.apply?console.log.apply(console,t):console.log(t.join(" ")):n<e.Error?console.warn.apply?console.warn.apply(console,t):console.warn(t.join(" ")):console.error.apply?console.error.apply(console,t):console.error(t.join(" "))}},n}();exports.ConsoleAppender=o;var t=function(){function n(e,n){this._messages=[],this._canvas=document.createElement("canvas"),this._canvas.width=e||window.innerWidth,this._canvas.height=n||window.innerHeight,this._canvas.style.position="absolute",this._ctx=this._canvas.getContext("2d"),document.body.appendChild(this._canvas)}return n.prototype.log=function(n,o){var t=o.join(",");this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._messages.unshift("["+e[n]+"] : "+t);for(var r=10,s=1,i=0;i<this._messages.length;i++)this._ctx.fillStyle="rgba(255,255,255,"+s.toFixed(2)+")",this._ctx.fillText(this._messages[i],200,r),r+=10,s=s>0?s-.05:0},n}();exports.ScreenAppender=t;
},{}],"kQDE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.obsolete=f,exports.resetObsoleteCounter=exports.maxMessages=void 0;var e=require("./Log"),t=n(require("./Util"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)u.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return u},u=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},s=5;exports.maxMessages=s;var i={},l=function(){for(var e in i)i[e]=0};exports.resetObsoleteCounter=l;var c=function(t,r){i[t]<s&&(e.Logger.getInstance().warn(t),console.trace&&r.showStackTrace&&console.trace()),i[t]++};function f(e){return e=t.extend({},{message:"This feature will be removed in future versions of Excalibur.",alternateMethod:null,showStackTrack:!1},e),function(t,r,n){if(n&&"function"!=typeof n.value&&"function"!=typeof n.get&&"function"!=typeof n.set)throw new SyntaxError("Only classes/functions/getters/setters can be marked as obsolete");var a=(t.name||"")+(t.name&&r?".":"")+(r||"")+" is marked obsolete: "+e.message+(e.alternateMethod?" Use "+e.alternateMethod+" instead":"");i[a]||(i[a]=0);var s=n?o({},n):t;if(!n){var l=function(){var t=Array.prototype.slice.call(arguments);return c(a,e),new(s.bind.apply(s,u([void 0],t)))};return l.prototype=s.prototype,l}return n&&n.value?(s.value=function(){return c(a,e),n.value.apply(this,arguments)},s):(n&&n.get&&(s.get=function(){return c(a,e),n.get.apply(this,arguments)}),n&&n.set&&(s.set=function(){return c(a,e),n.set.apply(this,arguments)}),s)}}
},{"./Log":"p1Gn","./Util":"Kkda"}],"NGcQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec=h,exports.GlobalCoordinates=exports.Projection=exports.Line=exports.Ray=exports.Vector=void 0;var t=r(require("./Util/Util")),e=require("./Util/Decorators");function n(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}function r(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=function(t,e,n,r){var o,s=arguments.length,u=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(u=(s<3?o(u):s>3?o(e,n,u):o(e,n))||u);return s>3&&u&&Object.defineProperty(e,n,u),u},s=function(){function t(t,e){this.x=t,this.y=e}return Object.defineProperty(t,"Zero",{get:function(){return new t(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"One",{get:function(){return new t(1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Half",{get:function(){return new t(.5,.5)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Up",{get:function(){return new t(0,-1)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Down",{get:function(){return new t(0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Left",{get:function(){return new t(-1,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Right",{get:function(){return new t(1,0)},enumerable:!0,configurable:!0}),t.fromAngle=function(e){return new t(Math.cos(e),Math.sin(e))},t.isValid=function(t){return null!=t&&(!isNaN(t.x)&&!isNaN(t.y)&&(t.x!==1/0&&t.y!==1/0&&t.x!==-1/0&&t.y!==-1/0))},t.distance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.prototype.setTo=function(t,e){this.x=t,this.y=e},t.prototype.equals=function(t,e){return void 0===e&&(e=.001),Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e},t.prototype.distance=function(e){return e||(e=t.Zero),Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},t.prototype.magnitude=function(){return this.distance()},Object.defineProperty(t.prototype,"size",{get:function(){return this.distance()},set:function(t){var e=this.normalize().scale(t);this.x=e.x,this.y=e.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.distance();return e>0?new t(this.x/e,this.y/e):new t(0,1)},t.prototype.average=function(t){return this.add(t).scale(.5)},t.prototype.scale=function(e){return e instanceof t?new t(this.x*e.x,this.y*e.y):new t(this.x*e,this.y*e)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.addEqual=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subEqual=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.scaleEqual=function(t){return this.x*=t,this.y*=t,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.cross=function(e){return e instanceof t?this.x*e.y-this.y*e.x:"number"==typeof e?new t(e*this.y,-e*this.x):void 0},t.prototype.perpendicular=function(){return new t(this.y,-this.x)},t.prototype.normal=function(){return this.perpendicular().normalize()},t.prototype.negate=function(){return this.scale(-1)},t.prototype.toAngle=function(){return Math.atan2(this.y,this.x)},t.prototype.rotate=function(e,n){n||(n=new t(0,0));var r=Math.sin(e),i=Math.cos(e);return new t(i*(this.x-n.x)-r*(this.y-n.y)+n.x,r*(this.x-n.x)+i*(this.y-n.y)+n.y)},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.toString=function(){return"("+this.x+", "+this.y+")"},o([(0,e.obsolete)({message:"will be removed in favour of `.size` in version 0.25.0"})],t.prototype,"magnitude",null),t}();exports.Vector=s;var u=function(){function t(t,e){this.pos=t,this.dir=e.normalize()}return t.prototype.intersect=function(t){var e=t.begin.sub(this.pos);if(0===this.dir.cross(t.getSlope())&&0!==e.cross(this.dir))return-1;var n=this.dir.cross(t.getSlope());if(0===n)return-1;var r=e.cross(t.getSlope())/n;if(r>=0){var i=e.cross(this.dir)/n/t.getLength();if(i>=0&&i<=1)return r}return-1},t.prototype.getPoint=function(t){return this.pos.add(this.dir.scale(t))},t}();exports.Ray=u;var a=function(){function t(t,e){this.begin=t,this.end=e}return Object.defineProperty(t.prototype,"slope",{get:function(){return(this.end.y-this.begin.y)/(this.end.x-this.begin.x)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"intercept",{get:function(){return this.begin.y-this.slope*this.begin.x},enumerable:!0,configurable:!0}),t.prototype.normal=function(){return this.end.sub(this.begin).normal()},t.prototype.getSlope=function(){var t=this.begin,e=this.end,n=t.distance(e);return e.sub(t).scale(1/n)},t.prototype.getEdge=function(){var t=this.begin;return this.end.sub(t)},t.prototype.getLength=function(){var t=this.begin,e=this.end;return t.distance(e)},Object.defineProperty(t.prototype,"midpoint",{get:function(){return this.begin.add(this.end).scale(.5)},enumerable:!0,configurable:!0}),t.prototype.flip=function(){return new t(this.end,this.begin)},t.prototype.distanceToPoint=function(t){var e=t.x,n=t.y,r=this.getLength(),i=this.end.y-this.begin.y,o=this.end.x-this.begin.x;return Math.abs(i*e-o*n+this.end.x*this.begin.y-this.end.y*this.begin.x)/r},t.prototype.findVectorToPoint=function(t){var e=this.begin.sub(t),n=this.getSlope();return e.sub(n.scale(e.dot(n)))},t.prototype.findPoint=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var n=this.slope,r=this.intercept;if(null!==t)return new s(t,n*t+r);if(null!==e)return new s((e-r)/n,e);throw new Error("You must provide an X or a Y value")},t.prototype.hasPoint=function(){var t,e=0;if("number"==typeof arguments[0]&&"number"==typeof arguments[1])t=new s(arguments[0],arguments[1]),e=arguments[2]||0;else{if(!(arguments[0]instanceof s))throw"Could not determine the arguments for Vector.hasPoint";t=arguments[0],e=arguments[1]||0}var n=t.x-this.begin.x,r=t.y-this.begin.y,i=this.end.x-this.begin.x,o=this.end.y-this.begin.y,u=n*o-r*i;return!(Math.abs(u)>e)&&(Math.abs(i)>=Math.abs(o)?i>0?this.begin.x<=t.x&&t.x<=this.end.x:this.end.x<=t.x&&t.x<=this.begin.x:o>0?this.begin.y<=t.y&&t.y<=this.end.y:this.end.y<=t.y&&t.y<=this.begin.y)},t}();exports.Line=a;var c=function(){function t(t,e){this.min=t,this.max=e}return t.prototype.overlaps=function(t){return this.max>t.min&&t.max>this.min},t.prototype.getOverlap=function(t){return this.overlaps(t)?this.max>t.max?t.max-this.min:this.max-t.min:0},t}();exports.Projection=c;var p=function(){function e(t,e,n){this.worldPos=t,this.pagePos=e,this.screenPos=n}return e.fromPagePosition=function(n,r,i){var o,u,a,c;3===arguments.length?(a=new s(o=n,u=r),c=i):(o=(a=n).x,u=a.y,c=r);var p=o-t.getPosition(c.canvas).x,h=u-t.getPosition(c.canvas).y,f=new s(p,h);return new e(c.screenToWorldCoordinates(f),a,f)},e}();function h(t,e){return new s(t,e)}exports.GlobalCoordinates=p;
},{"./Util/Util":"Kkda","./Util/Decorators":"kQDE"}],"XySq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExitTriggerEvent=exports.EnterTriggerEvent=exports.EnterViewPortEvent=exports.ExitViewPortEvent=exports.DeactivateEvent=exports.ActivateEvent=exports.InitializeEvent=exports.CollisionEndEvent=exports.CollisionStartEvent=exports.PostCollisionEvent=exports.PreCollisionEvent=exports.HiddenEvent=exports.VisibleEvent=exports.UnsubscribeEvent=exports.SubscribeEvent=exports.GamepadAxisEvent=exports.GamepadButtonEvent=exports.GamepadDisconnectEvent=exports.GamepadConnectEvent=exports.PostFrameEvent=exports.PreFrameEvent=exports.PostUpdateEvent=exports.PreUpdateEvent=exports.PostDebugDrawEvent=exports.PreDebugDrawEvent=exports.PostDrawEvent=exports.PreDrawEvent=exports.GameStopEvent=exports.GameStartEvent=exports.PostKillEvent=exports.PreKillEvent=exports.KillEvent=exports.GameEvent=exports.EventTypes=void 0;var t,e=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();exports.EventTypes=t,function(t){t.Kill="kill",t.PreKill="prekill",t.PostKill="postkill",t.PreDraw="predraw",t.PostDraw="postdraw",t.PreDebugDraw="predebugdraw",t.PostDebugDraw="postdebugdraw",t.PreUpdate="preupdate",t.PostUpdate="postupdate",t.PreFrame="preframe",t.PostFrame="postframe",t.PreCollision="precollision",t.CollisionStart="collisionstart",t.CollisionEnd="collisionend",t.PostCollision="postcollision",t.Initialize="initialize",t.Activate="activate",t.Deactivate="deactivate",t.ExitViewport="exitviewport",t.EnterViewport="enterviewport",t.ExitTrigger="exit",t.EnterTrigger="enter",t.Connect="connect",t.Disconnect="disconnect",t.Button="button",t.Axis="axis",t.Subscribe="subscribe",t.Unsubscribe="unsubscribe",t.Visible="visible",t.Hidden="hidden",t.Start="start",t.Stop="stop",t.PointerUp="pointerup",t.PointerDown="pointerdown",t.PointerMove="pointermove",t.PointerEnter="pointerenter",t.PointerLeave="pointerleave",t.PointerCancel="pointercancel",t.PointerWheel="pointerwheel",t.Up="up",t.Down="down",t.Move="move",t.Enter="enter",t.Leave="leave",t.Cancel="cancel",t.Wheel="wheel",t.Press="press",t.Release="release",t.Hold="hold",t.PointerDragStart="pointerdragstart",t.PointerDragEnd="pointerdragend",t.PointerDragEnter="pointerdragenter",t.PointerDragLeave="pointerdragleave",t.PointerDragMove="pointerdragmove"}(t||(exports.EventTypes=t={}));var r=function(){function t(){this.bubbles=!0}return t.prototype.stopPropagation=function(){this.bubbles=!1},t}();exports.GameEvent=r;var n=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.KillEvent=n;var i=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.PreKillEvent=i;var o=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.PostKillEvent=o;var a=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.GameStartEvent=a;var s=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.GameStopEvent=s;var u=function(t){function r(e,r,n){var i=t.call(this)||this;return i.ctx=e,i.delta=r,i.target=n,i}return e(r,t),r}(r);exports.PreDrawEvent=u;var c=function(t){function r(e,r,n){var i=t.call(this)||this;return i.ctx=e,i.delta=r,i.target=n,i}return e(r,t),r}(r);exports.PostDrawEvent=c;var l=function(t){function r(e,r){var n=t.call(this)||this;return n.ctx=e,n.target=r,n}return e(r,t),r}(r);exports.PreDebugDrawEvent=l;var v=function(t){function r(e,r){var n=t.call(this)||this;return n.ctx=e,n.target=r,n}return e(r,t),r}(r);exports.PostDebugDrawEvent=v;var p=function(t){function r(e,r,n){var i=t.call(this)||this;return i.engine=e,i.delta=r,i.target=n,i}return e(r,t),r}(r);exports.PreUpdateEvent=p;var f=function(t){function r(e,r,n){var i=t.call(this)||this;return i.engine=e,i.delta=r,i.target=n,i}return e(r,t),r}(r);exports.PostUpdateEvent=f;var x=function(t){function r(e,r){var n=t.call(this)||this;return n.engine=e,n.prevStats=r,n.target=e,n}return e(r,t),r}(r);exports.PreFrameEvent=x;var h=function(t){function r(e,r){var n=t.call(this)||this;return n.engine=e,n.stats=r,n.target=e,n}return e(r,t),r}(r);exports.PostFrameEvent=h;var E=function(t){function r(e,r){var n=t.call(this)||this;return n.index=e,n.gamepad=r,n.target=r,n}return e(r,t),r}(r);exports.GamepadConnectEvent=E;var g=function(t){function r(e,r){var n=t.call(this)||this;return n.index=e,n.gamepad=r,n.target=r,n}return e(r,t),r}(r);exports.GamepadDisconnectEvent=g;var d=function(t){function r(e,r,n){var i=t.call(this)||this;return i.button=e,i.value=r,i.target=n,i}return e(r,t),r}(r);exports.GamepadButtonEvent=d;var P=function(t){function r(e,r,n){var i=t.call(this)||this;return i.axis=e,i.value=r,i.target=n,i}return e(r,t),r}(r);exports.GamepadAxisEvent=P;var b=function(t){function r(e,r){var n=t.call(this)||this;return n.topic=e,n.handler=r,n}return e(r,t),r}(r);exports.SubscribeEvent=b;var w=function(t){function r(e,r){var n=t.call(this)||this;return n.topic=e,n.handler=r,n}return e(r,t),r}(r);exports.UnsubscribeEvent=w;var m=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.VisibleEvent=m;var D=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.HiddenEvent=D;var y=function(t){function r(e,r,n,i){var o=t.call(this)||this;return o.other=r,o.side=n,o.intersection=i,o.target=e,o}return e(r,t),Object.defineProperty(r.prototype,"actor",{get:function(){return this.target},set:function(t){this.target=t},enumerable:!0,configurable:!0}),r}(r);exports.PreCollisionEvent=y;var C=function(t){function r(e,r,n,i){var o=t.call(this)||this;return o.other=r,o.side=n,o.intersection=i,o.target=e,o}return e(r,t),Object.defineProperty(r.prototype,"actor",{get:function(){return this.target},set:function(t){this.target=t},enumerable:!0,configurable:!0}),r}(r);exports.PostCollisionEvent=C;var S=function(t){function r(e,r,n){var i=t.call(this)||this;return i.other=r,i.pair=n,i.target=e,i}return e(r,t),Object.defineProperty(r.prototype,"actor",{get:function(){return this.target},set:function(t){this.target=t},enumerable:!0,configurable:!0}),r}(r);exports.CollisionStartEvent=S;var G=function(t){function r(e,r){var n=t.call(this)||this;return n.other=r,n.target=e,n}return e(r,t),Object.defineProperty(r.prototype,"actor",{get:function(){return this.target},set:function(t){this.target=t},enumerable:!0,configurable:!0}),r}(r);exports.CollisionEndEvent=G;var U=function(t){function r(e,r){var n=t.call(this)||this;return n.engine=e,n.target=r,n}return e(r,t),r}(r);exports.InitializeEvent=U;var _=function(t){function r(e,r){var n=t.call(this)||this;return n.oldScene=e,n.target=r,n}return e(r,t),r}(r);exports.ActivateEvent=_;var K=function(t){function r(e,r){var n=t.call(this)||this;return n.newScene=e,n.target=r,n}return e(r,t),r}(r);exports.DeactivateEvent=K;var O=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.ExitViewPortEvent=O;var T=function(t){function r(e){var r=t.call(this)||this;return r.target=e,r}return e(r,t),r}(r);exports.EnterViewPortEvent=T;var V=function(t){function r(e,r){var n=t.call(this)||this;return n.target=e,n.actor=r,n}return e(r,t),r}(r);exports.EnterTriggerEvent=V;var j=function(t){function r(e,r){var n=t.call(this)||this;return n.target=e,n.actor=r,n}return e(r,t),r}(r);exports.ExitTriggerEvent=j;
},{}],"c7EN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EventDispatcher=void 0;var e=require("./Events"),t=function(){function t(e){this._handlers={},this._wiredEventDispatchers=[],this._target=e}return t.prototype.clear=function(){this._handlers={},this._wiredEventDispatchers=[]},t.prototype.emit=function(t,s){if(t){t=t.toLowerCase();var i,r,n=this._target;if(s||(s=new e.GameEvent),s.target=n,this._handlers[t])for(i=0,r=this._handlers[t].length;i<r;i++)this._handlers[t][i].call(n,s);for(i=0,r=this._wiredEventDispatchers.length;i<r;i++)this._wiredEventDispatchers[i].emit(t,s)}},t.prototype.on=function(t,s){t=t.toLowerCase(),this._handlers[t]||(this._handlers[t]=[]),this._handlers[t].push(s),"unsubscribe"!==t&&"subscribe"!==t&&this.emit("subscribe",new e.SubscribeEvent(t,s))},t.prototype.off=function(t,s){t=t.toLowerCase();var i=this._handlers[t];if(i)if(s){var r=i.indexOf(s);this._handlers[t].splice(r,1)}else this._handlers[t].length=0;"unsubscribe"!==t&&"subscribe"!==t&&this.emit("unsubscribe",new e.UnsubscribeEvent(t,s))},t.prototype.once=function(t,s){var i=this;this.on(t,function(r){var n=r||new e.GameEvent;n.target=n.target||i._target,i.off(t,s),s.call(n.target,n)})},t.prototype.wire=function(e){e._wiredEventDispatchers.push(this)},t.prototype.unwire=function(e){var t=e._wiredEventDispatchers.indexOf(this);t>-1&&e._wiredEventDispatchers.splice(t,1)},t}();exports.EventDispatcher=t;
},{"./Events":"XySq"}],"yTUi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Class=void 0;var t=require("./EventDispatcher"),e=function(){function e(){this.eventDispatcher=new t.EventDispatcher(this)}return e.prototype.on=function(t,e){this.eventDispatcher.on(t,e)},e.prototype.off=function(t,e){this.eventDispatcher.off(t,e)},e.prototype.emit=function(t,e){this.eventDispatcher.emit(t,e)},e.prototype.once=function(t,e){this.eventDispatcher.once(t,e)},e}();exports.Class=e;
},{"./EventDispatcher":"c7EN"}],"lN80":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Resource=void 0;var t=require("../Class"),e=require("../Util/Log"),r=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),o=function(t){function o(r,o,n){void 0===n&&(n=!0);var a=t.call(this)||this;return a.path=r,a.responseType=o,a.bustCache=n,a.data=null,a.logger=e.Logger.getInstance(),a.arrayBuffer=null,a.onprogress=function(){},a.oncomplete=function(){},a.onerror=function(){},a}return r(o,t),o.prototype.isLoaded=function(){return null!==this.data},o.prototype.wireEngine=function(t){},o.prototype._cacheBust=function(t){return/\?\w*=\w*/.test(t)?t+="&__="+Date.now():t+="?__="+Date.now(),t},o.prototype._start=function(){this.logger.debug("Started loading resource "+this.path)},o.prototype.load=function(){var t=this;return new Promise(function(e,r){if(null!==t.data)return t.logger.debug("Already have data for resource",t.path),e(t.data),void t.oncomplete();var o=new XMLHttpRequest;o.open("GET",t.bustCache?t._cacheBust(t.path):t.path,!0),o.responseType=t.responseType,o.onloadstart=function(){t._start()},o.onprogress=t.onprogress,o.onerror=t.onerror,o.onload=function(){if(0!==o.status&&200!==o.status)return t.logger.error("Failed to load resource ",t.path," server responded with error code",o.status),t.onerror(o.response),void r(o.response);t.data=t.processData(o.response),t.oncomplete(),t.logger.debug("Completed loading resource",t.path),e(t.data)},o.send()})},o.prototype.getData=function(){return this.data},o.prototype.getArrayData=function(){return this.arrayBuffer},o.prototype.setData=function(t){this.data=this.processData(t)},o.prototype.processData=function(t){return"blob"===this.responseType?URL.createObjectURL(t):t},o}(t.Class);exports.Resource=o;
},{"../Class":"yTUi","../Util/Log":"p1Gn"}],"p7Gh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Color=void 0;var e=require("../Util/Decorators");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=function(e,r,n,o){var i,u=arguments.length,f=u<3?r:null===o?o=Object.getOwnPropertyDescriptor(r,n):o;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)f=Reflect.decorate(e,r,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(f=(u<3?i(f):u>3?i(r,n,f):i(r,n))||f);return u>3&&f&&Object.defineProperty(r,n,f),f},n=function(){function t(e,t,r,n){this.r=e,this.g=t,this.b=r,this.a=null!=n?n:1}return t.fromRGB=function(e,r,n,o){return new t(e,r,n,o)},t.fromHex=function(e){var r;if(r=e.match(/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i)){var n=parseInt(r[1],16),o=parseInt(r[2],16),i=parseInt(r[3],16),u=1;return r[4]&&(u=parseInt(r[4],16)/255),new t(n,o,i,u)}throw new Error("Invalid hex string: "+e)},t.fromHSL=function(e,t,r,n){return void 0===n&&(n=1),new o(e,t,r,n).toRGBA()},t.prototype.lighten=function(e){void 0===e&&(e=.1);var t=o.fromRGBA(this.r,this.g,this.b,this.a);return t.l+=(1-t.l)*e,t.toRGBA()},t.prototype.darken=function(e){void 0===e&&(e=.1);var t=o.fromRGBA(this.r,this.g,this.b,this.a);return t.l-=t.l*e,t.toRGBA()},t.prototype.saturate=function(e){void 0===e&&(e=.1);var t=o.fromRGBA(this.r,this.g,this.b,this.a);return t.s+=t.s*e,t.toRGBA()},t.prototype.desaturate=function(e){void 0===e&&(e=.1);var t=o.fromRGBA(this.r,this.g,this.b,this.a);return t.s-=t.s*e,t.toRGBA()},t.prototype.multiply=function(e){return new t(e.r/255*this.r/255*255,e.g/255*this.g/255*255,e.b/255*this.b/255*255,e.a*this.a)},t.prototype.mulitiply=function(e){return this.multiply(e)},t.prototype.screen=function(e){var t=e.invert(),r=e.invert();return t.multiply(r).invert()},t.prototype.invert=function(){return new t(255-this.r,255-this.g,255-this.b,1-this.a)},t.prototype.average=function(e){return new t((e.r+this.r)/2,(e.g+this.g)/2,(e.b+this.b)/2,(e.a+this.a)/2)},t.prototype.toString=function(e){switch(void 0===e&&(e="rgb"),e){case"rgb":return this.toRGBA();case"hsl":return this.toHSLA();case"hex":return this.toHex();default:throw new Error("Invalid Color format")}},t.prototype._componentToHex=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},t.prototype.toHex=function(){return"#"+this._componentToHex(this.r)+this._componentToHex(this.g)+this._componentToHex(this.b)},t.prototype.toRGBA=function(){var e=String(this.r.toFixed(0))+", "+String(this.g.toFixed(0))+", "+String(this.b.toFixed(0));return void 0!==this.a||null!==this.a?"rgba("+e+", "+String(this.a)+")":"rgb("+e+")"},t.prototype.toHSLA=function(){return o.fromRGBA(this.r,this.g,this.b,this.a).toString()},t.prototype.fillStyle=function(){return this.toString()},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},Object.defineProperty(t,"Black",{get:function(){return t.fromHex("#000000")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"White",{get:function(){return t.fromHex("#FFFFFF")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Gray",{get:function(){return t.fromHex("#808080")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightGray",{get:function(){return t.fromHex("#D3D3D3")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkGray",{get:function(){return t.fromHex("#A9A9A9")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Yellow",{get:function(){return t.fromHex("#FFFF00")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Orange",{get:function(){return t.fromHex("#FFA500")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Red",{get:function(){return t.fromHex("#FF0000")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Vermilion",{get:function(){return t.fromHex("#FF5B31")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Vermillion",{get:function(){return t.Vermilion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Rose",{get:function(){return t.fromHex("#FF007F")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Magenta",{get:function(){return t.fromHex("#FF00FF")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Violet",{get:function(){return t.fromHex("#7F00FF")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Blue",{get:function(){return t.fromHex("#0000FF")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Azure",{get:function(){return t.fromHex("#007FFF")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Cyan",{get:function(){return t.fromHex("#00FFFF")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Viridian",{get:function(){return t.fromHex("#59978F")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Green",{get:function(){return t.fromHex("#00FF00")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Chartreuse",{get:function(){return t.fromHex("#7FFF00")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Transparent",{get:function(){return t.fromHex("#FFFFFF00")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ExcaliburBlue",{get:function(){return t.fromHex("#176BAA")},enumerable:!0,configurable:!0}),r([(0,e.obsolete)({message:"Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0"})],t.prototype,"mulitiply",null),r([(0,e.obsolete)({message:"Alias for incorrect spelling used in older versions",alternateMethod:"Vermilion"})],t,"Vermillion",null),t}();exports.Color=n;var o=function(){function e(e,t,r,n){this.h=e,this.s=t,this.l=r,this.a=n}return e.hue2rgb=function(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e},e.fromRGBA=function(t,r,n,o){t/=255,r/=255,n/=255;var i,u,f=Math.max(t,r,n),s=Math.min(t,r,n),a=(f+s)/2;if(f===s)i=u=0;else{var l=f-s;switch(u=a>.5?l/(2-f-s):l/(f+s),f){case t:i=(r-n)/l+(r<n?6:0);break;case r:i=(n-t)/l+2;break;case n:i=(t-r)/l+4}i/=6}return new e(i,u,a,o)},e.prototype.toRGBA=function(){var t,r,o;if(0===this.s)t=r=o=this.l;else{var i=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,u=2*this.l-i;t=e.hue2rgb(u,i,this.h+1/3),r=e.hue2rgb(u,i,this.h),o=e.hue2rgb(u,i,this.h-1/3)}return new n(255*t,255*r,255*o,this.a)},e.prototype.toString=function(){return"hsla("+this.h.toFixed(0)+", "+this.s.toFixed(0)+", "+this.l.toFixed(0)+", "+this.a.toFixed(0)+")"},e}();
},{"../Util/Decorators":"kQDE"}],"OEQf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Fill=exports.Desaturate=exports.Saturate=exports.Darken=exports.Lighten=exports.Colorize=exports.Opacity=exports.Invert=exports.Grayscale=void 0;var t=require("./Color"),o=function(){function t(){}return t.prototype.updatePixel=function(t,o,r){var e=4*(t+o*r.width),a=r.data,i=(a[e+0]+a[e+1]+a[e+2])/3;a[e+0]=i,a[e+1]=i,a[e+2]=i},t}();exports.Grayscale=o;var r=function(){function t(){}return t.prototype.updatePixel=function(t,o,r){var e=4*(t+o*r.width),a=r.data;a[e+0]=255-a[e+0],a[e+1]=255-a[e+1],a[e+2]=255-a[e+2]},t}();exports.Invert=r;var e=function(){function t(t){this.opacity=t}return t.prototype.updatePixel=function(t,o,r){var e=4*(t+o*r.width),a=r.data;0!==a[e+3]&&(a[e+3]=Math.round(this.opacity*a[e+3]))},t}();exports.Opacity=e;var a=function(){function t(t){this.color=t}return t.prototype.updatePixel=function(t,o,r){var e=4*(t+o*r.width),a=r.data;0!==a[e+3]&&(a[e+0]=(a[e+0]+this.color.r)/2,a[e+1]=(a[e+1]+this.color.g)/2,a[e+2]=(a[e+2]+this.color.b)/2)},t}();exports.Colorize=a;var i=function(){function o(t){void 0===t&&(t=.1),this.factor=t}return o.prototype.updatePixel=function(o,r,e){var a=4*(o+r*e.width),i=e.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).lighten(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a},o}();exports.Lighten=i;var n=function(){function o(t){void 0===t&&(t=.1),this.factor=t}return o.prototype.updatePixel=function(o,r,e){var a=4*(o+r*e.width),i=e.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).darken(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a},o}();exports.Darken=n;var u=function(){function o(t){void 0===t&&(t=.1),this.factor=t}return o.prototype.updatePixel=function(o,r,e){var a=4*(o+r*e.width),i=e.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).saturate(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a},o}();exports.Saturate=u;var c=function(){function o(t){void 0===t&&(t=.1),this.factor=t}return o.prototype.updatePixel=function(o,r,e){var a=4*(o+r*e.width),i=e.data,n=t.Color.fromRGB(i[a+0],i[a+1],i[a+2],i[a+3]).desaturate(this.factor);i[a+0]=n.r,i[a+1]=n.g,i[a+2]=n.b,i[a+3]=n.a},o}();exports.Desaturate=c;var p=function(){function t(t){this.color=t}return t.prototype.updatePixel=function(t,o,r){var e=4*(t+o*r.width),a=r.data;0!==a[e+3]&&(a[e+0]=this.color.r,a[e+1]=this.color.g,a[e+2]=this.color.b)},t}();exports.Fill=p;
},{"./Color":"p7Gh"}],"A4Kj":[function(require,module,exports) {
"use strict";function t(o){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Configurable=e;var o=function(){var t=function(o,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var r in o)o.hasOwnProperty(r)&&(t[r]=o[r])})(o,r)};return function(o,r){function n(){this.constructor=o}t(o,r),o.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),r=function(t,o){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,e,i=r.call(t),f=[];try{for(;(void 0===o||o-- >0)&&!(n=i.next()).done;)f.push(n.value)}catch(u){e={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return f},n=function(){for(var t=[],o=0;o<arguments.length;o++)t=t.concat(r(arguments[o]));return t};function e(r){return function(r){function e(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];var i=r.apply(this,n(o))||this;return 1!==o.filter(function(t){return void 0!==t}).length||!o[0]||"object"!==t(o[0])||o[0]instanceof Array||i.assign(o[0]),i}return o(e,r),e.prototype.assign=function(t){for(var o in t)"function"!=typeof this[o]&&(this[o]=t[o])},e}(r)}
},{}],"PpGD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sprite=exports.SpriteImpl=void 0;var t=n(require("./SpriteEffects")),e=require("./Color"),i=require("../Resources/Texture"),r=require("../Algebra"),h=require("../Util/Log"),s=require("../Util/Util"),a=require("../Configurable");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in t)if(Object.prototype.hasOwnProperty.call(t,h)){var s=r?Object.getOwnPropertyDescriptor(t,h):null;s&&(s.get||s.set)?Object.defineProperty(i,h,s):i[h]=t[h]}return i.default=t,e&&e.set(t,i),i}var f=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),p=function(){return(p=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var h in e=arguments[i])Object.prototype.hasOwnProperty.call(e,h)&&(t[h]=e[h]);return t}).apply(this,arguments)},l=function(){function a(t,e,s,o,n){var f=this;this.id=a.__ID++,this.x=0,this.y=0,this.rotation=0,this.anchor=new r.Vector(0,0),this.offset=r.Vector.Zero,this.scale=r.Vector.One,this.logger=h.Logger.getInstance(),this.flipVertical=!1,this.flipHorizontal=!1,this.effects=[],this.width=0,this.height=0,this._spriteCanvas=null,this._spriteCtx=null,this._pixelData=null,this._pixelsLoaded=!1,this._dirtyEffect=!0,this._opacity=1;var p=t;if(t&&!(t instanceof i.Texture)&&(e=0|t.x,s=0|t.y,o=0|t.width,n=0|t.height,!(p=t.image))){throw new Error("An image texture is required to contsruct a sprite")}this.x=e||0,this.y=s||0,this._texture=p,this._spriteCanvas=document.createElement("canvas"),this._spriteCtx=this._spriteCanvas.getContext("2d"),this._spriteCanvas.width=o,this._spriteCanvas.height=n,this._texture.loaded.then(function(){f.width=f.width||f._texture.image.naturalWidth,f.height=f.height||f._texture.image.naturalHeight,f._spriteCanvas.width=f._spriteCanvas.width||f._texture.image.naturalWidth,f._spriteCanvas.height=f._spriteCanvas.height||f._texture.image.naturalHeight,f._loadPixels(),f._dirtyEffect=!0}).catch(function(t){f.logger.error("Error loading texture ",f._texture.path,t)}),this.width=o,this.height=n}return Object.defineProperty(a.prototype,"drawWidth",{get:function(){return this.width*this.scale.x},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"drawHeight",{get:function(){return this.height*this.scale.y},enumerable:!0,configurable:!0}),a.prototype._loadPixels=function(){if(this._texture.isLoaded()&&!this._pixelsLoaded){var t=this._texture.image.naturalWidth||0,e=this._texture.image.naturalHeight||0;if(this.width>t&&this.logger.warn("The sprite width "+this.width+" exceeds the width \n                              "+t+" of the backing texture "+this._texture.path),this.width<=0||t<=0)throw new Error("The width of a sprite cannot be 0 or negative, sprite width: "+this.width+", original width: "+t);if(this.height>e&&this.logger.warn("The sprite height "+this.height+" exceeds the height \n                              "+e+" of the backing texture "+this._texture.path),this.height<=0||e<=0)throw new Error("The height of a sprite cannot be 0 or negative, sprite height: "+this.height+", original height: "+e);this._spriteCtx.drawImage(this._texture.image,(0,s.clamp)(this.x,0,t),(0,s.clamp)(this.y,0,e),(0,s.clamp)(this.width,0,t),(0,s.clamp)(this.height,0,e),0,0,this.width,this.height),this._pixelsLoaded=!0}},a.prototype.opacity=function(t){this._opacity=t},a.prototype.grayscale=function(){this.addEffect(new t.Grayscale)},a.prototype.invert=function(){this.addEffect(new t.Invert)},a.prototype.fill=function(e){this.addEffect(new t.Fill(e))},a.prototype.colorize=function(e){this.addEffect(new t.Colorize(e))},a.prototype.lighten=function(e){void 0===e&&(e=.1),this.addEffect(new t.Lighten(e))},a.prototype.darken=function(e){void 0===e&&(e=.1),this.addEffect(new t.Darken(e))},a.prototype.saturate=function(e){void 0===e&&(e=.1),this.addEffect(new t.Saturate(e))},a.prototype.desaturate=function(e){void 0===e&&(e=.1),this.addEffect(new t.Desaturate(e))},a.prototype.addEffect=function(t){this.effects.push(t),this._texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0},a.prototype.removeEffect=function(t){var e=-1;(e="number"==typeof t?t:this.effects.indexOf(t))<0||e>=this.effects.length||(this.effects.splice(e,1),this._texture.isLoaded()&&this._pixelsLoaded?this._applyEffects():this._dirtyEffect=!0)},a.prototype._applyEffects=function(){var t=this._texture.image.naturalWidth||0,e=this._texture.image.naturalHeight||0;this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.drawImage(this._texture.image,(0,s.clamp)(this.x,0,t),(0,s.clamp)(this.y,0,e),(0,s.clamp)(this.width,0,t),(0,s.clamp)(this.height,0,e),0,0,this.width,this.height),this._pixelData=this._spriteCtx.getImageData(0,0,this.width,this.height);for(var i=this.effects.length,r=0;r<i;r++)for(var h=0;h<this.height;h++)for(var a=0;a<this.width;a++)this.effects[r].updatePixel(a,h,this._pixelData);this._spriteCtx.clearRect(0,0,this.width,this.height),this._spriteCtx.putImageData(this._pixelData,0,0),this._dirtyEffect=!1},a.prototype.clearEffects=function(){this.effects.length=0,this._applyEffects()},a.prototype.reset=function(){},a.prototype.debugDraw=function(t,i,r){t.save(),t.translate(i,r),t.rotate(this.rotation);var h=this.drawWidth*this.anchor.x,s=this.drawHeight*this.anchor.y;t.strokeStyle=e.Color.Black.toString(),t.strokeRect(-h,-s,this.drawWidth,this.drawHeight),t.restore()},a.prototype.draw=function(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i}):this._drawWithOptions(t)},a.prototype._drawWithOptions=function(t){var e=p(p({},t),{rotation:(0,s.nullish)(t.rotation,this.rotation),drawWidth:(0,s.nullish)(t.drawWidth,this.drawWidth),drawHeight:(0,s.nullish)(t.drawHeight,this.drawHeight),flipHorizontal:(0,s.nullish)(t.flipHorizontal,this.flipHorizontal),flipVertical:(0,s.nullish)(t.flipVertical,this.flipVertical),anchor:(0,s.nullish)(t.anchor,this.anchor),offset:(0,s.nullish)(t.offset,this.offset),opacity:(0,s.nullish)(t.opacity,this._opacity)}),i=e.ctx,r=e.x,h=e.y,a=e.rotation,o=e.drawWidth,n=e.drawHeight,f=e.anchor,l=e.offset,c=e.opacity,u=e.flipHorizontal,d=e.flipVertical;this._dirtyEffect&&this._applyEffects(),i.save();var g=o*f.x+l.x,_=n*f.y+l.y;i.translate(r,h),i.rotate(a),u&&(i.translate(o,0),i.scale(-1,1)),d&&(i.translate(0,n),i.scale(1,-1));var y=i.globalAlpha;i.globalAlpha=(0,s.nullish)(c,1),i.drawImage(this._spriteCanvas,0,0,this.width,this.height,-g,-_,o,n),i.globalAlpha=y,i.restore()},a.prototype.clone=function(){var t=new c(this._texture,this.x,this.y,this.width,this.height);t.scale=this.scale.clone(),t.rotation=this.rotation,t.flipHorizontal=this.flipHorizontal,t.flipVertical=this.flipVertical;for(var e=this.effects.length,i=0;i<e;i++)t.addEffect(this.effects[i]);return t},a.__ID=0,a}();exports.SpriteImpl=l;var c=function(t){function e(e,i,r,h,s){return t.call(this,e,i,r,h,s)||this}return f(e,t),e}((0,a.Configurable)(l));exports.Sprite=c;
},{"./SpriteEffects":"OEQf","./Color":"p7Gh","../Resources/Texture":"HrNa","../Algebra":"NGcQ","../Util/Log":"p1Gn","../Util/Util":"Kkda","../Configurable":"A4Kj"}],"HrNa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Texture=void 0;var e=require("./Resource"),t=require("../Drawing/Sprite"),i=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(e){function r(i,r){void 0===r&&(r=!0);var o=e.call(this,i,"blob",r)||this;return o.path=i,o.bustCache=r,o.loaded=new Promise(function(e){o._loadedResolve=e}),o._isLoaded=!1,o._sprite=null,o._sprite=new t.Sprite(o,0,0,0,0),o}return i(r,e),r.prototype.isLoaded=function(){return this._isLoaded},r.prototype.load=function(){var i=this;return new Promise(function(r,o){i.path.indexOf("data:image/")>-1?(i.image=new Image,i.image.addEventListener("load",function(){i.width=i._sprite.width=i.image.naturalWidth,i.height=i._sprite.height=i.image.naturalHeight,i._sprite=new t.Sprite(i,0,0,i.width,i.height),i._loadedResolve(i.image),r(i.image)}),i.image.src=i.path):e.prototype.load.call(i).then(function(){i.image=new Image,i.image.addEventListener("load",function(){i._isLoaded=!0,i.width=i._sprite.width=i.image.naturalWidth,i.height=i._sprite.height=i.image.naturalHeight,i._loadedResolve(i.image),r(i.image)}),i.image.src=e.prototype.getData.call(i)},function(){o("Error loading texture.")})})},r.prototype.asSprite=function(){return this._sprite},r}(e.Resource);exports.Texture=r;
},{"./Resource":"lN80","../Drawing/Sprite":"PpGD"}],"DrJU":[function(require,module,exports) {
"use strict";var t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RotationType=void 0,exports.RotationType=t,function(t){t[t.ShortestPath=0]="ShortestPath",t[t.LongestPath=1]="LongestPath",t[t.Clockwise=2]="Clockwise",t[t.CounterClockwise=3]="CounterClockwise"}(t||(exports.RotationType=t={}));
},{}],"gDdL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionQueue=exports.RepeatForever=exports.Repeat=exports.CallMethod=exports.Die=exports.Fade=exports.Blink=exports.Delay=exports.ScaleBy=exports.ScaleTo=exports.RotateBy=exports.RotateTo=exports.Meet=exports.Follow=exports.MoveBy=exports.MoveTo=exports.EaseTo=void 0;var t=require("./RotationType"),s=require("../Algebra"),e=require("../Util/Log"),i=h(require("../Util/Util")),o=require("../Util/Decorators");function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function h(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var s=r();if(s&&s.has(t))return s.get(t);var e={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var h=i?Object.getOwnPropertyDescriptor(t,o):null;h&&(h.get||h.set)?Object.defineProperty(e,o,h):e[o]=t[o]}return e.default=t,s&&s.set(t,e),e}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=function(t,s,e,i){var o,r=arguments.length,h=r<3?s:null===i?i=Object.getOwnPropertyDescriptor(s,e):i;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,s,e,i);else for(var n=t.length-1;n>=0;n--)(o=t[n])&&(h=(r<3?o(h):r>3?o(s,e,h):o(s,e))||h);return r>3&&h&&Object.defineProperty(s,e,h),h},_=function(){function t(t,e,i,o,r){this.actor=t,this.easingFcn=r,this._currentLerpTime=0,this._lerpDuration=1e3,this._lerpStart=new s.Vector(0,0),this._lerpEnd=new s.Vector(0,0),this._initialized=!1,this._stopped=!1,this._distance=0,this._lerpDuration=o,this._lerpEnd=new s.Vector(e,i)}return t.prototype._initialize=function(){this._lerpStart=new s.Vector(this.actor.pos.x,this.actor.pos.y),this._currentLerpTime=0,this._distance=this._lerpStart.distance(this._lerpEnd)},t.prototype.update=function(t){this._initialized||(this._initialize(),this._initialized=!0);var s=this.actor.pos.x,e=this.actor.pos.y;this._currentLerpTime<this._lerpDuration?(s=this._lerpEnd.x<this._lerpStart.x?this._lerpStart.x-(this.easingFcn(this._currentLerpTime,this._lerpEnd.x,this._lerpStart.x,this._lerpDuration)-this._lerpEnd.x):this.easingFcn(this._currentLerpTime,this._lerpStart.x,this._lerpEnd.x,this._lerpDuration),e=this._lerpEnd.y<this._lerpStart.y?this._lerpStart.y-(this.easingFcn(this._currentLerpTime,this._lerpEnd.y,this._lerpStart.y,this._lerpDuration)-this._lerpEnd.y):this.easingFcn(this._currentLerpTime,this._lerpStart.y,this._lerpEnd.y,this._lerpDuration),this.actor.pos.x=s,this.actor.pos.y=e,this._currentLerpTime+=t):(this.actor.pos.x=this._lerpEnd.x,this.actor.pos.y=this._lerpEnd.y)},t.prototype.isComplete=function(t){return this._stopped||new s.Vector(t.pos.x,t.pos.y).distance(this._lerpStart)>=this._distance},t.prototype.reset=function(){this._initialized=!1},t.prototype.stop=function(){this._stopped=!0},t}();exports.EaseTo=_;var p=function(){function t(t,e,i,o){this._started=!1,this._stopped=!1,this._actor=t,this._end=new s.Vector(e,i),this._speed=o}return t.prototype.update=function(t){this._started||(this._started=!0,this._start=new s.Vector(this._actor.pos.x,this._actor.pos.y),this._distance=this._start.distance(this._end),this._dir=this._end.sub(this._start).normalize());var e=this._dir.scale(this._speed);this._actor.vel.x=e.x,this._actor.vel.y=e.y,this.isComplete(this._actor)&&(this._actor.pos.x=this._end.x,this._actor.pos.y=this._end.y,this._actor.vel.y=0,this._actor.vel.x=0)},t.prototype.isComplete=function(t){return this._stopped||new s.Vector(t.pos.x,t.pos.y).distance(this._start)>=this._distance},t.prototype.stop=function(){this._actor.vel.y=0,this._actor.vel.x=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();exports.MoveTo=p;var c=function(){function t(t,i,o,r){if(this._started=!1,this._stopped=!1,this._actor=t,this._speed=r,this._offset=new s.Vector(i,o),r<=0)throw e.Logger.getInstance().error("Attempted to moveBy with speed less than or equal to zero : "+r),new Error("Speed must be greater than 0 pixels per second")}return t.prototype.update=function(t){this._started||(this._started=!0,this._start=new s.Vector(this._actor.pos.x,this._actor.pos.y),this._end=this._start.add(this._offset),this._distance=this._offset.size,this._dir=this._end.sub(this._start).normalize()),this._actor.vel=this._dir.scale(this._speed),this.isComplete(this._actor)&&(this._actor.pos.x=this._end.x,this._actor.pos.y=this._end.y,this._actor.vel.y=0,this._actor.vel.x=0)},t.prototype.isComplete=function(t){return this._stopped||t.pos.distance(this._start)>=this._distance},t.prototype.stop=function(){this._actor.vel.y=0,this._actor.vel.x=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();exports.MoveBy=c;var d=function(){function t(t,e,i){this._started=!1,this._stopped=!1,this._actor=t,this._actorToFollow=e,this._current=new s.Vector(this._actor.pos.x,this._actor.pos.y),this._end=new s.Vector(e.pos.x,e.pos.y),this._maximumDistance=void 0!==i?i:this._current.distance(this._end),this._speed=0}return t.prototype.update=function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var s=Math.sqrt(Math.pow(this._actorToFollow.vel.x,2)+Math.pow(this._actorToFollow.vel.y,2));if(0!==s&&(this._speed=s),this._current.x=this._actor.pos.x,this._current.y=this._actor.pos.y,this._end.x=this._actorToFollow.pos.x,this._end.y=this._actorToFollow.pos.y,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize(),this._distanceBetween>=this._maximumDistance){var e=this._dir.scale(this._speed);this._actor.vel.x=e.x,this._actor.vel.y=e.y}else this._actor.vel.x=0,this._actor.vel.y=0;this.isComplete()&&(this._actor.pos.x=this._end.x,this._actor.pos.y=this._end.y,this._actor.vel.y=0,this._actor.vel.x=0)},t.prototype.stop=function(){this._actor.vel.y=0,this._actor.vel.x=0,this._stopped=!0},t.prototype.isComplete=function(){return this._stopped},t.prototype.reset=function(){this._started=!1},t}();exports.Follow=d;var l=function(){function t(t,e,i){this._started=!1,this._stopped=!1,this._speedWasSpecified=!1,this._actor=t,this._actorToMeet=e,this._current=new s.Vector(this._actor.pos.x,this._actor.pos.y),this._end=new s.Vector(e.pos.x,e.pos.y),this._speed=i||0,void 0!==i&&(this._speedWasSpecified=!0)}return t.prototype.update=function(t){this._started||(this._started=!0,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize());var s=Math.sqrt(Math.pow(this._actorToMeet.vel.x,2)+Math.pow(this._actorToMeet.vel.y,2));0===s||this._speedWasSpecified||(this._speed=s),this._current.x=this._actor.pos.x,this._current.y=this._actor.pos.y,this._end.x=this._actorToMeet.pos.x,this._end.y=this._actorToMeet.pos.y,this._distanceBetween=this._current.distance(this._end),this._dir=this._end.sub(this._current).normalize();var e=this._dir.scale(this._speed);this._actor.vel.x=e.x,this._actor.vel.y=e.y,this.isComplete()&&(this._actor.pos.x=this._end.x,this._actor.pos.y=this._end.y,this._actor.vel.y=0,this._actor.vel.x=0)},t.prototype.isComplete=function(){return this._stopped||this._distanceBetween<=1},t.prototype.stop=function(){this._actor.vel.y=0,this._actor.vel.x=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();exports.Meet=l;var u=function(){function s(s,e,i,o){this._started=!1,this._stopped=!1,this._actor=s,this._end=e,this._speed=i,this._rotationType=o||t.RotationType.ShortestPath}return s.prototype.update=function(s){if(!this._started){this._started=!0,this._start=this._actor.rotation;var e=Math.abs(this._end-this._start),o=i.TwoPI-e;switch(e>o?(this._shortDistance=o,this._longDistance=e):(this._shortDistance=e,this._longDistance=o),this._shortestPathIsPositive=(this._start-this._end+i.TwoPI)%i.TwoPI>=Math.PI,this._rotationType){case t.RotationType.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case t.RotationType.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case t.RotationType.Clockwise:this._direction=1,this._shortestPathIsPositive?this._distance=this._shortDistance:this._distance=this._longDistance;break;case t.RotationType.CounterClockwise:this._direction=-1,this._shortestPathIsPositive?this._distance=this._longDistance:this._distance=this._shortDistance}}this._actor.rx=this._direction*this._speed,this.isComplete()&&(this._actor.rotation=this._end,this._actor.rx=0,this._stopped=!0)},s.prototype.isComplete=function(){var t=Math.abs(this._actor.rotation-this._start);return this._stopped||t>=Math.abs(this._distance)},s.prototype.stop=function(){this._actor.rx=0,this._stopped=!0},s.prototype.reset=function(){this._started=!1},s}();exports.RotateTo=u;var y=function(){function s(s,e,i,o){this._started=!1,this._stopped=!1,this._actor=s,this._speed=i,this._offset=e,this._rotationType=o||t.RotationType.ShortestPath}return s.prototype.update=function(s){if(!this._started){this._started=!0,this._start=this._actor.rotation,this._end=this._start+this._offset;var e=Math.abs(this._end-this._start),o=i.TwoPI-e;switch(e>o?(this._shortDistance=o,this._longDistance=e):(this._shortDistance=e,this._longDistance=o),this._shortestPathIsPositive=(this._start-this._end+i.TwoPI)%i.TwoPI>=Math.PI,this._rotationType){case t.RotationType.ShortestPath:this._distance=this._shortDistance,this._shortestPathIsPositive?this._direction=1:this._direction=-1;break;case t.RotationType.LongestPath:this._distance=this._longDistance,this._shortestPathIsPositive?this._direction=-1:this._direction=1;break;case t.RotationType.Clockwise:this._direction=1,this._shortDistance>=0?this._distance=this._shortDistance:this._distance=this._longDistance;break;case t.RotationType.CounterClockwise:this._direction=-1,this._shortDistance<=0?this._distance=this._shortDistance:this._distance=this._longDistance}}this._actor.rx=this._direction*this._speed,this.isComplete()&&(this._actor.rotation=this._end,this._actor.rx=0,this._stopped=!0)},s.prototype.isComplete=function(){var t=Math.abs(this._actor.rotation-this._start);return this._stopped||t>=Math.abs(this._distance)},s.prototype.stop=function(){this._actor.rx=0,this._stopped=!0},s.prototype.reset=function(){this._started=!1},s}();exports.RotateBy=y;var f=function(){function t(t,s,e,i,o){this._started=!1,this._stopped=!1,this._actor=t,this._endX=s,this._endY=e,this._speedX=i,this._speedY=o}return t.prototype.update=function(t){if(this._started||(this._started=!0,this._startX=this._actor.scale.x,this._startY=this._actor.scale.y,this._distanceX=Math.abs(this._endX-this._startX),this._distanceY=Math.abs(this._endY-this._startY)),Math.abs(this._actor.scale.x-this._startX)>=this._distanceX)this._actor.sx=0;else{var s=this._endY<this._startY?-1:1;this._actor.sx=this._speedX*s}if(Math.abs(this._actor.scale.y-this._startY)>=this._distanceY)this._actor.sy=0;else{var e=this._endY<this._startY?-1:1;this._actor.sy=this._speedY*e}this.isComplete()&&(this._actor.scale.x=this._endX,this._actor.scale.y=this._endY,this._actor.sx=0,this._actor.sy=0)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this._actor.scale.y-this._startX)>=this._distanceX&&Math.abs(this._actor.scale.y-this._startY)>=this._distanceY},t.prototype.stop=function(){this._actor.sx=0,this._actor.sy=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t=n([(0,o.obsolete)({message:"ex.Action.ScaleTo will be removed in v0.25.0",alternateMethod:"Set width and hight directly"})],t)}();exports.ScaleTo=f;var x=function(){function t(t,e,i,o){this._started=!1,this._stopped=!1,this._actor=t,this._offset=new s.Vector(e,i),this._speedX=this._speedY=o}return t.prototype.update=function(t){this._started||(this._started=!0,this._startScale=this._actor.scale.clone(),this._endScale=this._startScale.add(this._offset),this._distanceX=Math.abs(this._endScale.x-this._startScale.x),this._distanceY=Math.abs(this._endScale.y-this._startScale.y),this._directionX=this._endScale.x<this._startScale.x?-1:1,this._directionY=this._endScale.y<this._startScale.y?-1:1),this._actor.sx=this._speedX*this._directionX,this._actor.sy=this._speedY*this._directionY,this.isComplete()&&(this._actor.scale=this._endScale,this._actor.sx=0,this._actor.sy=0)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this._actor.scale.x-this._startScale.x)>=this._distanceX&&Math.abs(this._actor.scale.y-this._startScale.y)>=this._distanceY},t.prototype.stop=function(){this._actor.sx=0,this._actor.sy=0,this._stopped=!0},t.prototype.reset=function(){this._started=!1},t=n([(0,o.obsolete)({message:"ex.Action.ScaleBy will be removed in v0.25.0",alternateMethod:"Set width and hight directly"})],t)}();exports.ScaleBy=x;var v=function(){function t(t,s){this._elapsedTime=0,this._started=!1,this._stopped=!1,this._actor=t,this._delay=s}return t.prototype.update=function(t){this._started||(this._started=!0),this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._elapsedTime+=t},t.prototype.isComplete=function(){return this._stopped||this._elapsedTime>=this._delay},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this._elapsedTime=0,this._started=!1},t}();exports.Delay=v;var m=function(){function t(t,s,e,i){void 0===i&&(i=1),this._timeVisible=0,this._timeNotVisible=0,this._elapsedTime=0,this._totalTime=0,this._stopped=!1,this._started=!1,this._actor=t,this._timeVisible=s,this._timeNotVisible=e,this._duration=(s+e)*i}return t.prototype.update=function(t){this._started||(this._started=!0),this._elapsedTime+=t,this._totalTime+=t,this._actor.visible&&this._elapsedTime>=this._timeVisible&&(this._actor.visible=!1,this._elapsedTime=0),!this._actor.visible&&this._elapsedTime>=this._timeNotVisible&&(this._actor.visible=!0,this._elapsedTime=0),this.isComplete()&&(this._actor.visible=!0)},t.prototype.isComplete=function(){return this._stopped||this._totalTime>=this._duration},t.prototype.stop=function(){this._actor.visible=!0,this._stopped=!0},t.prototype.reset=function(){this._started=!1,this._elapsedTime=0,this._totalTime=0},t}();exports.Blink=m;var b=function(){function t(t,s,e){this._multiplier=1,this._started=!1,this._stopped=!1,this._actor=t,this._endOpacity=s,this._speed=e}return t.prototype.update=function(t){this._started||(this._started=!0,this._endOpacity<this._actor.opacity?this._multiplier=-1:this._multiplier=1),this._speed>0&&(this._actor.opacity+=this._multiplier*(Math.abs(this._actor.opacity-this._endOpacity)*t)/this._speed),this._speed-=t,this.isComplete()&&(this._actor.opacity=this._endOpacity),e.Logger.getInstance().debug("[Action fade] Actor opacity:",this._actor.opacity)},t.prototype.isComplete=function(){return this._stopped||Math.abs(this._actor.opacity-this._endOpacity)<.05},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this._started=!1},t}();exports.Fade=b;var T=function(){function t(t){this._stopped=!1,this._actor=t}return t.prototype.update=function(t){this._actor.actionQueue.clearActions(),this._actor.kill(),this._stopped=!0},t.prototype.isComplete=function(){return this._stopped},t.prototype.stop=function(){},t.prototype.reset=function(){},t}();exports.Die=T;var w=function(){function t(t,s){this._method=null,this._actor=null,this._hasBeenCalled=!1,this._actor=t,this._method=s}return t.prototype.update=function(t){this._method.call(this._actor),this._hasBeenCalled=!0},t.prototype.isComplete=function(){return this._hasBeenCalled},t.prototype.reset=function(){this._hasBeenCalled=!1},t.prototype.stop=function(){this._hasBeenCalled=!0},t}();exports.CallMethod=w;var g=function(){function t(t,s,e){this._stopped=!1,this._actor=t,this._actionQueue=new M(t),this._repeat=s,this._originalRepeat=s;for(var i=e.length,o=0;o<i;o++)e[o].reset(),this._actionQueue.add(e[o])}return t.prototype.update=function(t){this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._actionQueue.hasNext()||(this._actionQueue.reset(),this._repeat--),this._actionQueue.update(t)},t.prototype.isComplete=function(){return this._stopped||this._repeat<=0},t.prototype.stop=function(){this._stopped=!0},t.prototype.reset=function(){this._repeat=this._originalRepeat},t}();exports.Repeat=g;var S=function(){function t(t,s){this._stopped=!1,this._actor=t,this._actionQueue=new M(t);for(var e=s.length,i=0;i<e;i++)s[i].reset(),this._actionQueue.add(s[i])}return t.prototype.update=function(t){this.x=this._actor.pos.x,this.y=this._actor.pos.y,this._stopped||(this._actionQueue.hasNext()||this._actionQueue.reset(),this._actionQueue.update(t))},t.prototype.isComplete=function(){return this._stopped},t.prototype.stop=function(){this._stopped=!0,this._actionQueue.clearActions()},t.prototype.reset=function(){},t}();exports.RepeatForever=S;var M=function(){function t(t){this._actions=[],this._completedActions=[],this._actor=t}return t.prototype.add=function(t){this._actions.push(t)},t.prototype.remove=function(t){var s=this._actions.indexOf(t);this._actions.splice(s,1)},t.prototype.clearActions=function(){this._actions.length=0,this._completedActions.length=0,this._currentAction&&this._currentAction.stop()},t.prototype.getActions=function(){return this._actions.concat(this._completedActions)},t.prototype.hasNext=function(){return this._actions.length>0},t.prototype.reset=function(){this._actions=this.getActions();for(var t=this._actions.length,s=0;s<t;s++)this._actions[s].reset();this._completedActions=[]},t.prototype.update=function(t){this._actions.length>0&&(this._currentAction=this._actions[0],this._currentAction.update(t),this._currentAction.isComplete(this._actor)&&this._completedActions.push(this._actions.shift()))},t}();exports.ActionQueue=M;
},{"./RotationType":"DrJU","../Algebra":"NGcQ","../Util/Log":"p1Gn","../Util/Util":"Kkda","../Util/Decorators":"kQDE"}],"LpjS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EasingFunctions=void 0;var e=require("../Algebra"),n=require("../Util/Decorators");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=function(e,n,r,i){var o,u=arguments.length,c=u<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,r):i;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,n,r,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(c=(u<3?o(c):u>3?o(n,r,c):o(n,r))||c);return u>3&&c&&Object.defineProperty(n,r,c),c},i=function(){function t(){}return t.CreateReversibleEasingFunction=function(e){return function(n,t,r,i){return r<t?t-(e(n,r,t,i)-r):e(n,t,r,i)}},t.CreateReversableEasingFunction=function(e){return t.CreateReversibleEasingFunction(e)},t.CreateVectorEasingFunction=function(n){return function(t,r,i,o){return new e.Vector(n(t,r.x,i.x,o),n(t,r.y,i.y,o))}},t.Linear=t.CreateReversibleEasingFunction(function(e,n,t,r){return(t-=n)*e/r+n}),t.EaseInQuad=t.CreateReversibleEasingFunction(function(e,n,t,r){return(t-=n)*(e/=r)*e+n}),t.EaseOutQuad=t.CreateReversibleEasingFunction(function(e,n,t,r){return-(t-=n)*(e/=r)*(e-2)+n}),t.EaseInOutQuad=t.CreateReversibleEasingFunction(function(e,n,t,r){return t-=n,(e/=r/2)<1?t/2*e*e+n:-t/2*(--e*(e-2)-1)+n}),t.EaseInCubic=t.CreateReversibleEasingFunction(function(e,n,t,r){return(t-=n)*(e/=r)*e*e+n}),t.EaseOutCubic=t.CreateReversibleEasingFunction(function(e,n,t,r){return e/=r,(t-=n)*(--e*e*e+1)+n}),t.EaseInOutCubic=t.CreateReversibleEasingFunction(function(e,n,t,r){return t-=n,(e/=r/2)<1?t/2*e*e*e+n:t/2*((e-=2)*e*e+2)+n}),r([(0,n.obsolete)({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"CreateReversibleEasingFunction"})],t,"CreateReversableEasingFunction",null),t}();exports.EasingFunctions=i;
},{"../Algebra":"NGcQ","../Util/Decorators":"kQDE"}],"vA04":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ActionContext=void 0;var t=o(require("./Action")),e=require("../Util/EasingFunctions");function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function o(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var u=s?Object.getOwnPropertyDescriptor(t,i):null;u&&(u.get||u.set)?Object.defineProperty(o,i,u):o[i]=t[i]}return o.default=t,e&&e.set(t,o),o}var s=function(){function r(){this._actors=[],this._queues=[],null!==arguments&&(this._actors=Array.prototype.slice.call(arguments,0),this._queues=this._actors.map(function(t){return t.actionQueue}))}return r.prototype.clearActions=function(){for(var t=this._queues.length,e=0;e<t;e++)this._queues[e].clearActions()},r.prototype.addActorToContext=function(t){this._actors.push(t),this._queues.push(t.actionQueue)},r.prototype.removeActorFromContext=function(t){var e=this._actors.indexOf(t);e>-1&&(this._actors.splice(e,1),this._queues.splice(e,1))},r.prototype.easeTo=function(r,o,s,i){void 0===i&&(i=e.EasingFunctions.Linear);for(var u=this._queues.length,n=0;n<u;n++)this._queues[n].add(new t.EaseTo(this._actors[n],r,o,s,i));return this},r.prototype.moveTo=function(e,r,o){for(var s=this._queues.length,i=0;i<s;i++)this._queues[i].add(new t.MoveTo(this._actors[i],e,r,o));return this},r.prototype.moveBy=function(e,r,o){for(var s=this._queues.length,i=0;i<s;i++)this._queues[i].add(new t.MoveBy(this._actors[i],e,r,o));return this},r.prototype.rotateTo=function(e,r,o){for(var s=this._queues.length,i=0;i<s;i++)this._queues[i].add(new t.RotateTo(this._actors[i],e,r,o));return this},r.prototype.rotateBy=function(e,r,o){for(var s=this._queues.length,i=0;i<s;i++)this._queues[i].add(new t.RotateBy(this._actors[i],e,r,o));return this},r.prototype.scaleTo=function(e,r,o,s){for(var i=this._queues.length,u=0;u<i;u++)this._queues[u].add(new t.ScaleTo(this._actors[u],e,r,o,s));return this},r.prototype.scaleBy=function(e,r,o){for(var s=this._queues.length,i=0;i<s;i++)this._queues[i].add(new t.ScaleBy(this._actors[i],e,r,o));return this},r.prototype.blink=function(e,r,o){void 0===o&&(o=1);for(var s=this._queues.length,i=0;i<s;i++)this._queues[i].add(new t.Blink(this._actors[i],e,r,o));return this},r.prototype.fade=function(e,r){for(var o=this._queues.length,s=0;s<o;s++)this._queues[s].add(new t.Fade(this._actors[s],e,r));return this},r.prototype.delay=function(e){for(var r=this._queues.length,o=0;o<r;o++)this._queues[o].add(new t.Delay(this._actors[o],e));return this},r.prototype.die=function(){for(var e=this._queues.length,r=0;r<e;r++)this._queues[r].add(new t.Die(this._actors[r]));return this},r.prototype.callMethod=function(e){for(var r=this._queues.length,o=0;o<r;o++)this._queues[o].add(new t.CallMethod(this._actors[o],e));return this},r.prototype.repeat=function(e){if(!e)return this.repeatForever(),this;for(var r=this._queues.length,o=0;o<r;o++)this._queues[o].add(new t.Repeat(this._actors[o],e,this._actors[o].actionQueue.getActions()));return this},r.prototype.repeatForever=function(){for(var e=this._queues.length,r=0;r<e;r++)this._queues[r].add(new t.RepeatForever(this._actors[r],this._actors[r].actionQueue.getActions()));return this},r.prototype.follow=function(e,r){for(var o=this._queues.length,s=0;s<o;s++)void 0===r?this._queues[s].add(new t.Follow(this._actors[s],e)):this._queues[s].add(new t.Follow(this._actors[s],e,r));return this},r.prototype.meet=function(e,r){for(var o=this._queues.length,s=0;s<o;s++)void 0===r?this._queues[s].add(new t.Meet(this._actors[s],e)):this._queues[s].add(new t.Meet(this._actors[s],e,r));return this},r.prototype.asPromise=function(){var e=this,r=this._queues.map(function(r,o){return new Promise(function(s){r.add(new t.CallMethod(e._actors[o],function(){s()}))})});return Promise.all(r)},r}();exports.ActionContext=s;
},{"./Action":"gDdL","../Util/EasingFunctions":"LpjS"}],"liCD":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionType=void 0,exports.CollisionType=e,function(e){e.PreventCollision="PreventCollision",e.Passive="Passive",e.Active="Active",e.Fixed="Fixed"}(e||(exports.CollisionType=e={}));
},{}],"uSEN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Physics=exports.Integrator=exports.BroadphaseStrategy=exports.CollisionResolutionStrategy=void 0;var e=require("./Algebra"),o=require("./Util/Decorators");function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,r,n,l=function(e,o,i,r){var n,l=arguments.length,s=l<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,i):r;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,o,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(l<3?n(s):l>3?n(o,i,s):n(o,i))||s);return l>3&&s&&Object.defineProperty(o,i,s),s};exports.CollisionResolutionStrategy=i,function(e){e[e.Box=0]="Box",e[e.RigidBody=1]="RigidBody"}(i||(exports.CollisionResolutionStrategy=i={})),exports.BroadphaseStrategy=r,function(e){e[e.Naive=0]="Naive",e[e.DynamicAABBTree=1]="DynamicAABBTree"}(r||(exports.BroadphaseStrategy=r={})),exports.Integrator=n,function(e){e[e.Euler=0]="Euler"}(n||(exports.Integrator=n={}));var s=function(){function t(){}return t.useBoxPhysics=function(){t.collisionResolutionStrategy=i.Box},t.useRigidBodyPhysics=function(){t.collisionResolutionStrategy=i.RigidBody},Object.defineProperty(t,"dynamicTreeVelocityMultiplyer",{get:function(){return t.dynamicTreeVelocityMultiplier},set:function(e){t.dynamicTreeVelocityMultiplier=e},enumerable:!0,configurable:!0}),t.acc=new e.Vector(0,0),t.enabled=!0,t.collisionPasses=5,t.broadphaseStrategy=r.DynamicAABBTree,t.broadphaseDebug=!1,t.showCollisionNormals=!1,t.showMotionVectors=!1,t.showBounds=!1,t.showArea=!1,t.showContacts=!1,t.showNormals=!1,t.collisionResolutionStrategy=i.Box,t.defaultMass=10,t.integrator=n.Euler,t.integrationSteps=1,t.allowRigidBodyRotation=!0,t.collisionShift=.001,t.dynamicTreeVelocityMultiplier=2,t.boundsPadding=5,t.surfaceEpsilon=.1,t.checkForFastBodies=!0,t.disableMinimumSpeedForFastBody=!1,l([(0,o.obsolete)({message:"Alias for incorrect spelling used in older versions, will be removed in v0.25.0",alternateMethod:"dynamicTreeVelocityMultiplier"})],t,"dynamicTreeVelocityMultiplyer",null),t}();exports.Physics=s;
},{"./Algebra":"NGcQ","./Util/Decorators":"kQDE"}],"oyna":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoundingBox=void 0;var t=require("./ConvexPolygon"),o=require("../Algebra"),i=require("../Drawing/Color"),e=require("./Side");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=function(){function n(t,o,i,e){void 0===t&&(t=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===e&&(e=0),"object"===r(t)?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):"number"==typeof t&&(this.left=t,this.top=o,this.right=i,this.bottom=e)}return n.getSideFromIntersection=function(t){return t&&t?Math.abs(t.x)>Math.abs(t.y)?t.x<0?e.Side.Right:e.Side.Left:t.y<0?e.Side.Bottom:e.Side.Top:e.Side.None},n.fromPoints=function(t){for(var o=1/0,i=1/0,e=-1/0,r=-1/0,h=0;h<t.length;h++)t[h].x<o&&(o=t[h].x),t[h].x>e&&(e=t[h].x),t[h].y<i&&(i=t[h].y),t[h].y>r&&(r=t[h].y);return new n(o,i,e,r)},n.fromDimension=function(t,i,e,r){return void 0===e&&(e=o.Vector.Half),void 0===r&&(r=o.Vector.Zero),new n(-t*e.x+r.x,-i*e.y+r.y,t-t*e.x+r.x,i-i*e.y+r.y)},Object.defineProperty(n.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{get:function(){return new o.Vector((this.left+this.right)/2,(this.top+this.bottom)/2)},enumerable:!0,configurable:!0}),n.prototype.translate=function(t){return new n(this.left+t.x,this.top+t.y,this.right+t.x,this.bottom+t.y)},n.prototype.rotate=function(t,i){void 0===i&&(i=o.Vector.Zero);var e=this.getPoints().map(function(o){return o.rotate(t,i)});return n.fromPoints(e)},n.prototype.scale=function(t,i){void 0===i&&(i=o.Vector.Zero);var e=this.translate(i);return new n(e.left*t.x,e.top*t.y,e.right*t.x,e.bottom*t.y)},n.prototype.getPerimeter=function(){return 2*(this.width+this.height)},n.prototype.getPoints=function(){var t=[];return t.push(new o.Vector(this.left,this.top)),t.push(new o.Vector(this.right,this.top)),t.push(new o.Vector(this.right,this.bottom)),t.push(new o.Vector(this.left,this.bottom)),t},n.prototype.toPolygon=function(i){var e=null;return i&&i.body&&i.body.collider&&(e=i.body.collider),new t.ConvexPolygon({collider:e,points:this.getPoints(),offset:o.Vector.Zero})},n.prototype.rayCast=function(t,o){void 0===o&&(o=1/0);var i=-1/0,e=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,n=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,h=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;i=Math.min(h,s),e=Math.max(h,s);var p=(this.top-t.pos.y)*n,a=(this.bottom-t.pos.y)*n;return i=Math.max(i,Math.min(p,a)),(e=Math.min(e,Math.max(p,a)))>=Math.max(0,i)&&i<o},n.prototype.rayCastTime=function(t,o){void 0===o&&(o=1/0);var i=-1/0,e=1/0,r=0===t.dir.x?Number.MAX_VALUE:1/t.dir.x,n=0===t.dir.y?Number.MAX_VALUE:1/t.dir.y,h=(this.left-t.pos.x)*r,s=(this.right-t.pos.x)*r;i=Math.min(h,s),e=Math.max(h,s);var p=(this.top-t.pos.y)*n,a=(this.bottom-t.pos.y)*n;return i=Math.max(i,Math.min(p,a)),(e=Math.min(e,Math.max(p,a)))>=Math.max(0,i)&&i<o?i:-1},n.prototype.contains=function(t){return t instanceof o.Vector?this.left<=t.x&&this.top<=t.y&&this.bottom>=t.y&&this.right>=t.x:t instanceof n&&(this.left<t.left&&this.top<t.top&&t.bottom<this.bottom&&t.right<this.right)},n.prototype.combine=function(t){return new n(Math.min(this.left,t.left),Math.min(this.top,t.top),Math.max(this.right,t.right),Math.max(this.bottom,t.bottom))},Object.defineProperty(n.prototype,"dimensions",{get:function(){return new o.Vector(this.width,this.height)},enumerable:!0,configurable:!0}),n.prototype.intersect=function(t){var i=this.combine(t);if(i.width<t.width+this.width&&i.height<t.height+this.height&&!i.dimensions.equals(t.dimensions)&&!i.dimensions.equals(this.dimensions)){var e=0;e=this.right>=t.left&&this.right<=t.right?t.left-this.right:t.right-this.left;var r=0;return r=this.top<=t.bottom&&this.top>=t.top?t.bottom-this.top:t.top-this.bottom,Math.abs(e)<Math.abs(r)?new o.Vector(e,0):new o.Vector(0,r)}if(i.dimensions.equals(t.dimensions)||i.dimensions.equals(this.dimensions)){e=0;e=this.width-t.width>=0?this.right-t.right<=t.left-this.left?t.left-this.right:t.right-this.left:t.right-this.right<=this.left-t.left?this.left-t.right:this.right-t.left;r=0;return r=this.height-t.height>=0?this.bottom-t.bottom<=t.top-this.top?t.top-this.bottom:t.bottom-this.top:t.bottom-this.bottom<=this.top-t.top?this.top-t.bottom:this.bottom-t.top,Math.abs(e)<Math.abs(r)?new o.Vector(e,0):new o.Vector(0,r)}return null},n.prototype.intersectWithSide=function(t){var o=this.intersect(t);return n.getSideFromIntersection(o)},n.prototype.debugDraw=function(t,o){void 0===o&&(o=i.Color.Yellow),t.strokeStyle=o.toString(),t.strokeRect(this.left,this.top,this.width,this.height)},n}();exports.BoundingBox=n;
},{"./ConvexPolygon":"EI0S","../Algebra":"NGcQ","../Drawing/Color":"p7Gh","./Side":"YM02"}],"rA38":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionContact=void 0;var i=require("../Algebra"),e=require("../Physics"),o=require("../Events"),l=r(require("../Util/Util")),t=require("./CollisionType");function s(){if("function"!=typeof WeakMap)return null;var i=new WeakMap;return s=function(){return i},i}function r(i){if(i&&i.__esModule)return i;if(null===i||"object"!=typeof i&&"function"!=typeof i)return{default:i};var e=s();if(e&&e.has(i))return e.get(i);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var r=l?Object.getOwnPropertyDescriptor(i,t):null;r&&(r.get||r.set)?Object.defineProperty(o,t,r):o[t]=i[t]}return o.default=i,e&&e.set(i,o),o}var n=function(){function s(i,e,o,l,t){this.colliderA=i,this.colliderB=e,this.mtv=o,this.point=l,this.normal=t}return s.prototype.resolve=function(i){if(i===e.CollisionResolutionStrategy.RigidBody)this._resolveRigidBodyCollision();else{if(i!==e.CollisionResolutionStrategy.Box)throw new Error("Unknown collision resolution strategy");this._resolveBoxCollision()}},s.prototype._applyBoxImpulse=function(i,e,s){if(i.type===t.CollisionType.Active&&e.type!==t.CollisionType.Passive){i.type===t.CollisionType.Active&&e.type===t.CollisionType.Active&&(s=s.scale(.5)),i.body.pos.y+=s.y,i.body.pos.x+=s.x;var r=s.normalize();if(r.dot(i.body.vel)<0){var n=r.scale(r.dot(i.body.vel.negate()));i.body.vel=i.body.vel.add(n)}i.emit("postcollision",new o.PostCollisionEvent(i,e,l.getSideFromDirection(s),s))}},s.prototype._resolveBoxCollision=function(){var i=l.getSideFromDirection(this.mtv),e=this.mtv.negate();this.colliderA.emit("precollision",new o.PreCollisionEvent(this.colliderA,this.colliderB,i,e)),this.colliderB.emit("precollision",new o.PreCollisionEvent(this.colliderB,this.colliderA,l.getOppositeSide(i),e.negate())),this._applyBoxImpulse(this.colliderA,this.colliderB,e),this._applyBoxImpulse(this.colliderB,this.colliderA,e.negate())},s.prototype._resolveRigidBodyCollision=function(){var s=this.colliderA.body,r=this.colliderB.body,n=this.mtv,d=this.normal;if(s!==r){var c=l.getSideFromDirection(this.mtv);if(this.colliderA.emit("precollision",new o.PreCollisionEvent(this.colliderA,this.colliderB,c,this.mtv)),this.colliderB.emit("precollision",new o.PreCollisionEvent(this.colliderB,this.colliderA,l.getOppositeSide(c),this.mtv.negate())),this.colliderA.type!==t.CollisionType.Passive&&this.colliderB.type!==t.CollisionType.Passive){var a=this.colliderA.type===t.CollisionType.Fixed?0:1/this.colliderA.mass,p=this.colliderB.type===t.CollisionType.Fixed?0:1/this.colliderB.mass,h=this.colliderA.type===t.CollisionType.Fixed?0:1/this.colliderA.inertia,y=this.colliderB.type===t.CollisionType.Fixed?0:1/this.colliderB.inertia,v=Math.min(this.colliderA.bounciness,this.colliderB.bounciness),u=Math.min(this.colliderA.friction,this.colliderB.friction),B=(d=d.normalize()).normal().normalize(),f=this.point.sub(this.colliderA.center),m=this.point.sub(this.colliderB.center),C=r.vel.add(m.cross(-r.rx)).sub(s.vel.sub(f.cross(s.rx))),g=C.dot(d),x=C.dot(B),b=f.dot(B),A=f.dot(d),P=m.dot(B),w=m.dot(d);if(!(g>0)){var R=-(1+v)*g/(a+p+h*b*b+y*P*P);if(this.colliderA.type===t.CollisionType.Fixed?(r.vel=r.vel.add(d.scale(R*p)),e.Physics.allowRigidBodyRotation&&(r.rx-=R*y*-m.cross(d)),r.addMtv(n)):this.colliderB.type===t.CollisionType.Fixed?(s.vel=s.vel.sub(d.scale(R*a)),e.Physics.allowRigidBodyRotation&&(s.rx+=R*h*-f.cross(d)),s.addMtv(n.negate())):(r.vel=r.vel.add(d.scale(R*p)),s.vel=s.vel.sub(d.scale(R*a)),e.Physics.allowRigidBodyRotation&&(r.rx-=R*y*-m.cross(d),s.rx+=R*h*-f.cross(d)),r.addMtv(n.scale(.5)),s.addMtv(n.scale(-.5))),u&&x){var T=C.sub(d.scale(C.dot(d))).normalize(),O=C.dot(T)/(a+p+A*A*h+w*w*y),F=new i.Vector(0,0);F=Math.abs(O)<=R*u?T.scale(O).negate():T.scale(-R*u),this.colliderA.type===t.CollisionType.Fixed?(r.vel=r.vel.add(F.scale(p)),e.Physics.allowRigidBodyRotation&&(r.rx+=F.dot(T)*y*m.cross(T))):this.colliderB.type===t.CollisionType.Fixed?(s.vel=s.vel.sub(F.scale(a)),e.Physics.allowRigidBodyRotation&&(s.rx-=F.dot(T)*h*f.cross(T))):(r.vel=r.vel.add(F.scale(p)),s.vel=s.vel.sub(F.scale(a)),e.Physics.allowRigidBodyRotation&&(r.rx+=F.dot(T)*y*m.cross(T),s.rx-=F.dot(T)*h*f.cross(T)))}this.colliderA.emit("postcollision",new o.PostCollisionEvent(this.colliderA,this.colliderB,c,this.mtv)),this.colliderB.emit("postcollision",new o.PostCollisionEvent(this.colliderB,this.colliderA,l.getOppositeSide(c),this.mtv.negate()))}}}},s}();exports.CollisionContact=n;
},{"../Algebra":"NGcQ","../Physics":"uSEN","../Events":"XySq","../Util/Util":"Kkda","./CollisionType":"liCD"}],"fXkm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionJumpTable=void 0;var e=require("./CollisionContact"),n=require("./ConvexPolygon"),l={CollideCircleCircle:function(n,l){var t=n.radius+l.radius,r=n.worldPos,i=l.worldPos;if(r.distance(i)>t)return null;var o=i.sub(r).normalize(),a=o.scale(t-i.distance(r)),s=n.getFurthestPoint(o);return new e.CollisionContact(n.collider,l.collider,a,s,o)},CollideCirclePolygon:function(n,l){var t=n.testSeparatingAxisTheorem(l);if(!t)return null;var r=t.dot(l.center.sub(n.center));t=r<0?t.negate():t;var i=[],o=l.getFurthestPoint(t.negate()),a=n.getFurthestPoint(t);return n.contains(o)&&i.push(o),l.contains(a)&&i.push(a),0===i.length?null:new e.CollisionContact(n.collider,l.collider,t,2===i.length?i[0].average(i[1]):i[0],t.normalize())},CollideCircleEdge:function(n,l){var t=n.center,r=l.end.sub(l.begin),i=r.dot(l.end.sub(t)),o=r.dot(t.sub(l.begin));if(o<=0){var a=l.begin.sub(t),s=a.dot(a);return s>n.radius*n.radius?null:new e.CollisionContact(n.collider,l.collider,a.normalize().scale(n.radius-Math.sqrt(s)),l.begin,a.normalize())}if(i<=0){var d=l.end.sub(t),c=d.dot(d);return c>n.radius*n.radius?null:new e.CollisionContact(n.collider,l.collider,d.normalize().scale(n.radius-Math.sqrt(c)),l.end,d.normalize())}var u=r.dot(r),g=l.begin.scale(i).add(l.end.scale(o)).scale(1/u),C=t.sub(g),b=C.dot(C);if(b>n.radius*n.radius)return null;var v=r.perpendicular();v.dot(t.sub(l.begin))<0&&(v.x=-v.x,v.y=-v.y);var h=(v=v.normalize()).scale(Math.abs(n.radius-Math.sqrt(b)));return new e.CollisionContact(n.collider,l.collider,h.negate(),g,v.negate())},CollideEdgeEdge:function(){return null},CollidePolygonEdge:function(l,t){var r=t.end.sub(t.begin).normal();if(l.contains(t.begin)){var i=l.getClosestFace(t.begin),o=i.distance,a=i.face;if(o)return new e.CollisionContact(l.collider,t.collider,o.negate(),t.begin.add(o.negate()),a.normal().negate())}if(l.contains(t.end)){var s=l.getClosestFace(t.end);o=s.distance,a=s.face;if(o)return new e.CollisionContact(l.collider,t.collider,o.negate(),t.end.add(o.negate()),a.normal().negate())}var d=l.center,c=t.center.sub(d).normalize(),u=new n.ConvexPolygon({collider:t.collider,points:[t.begin,t.end,t.end.add(c.scale(30)),t.begin.add(c.scale(30))]}),g=l.testSeparatingAxisTheorem(u);return g?(r=r.dot(c)<0?r.negate():r,g=g.dot(c)<0?g.negate():g,new e.CollisionContact(l.collider,t.collider,g,l.getFurthestPoint(r),r)):null},CollidePolygonPolygon:function(n,l){var t=n.testSeparatingAxisTheorem(l);if(!t)return null;var r=t.dot(l.center.sub(n.center));t=r<0?t.negate():t;var i=[],o=n.getFurthestPoint(t),a=l.getFurthestPoint(t.negate());l.contains(o)&&i.push(o),n.contains(a)&&i.push(a),0===i.length&&i.push(a);var s=2===i.length?i[0].add(i[1]).scale(.5):i[0];return new e.CollisionContact(n.collider,l.collider,t,s,t.normalize())}};exports.CollisionJumpTable=l;
},{"./CollisionContact":"rA38","./ConvexPolygon":"EI0S"}],"j4ks":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClosestLine=a,exports.ClosestLineJumpTable=void 0;var e=require("../Algebra");function a(a,s,r,o){var t=a.sub(r),d=s.dot(s),n=s.dot(o),i=o.dot(o),l=s.dot(t),y=o.dot(t),g=d*i-n*n,u=g,c=g;if(0===g||g<=.01){var w=l/n;return new e.Line(a,r.add(o.scale(w)))}var x=n*y-i*l,C=d*y-n*l;return x<0?(x=0,C=y,c=i):x>u&&(x=u,C=y+n,c=i),C<0?(C=0,-l<0?x=0:-l>d?x=u:(x=-l,u=d)):C>c&&(C=c,-l+n<0?x=0:-l+n>d?x=u:(x=-l+n,u=d)),x=Math.abs(x)<.001?0:x/u,C=Math.abs(C)<.001?0:C/c,new e.Line(a.add(s.scale(x)),r.add(o.scale(C)))}var s={PolygonPolygonClosestLine:function(s,r){var o=r.worldPos,t=o.sub(s.worldPos),d=t.negate(),n=new e.Ray(s.worldPos,t),i=new e.Ray(o,d),l=s.rayCast(n).add(n.dir.scale(.1)),y=r.rayCast(i).add(i.dir.scale(.1)),g=s.getClosestFace(l),u=r.getClosestFace(y);return a(g.face.begin,g.face.getEdge(),u.face.begin,u.face.getEdge())},PolygonEdgeClosestLine:function(s,r){var o=r.worldPos.sub(s.worldPos),t=new e.Ray(s.worldPos,o),d=s.rayCast(t).add(t.dir.scale(.1)),n=s.getClosestFace(d),i=n.face.begin,l=n.face.getEdge(),y=r.asLine();return a(i,l,y.begin,y.getEdge())},PolygonCircleClosestLine:function(a,s){var r=s.worldPos,o=r.sub(a.worldPos),t=new e.Ray(a.worldPos,o.normalize()),d=a.rayCast(t).add(t.dir.scale(.1)),n=a.getClosestFace(d),i=n.face.begin,l=n.face.getEdge(),y=(l.x*(r.x-i.x)+l.y*(r.y-i.y))/(l.x*l.x+l.y*l.y);y>1?y=1:y<0&&(y=0);var g=Math.sqrt(Math.pow(i.x+l.x*y-r.x,2)+Math.pow(i.y+l.y*y-r.y,2))-s.radius,u=(i.x+l.x*y-r.x)*s.radius/(s.radius+g),c=(i.y+l.y*y-r.y)*s.radius/(s.radius+g);return new e.Line(l.scale(y).add(i),new e.Vector(r.x+u,r.y+c))},CircleCircleClosestLine:function(a,s){var r=s.worldPos.sub(a.worldPos),o=a.worldPos.sub(s.worldPos),t=new e.Ray(a.worldPos,r),d=new e.Ray(s.worldPos,o),n=a.rayCast(t),i=s.rayCast(d);return new e.Line(n,i)},CircleEdgeClosestLine:function(a,s){var r=a.worldPos,o=s.asLine(),t=o.begin,d=o.getEdge(),n=(d.x*(r.x-t.x)+d.y*(r.y-t.y))/(d.x*d.x+d.y*d.y);n>1?n=1:n<0&&(n=0);var i=Math.sqrt(Math.pow(t.x+d.x*n-r.x,2)+Math.pow(t.y+d.y*n-r.y,2))-a.radius,l=(t.x+d.x*n-r.x)*a.radius/(a.radius+i),y=(t.y+d.y*n-r.y)*a.radius/(a.radius+i);return new e.Line(d.scale(n).add(t),new e.Vector(r.x+l,r.y+y))},EdgeEdgeClosestLine:function(e,s){var r=e.asLine(),o=r.begin,t=r.getEdge(),d=s.asLine();return a(o,t,d.begin,d.getEdge())}};exports.ClosestLineJumpTable=s;
},{"../Algebra":"NGcQ"}],"xS4a":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Circle=void 0;var t=require("./BoundingBox"),e=require("./CollisionJumpTable"),o=require("./ConvexPolygon"),r=require("./Edge"),i=require("../Algebra"),n=require("../Physics"),s=require("../Drawing/Color"),l=require("./ClosestLineJumpTable");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=function(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var r,i,n=o.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=n.next()).done;)s.push(r.value)}catch(l){i={error:l}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return s},c=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t},f=function(){function a(t){this.offset=i.Vector.Zero,this.offset=t.offset||i.Vector.Zero,this.radius=t.radius||0,this.collider=t.collider||null}return Object.defineProperty(a.prototype,"worldPos",{get:function(){return this.collider&&this.collider.body?this.collider.body.pos.add(this.offset):this.offset},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return new a({offset:this.offset.clone(),radius:this.radius,collider:null})},Object.defineProperty(a.prototype,"center",{get:function(){return this.collider&&this.collider.body?this.offset.add(this.collider.body.pos):this.offset},enumerable:!0,configurable:!0}),a.prototype.contains=function(t){var e=this.offset;return this.collider&&this.collider.body&&(e=this.collider.body.pos),e.distance(t)<=this.radius},a.prototype.rayCast=function(t,e){void 0===e&&(e=1/0);var o=this.center,r=t.dir,i=t.pos,n=Math.sqrt(Math.pow(r.dot(i.sub(o)),2)-Math.pow(i.sub(o).distance(),2)+Math.pow(this.radius,2));if(n<0)return null;var s=0;if(0===n)return(s=-r.dot(i.sub(o)))>0&&s<e?t.getPoint(s):null;var l=-r.dot(i.sub(o))+n,u=-r.dot(i.sub(o))-n,a=[];l>=0&&a.push(l),u>=0&&a.push(u);var f=Math.min.apply(Math,c(a));return f<=e?t.getPoint(f):null},a.prototype.getClosestLineBetween=function(t){if(t instanceof a)return l.ClosestLineJumpTable.CircleCircleClosestLine(this,t);if(t instanceof o.ConvexPolygon)return l.ClosestLineJumpTable.PolygonCircleClosestLine(t,this).flip();if(t instanceof r.Edge)return l.ClosestLineJumpTable.CircleEdgeClosestLine(this,t).flip();throw new Error("Polygon could not collide with unknown CollisionShape "+u(t))},a.prototype.collide=function(t){if(t instanceof a)return e.CollisionJumpTable.CollideCircleCircle(this,t);if(t instanceof o.ConvexPolygon)return e.CollisionJumpTable.CollideCirclePolygon(this,t);if(t instanceof r.Edge)return e.CollisionJumpTable.CollideCircleEdge(this,t);throw new Error("Circle could not collide with unknown CollisionShape "+u(t))},a.prototype.getFurthestPoint=function(t){return this.center.add(t.normalize().scale(this.radius))},Object.defineProperty(a.prototype,"bounds",{get:function(){var e=i.Vector.Zero;return this.collider&&this.collider.body&&(e=this.collider.body.pos),new t.BoundingBox(this.offset.x+e.x-this.radius,this.offset.y+e.y-this.radius,this.offset.x+e.x+this.radius,this.offset.y+e.y+this.radius)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"localBounds",{get:function(){return new t.BoundingBox(this.offset.x-this.radius,this.offset.y-this.radius,this.offset.x+this.radius,this.offset.y+this.radius)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"axes",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"inertia",{get:function(){return(this.collider?this.collider.mass:n.Physics.defaultMass)*this.radius*this.radius/2},enumerable:!0,configurable:!0}),a.prototype.testSeparatingAxisTheorem=function(t){var e=t.axes,o=t.center,r=t.getFurthestPoint(this.offset.sub(o));e.push(this.offset.sub(r).normalize());for(var i=Number.MAX_VALUE,n=null,s=-1,l=0;l<e.length;l++){var u=t.project(e[l]),a=this.project(e[l]),c=u.getOverlap(a);if(c<=0)return null;c<i&&(i=c,n=e[l],s=l)}return s<0?null:n.normalize().scale(i)},a.prototype.recalc=function(){},a.prototype.project=function(t){var e=[],o=this.center.dot(t);return e.push(o),e.push(o+this.radius),e.push(o-this.radius),new i.Projection(Math.min.apply(Math,e),Math.max.apply(Math,e))},a.prototype.draw=function(t,e,o){void 0===e&&(e=s.Color.Green),void 0===o&&(o=i.Vector.Zero);var r=o.add(this.offset);t.beginPath(),t.fillStyle=e.toString(),t.arc(r.x,r.y,this.radius,0,2*Math.PI),t.closePath(),t.fill()},a.prototype.debugDraw=function(t,e){void 0===e&&(e=s.Color.Green);var o=this.collider.body,r=o?o.pos.add(this.offset):this.offset,i=o?o.rotation:0;t.beginPath(),t.strokeStyle=e.toString(),t.arc(r.x,r.y,this.radius,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(Math.cos(i)*this.radius+r.x,Math.sin(i)*this.radius+r.y),t.closePath(),t.stroke()},a}();exports.Circle=f;
},{"./BoundingBox":"oyna","./CollisionJumpTable":"fXkm","./ConvexPolygon":"EI0S","./Edge":"s26C","../Algebra":"NGcQ","../Physics":"uSEN","../Drawing/Color":"p7Gh","./ClosestLineJumpTable":"j4ks"}],"s26C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Edge=void 0;var e=require("./BoundingBox"),t=require("./CollisionJumpTable"),o=require("./Circle"),n=require("./ConvexPolygon"),r=require("../Algebra"),i=require("../Physics"),s=require("../Drawing/Color"),l=require("./ClosestLineJumpTable");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=function(){function u(e){this.begin=e.begin||r.Vector.Zero,this.end=e.end||r.Vector.Zero,this.collider=e.collider||null,this.offset=this.center}return u.prototype.clone=function(){return new u({begin:this.begin.clone(),end:this.end.clone(),collider:null})},Object.defineProperty(u.prototype,"worldPos",{get:function(){return this.collider&&this.collider.body?this.collider.body.pos.add(this.offset):this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"center",{get:function(){return this.begin.average(this.end).add(this._getBodyPos())},enumerable:!0,configurable:!0}),u.prototype._getBodyPos=function(){var e=r.Vector.Zero;return this.collider&&this.collider.body&&(e=this.collider.body.pos),e},u.prototype._getTransformedBegin=function(){var e=this.collider?this.collider.body:null,t=e?e.rotation:0;return this.begin.rotate(t).add(this._getBodyPos())},u.prototype._getTransformedEnd=function(){var e=this.collider?this.collider.body:null,t=e?e.rotation:0;return this.end.rotate(t).add(this._getBodyPos())},u.prototype.getSlope=function(){var e=this._getTransformedBegin(),t=this._getTransformedEnd(),o=e.distance(t);return t.sub(e).scale(1/o)},u.prototype.getLength=function(){var e=this._getTransformedBegin(),t=this._getTransformedEnd();return e.distance(t)},u.prototype.contains=function(){return!1},u.prototype.rayCast=function(e,t){void 0===t&&(t=1/0);var o=this._getTransformedBegin().sub(e.pos);if(0===e.dir.cross(this.getSlope())&&0!==o.cross(e.dir))return null;var n=e.dir.cross(this.getSlope());if(0===n)return null;var r=o.cross(this.getSlope())/n;if(r>=0&&r<=t){var i=o.cross(e.dir)/n/this.getLength();if(i>=0&&i<=1)return e.getPoint(r)}return null},u.prototype.getClosestLineBetween=function(e){if(e instanceof o.Circle)return l.ClosestLineJumpTable.CircleEdgeClosestLine(e,this);if(e instanceof n.ConvexPolygon)return l.ClosestLineJumpTable.PolygonEdgeClosestLine(e,this).flip();if(e instanceof u)return l.ClosestLineJumpTable.EdgeEdgeClosestLine(this,e);throw new Error("Polygon could not collide with unknown CollisionShape "+d(e))},u.prototype.collide=function(e){if(e instanceof o.Circle)return t.CollisionJumpTable.CollideCircleEdge(e,this);if(e instanceof n.ConvexPolygon)return t.CollisionJumpTable.CollidePolygonEdge(e,this);if(e instanceof u)return t.CollisionJumpTable.CollideEdgeEdge();throw new Error("Edge could not collide with unknown CollisionShape "+d(e))},u.prototype.getFurthestPoint=function(e){var t=this._getTransformedBegin(),o=this._getTransformedEnd();return e.dot(t)>0?t:o},u.prototype._boundsFromBeginEnd=function(t,o){return new e.BoundingBox(Math.min(t.x,o.x),Math.min(t.y,o.y),Math.max(t.x,o.x),Math.max(t.y,o.y))},Object.defineProperty(u.prototype,"bounds",{get:function(){var e=this._getTransformedBegin(),t=this._getTransformedEnd();return this._boundsFromBeginEnd(e,t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"localBounds",{get:function(){return this._boundsFromBeginEnd(this.begin,this.end)},enumerable:!0,configurable:!0}),u.prototype.asLine=function(){return new r.Line(this._getTransformedBegin(),this._getTransformedEnd())},u.prototype.asLocalLine=function(){return new r.Line(this.begin,this.end)},Object.defineProperty(u.prototype,"axes",{get:function(){var e=this._getTransformedEnd().sub(this._getTransformedBegin()).normal(),t=[];return t.push(e),t.push(e.negate()),t.push(e.normal()),t.push(e.normal().negate()),t},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"inertia",{get:function(){var e=this.collider?this.collider.mass:i.Physics.defaultMass,t=this.end.sub(this.begin).distance()/2;return e*t*t},enumerable:!0,configurable:!0}),u.prototype.recalc=function(){},u.prototype.project=function(e){for(var t=[],o=[this._getTransformedBegin(),this._getTransformedEnd()],n=o.length,i=0;i<n;i++)t.push(o[i].dot(e));return new r.Projection(Math.min.apply(Math,t),Math.max.apply(Math,t))},u.prototype.draw=function(e,t,o){void 0===t&&(t=s.Color.Green),void 0===o&&(o=r.Vector.Zero);var n=this.begin.add(o),i=this.end.add(o);e.strokeStyle=t.toString(),e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(i.x,i.y),e.closePath(),e.stroke()},u.prototype.debugDraw=function(e,t){void 0===t&&(t=s.Color.Red);var o=this._getTransformedBegin(),n=this._getTransformedEnd();e.strokeStyle=t.toString(),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(n.x,n.y),e.closePath(),e.stroke()},u}();exports.Edge=u;
},{"./BoundingBox":"oyna","./CollisionJumpTable":"fXkm","./Circle":"xS4a","./ConvexPolygon":"EI0S","../Algebra":"NGcQ","../Physics":"uSEN","../Drawing/Color":"p7Gh","./ClosestLineJumpTable":"j4ks"}],"EI0S":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConvexPolygon=void 0;var t=require("../Drawing/Color"),e=require("../Physics"),o=require("./BoundingBox"),i=require("./Edge"),n=require("./CollisionJumpTable"),r=require("./Circle"),s=require("../Algebra"),l=require("./ClosestLineJumpTable");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=function(){function c(t){this._transformedPoints=[],this._axes=[],this._sides=[],this.offset=t.offset||s.Vector.Zero;var e=!!t.clockwiseWinding;this.points=(e?t.points.reverse():t.points)||[],this.collider=this.collider=t.collider||null,this._calculateTransformation()}return c.prototype.clone=function(){return new c({offset:this.offset.clone(),points:this.points.map(function(t){return t.clone()}),collider:null})},Object.defineProperty(c.prototype,"worldPos",{get:function(){return this.collider&&this.collider.body?this.collider.body.pos.add(this.offset):this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"center",{get:function(){var t=this.collider?this.collider.body:null;return t?t.pos.add(this.offset):this.offset},enumerable:!0,configurable:!0}),c.prototype._calculateTransformation=function(){var t=this.collider?this.collider.body:null,e=t?t.pos.add(this.offset):this.offset,o=t?t.rotation:0,i=t?t.scale:s.Vector.One,n=this.points.length;this._transformedPoints.length=0;for(var r=0;r<n;r++)this._transformedPoints[r]=this.points[r].scale(i).rotate(o).add(e)},c.prototype.getTransformedPoints=function(){return this._transformedPoints.length&&(!this.collider||!this.collider.body||this.collider.body.oldPos.equals(this.collider.body.pos)&&this.collider.body.oldRotation===this.collider.body.rotation&&this.collider.body.oldScale===this.collider.body.scale)||this._calculateTransformation(),this._transformedPoints},c.prototype.getSides=function(){if(this._sides.length)return this._sides;for(var t=[],e=this.getTransformedPoints(),o=e.length,i=0;i<o;i++)t.push(new s.Line(e[i],e[(i-1+o)%o]));return this._sides=t,this._sides},c.prototype.recalc=function(){this._sides.length=0,this._axes.length=0,this._transformedPoints.length=0,this.getTransformedPoints(),this.getSides()},c.prototype.contains=function(t){var e=new s.Ray(t,new s.Vector(1,0));return this.getSides().reduce(function(t,o){return e.intersect(o)>=0?t+1:t},0)%2!=0},c.prototype.getClosestLineBetween=function(t){if(t instanceof r.Circle)return l.ClosestLineJumpTable.PolygonCircleClosestLine(this,t);if(t instanceof c)return l.ClosestLineJumpTable.PolygonPolygonClosestLine(this,t);if(t instanceof i.Edge)return l.ClosestLineJumpTable.PolygonEdgeClosestLine(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+a(t))},c.prototype.collide=function(t){if(t instanceof r.Circle)return n.CollisionJumpTable.CollideCirclePolygon(t,this);if(t instanceof c)return n.CollisionJumpTable.CollidePolygonPolygon(this,t);if(t instanceof i.Edge)return n.CollisionJumpTable.CollidePolygonEdge(this,t);throw new Error("Polygon could not collide with unknown CollisionShape "+a(t))},c.prototype.getFurthestPoint=function(t){for(var e=this.getTransformedPoints(),o=null,i=-Number.MAX_VALUE,n=0;n<e.length;n++){var r=t.dot(e[n]);r>i&&(i=r,o=e[n])}return o},c.prototype.getClosestFace=function(t){for(var e=this.getSides(),o=Number.POSITIVE_INFINITY,i=-1,n=-1,r=0;r<e.length;r++){var s=e[r].distanceToPoint(t);s<o&&(o=s,i=r,n=s)}return-1!==i?{distance:e[i].normal().scale(n),face:e[i]}:null},Object.defineProperty(c.prototype,"bounds",{get:function(){var t=this.getTransformedPoints();return o.BoundingBox.fromPoints(t)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"localBounds",{get:function(){return o.BoundingBox.fromPoints(this.points)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"inertia",{get:function(){for(var t=this.collider?this.collider.mass:e.Physics.defaultMass,o=0,i=0,n=0;n<this.points.length;n++){var r=(n+1)%this.points.length,s=this.points[r].cross(this.points[n]);o+=s*(this.points[n].dot(this.points[n])+this.points[n].dot(this.points[r])+this.points[r].dot(this.points[r])),i+=s}return t/6*(o/i)},enumerable:!0,configurable:!0}),c.prototype.rayCast=function(t,e){void 0===e&&(e=1/0);for(var o=this.getSides(),i=o.length,n=Number.MAX_VALUE,r=-1,s=0;s<i;s++){var l=t.intersect(o[s]);l>=0&&l<n&&l<=e&&(n=l,r=s)}return r>=0?t.getPoint(n):null},Object.defineProperty(c.prototype,"axes",{get:function(){if(this._axes.length)return this._axes;for(var t=[],e=this.getTransformedPoints(),o=e.length,i=0;i<o;i++)t.push(e[i].sub(e[(i+1)%o]).normal());return this._axes=t,this._axes},enumerable:!0,configurable:!0}),c.prototype.testSeparatingAxisTheorem=function(t){for(var e=t,o=this.axes.concat(e.axes),i=Number.MAX_VALUE,n=null,r=-1,s=0;s<o.length;s++){var l=this.project(o[s]),a=e.project(o[s]),c=l.getOverlap(a);if(c<=0)return null;c<i&&(i=c,n=o[s],r=s)}return-1===r?null:n.normalize().scale(i)},c.prototype.project=function(t){for(var e=this.getTransformedPoints(),o=e.length,i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=0;r<o;r++){var l=e[r].dot(t);i=Math.min(i,l),n=Math.max(n,l)}return new s.Projection(i,n)},c.prototype.draw=function(e,o,i){void 0===o&&(o=t.Color.Green),void 0===i&&(i=s.Vector.Zero),e.beginPath(),e.fillStyle=o.toString();var n=i.add(this.offset),r=this.points[0].add(n);e.moveTo(r.x,r.y),this.points.map(function(t){return t.add(n)}).forEach(function(t){e.lineTo(t.x,t.y)}),e.lineTo(r.x,r.y),e.closePath(),e.fill()},c.prototype.debugDraw=function(e,o){void 0===o&&(o=t.Color.Red),e.beginPath(),e.strokeStyle=o.toString();var i=this.getTransformedPoints()[0];e.moveTo(i.x,i.y),this.getTransformedPoints().forEach(function(t){e.lineTo(t.x,t.y)}),e.lineTo(i.x,i.y),e.closePath(),e.stroke()},c}();exports.ConvexPolygon=c;
},{"../Drawing/Color":"p7Gh","../Physics":"uSEN","./BoundingBox":"oyna","./Edge":"s26C","./CollisionJumpTable":"fXkm","./Circle":"xS4a","../Algebra":"NGcQ","./ClosestLineJumpTable":"j4ks"}],"Mmyc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Shape=void 0;var e=require("./ConvexPolygon"),o=require("./Circle"),n=require("./Edge"),r=require("./BoundingBox"),i=require("../Algebra"),t=function(){function t(){}return t.Box=function(o,n,t,u){return void 0===t&&(t=i.Vector.Half),void 0===u&&(u=i.Vector.Zero),new e.ConvexPolygon({points:new r.BoundingBox(-o*t.x,-n*t.y,o-o*t.x,n-n*t.y).getPoints(),offset:u})},t.Polygon=function(o,n,r){return void 0===n&&(n=!1),void 0===r&&(r=i.Vector.Zero),new e.ConvexPolygon({points:o,offset:r,clockwiseWinding:n})},t.Circle=function(e,n){return void 0===n&&(n=i.Vector.Zero),new o.Circle({radius:e,offset:n})},t.Edge=function(e,o){return new n.Edge({begin:e,end:o})},t}();exports.Shape=t;
},{"./ConvexPolygon":"EI0S","./Circle":"xS4a","./Edge":"s26C","./BoundingBox":"oyna","../Algebra":"NGcQ"}],"oGoG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Body=void 0;var t=require("../Algebra"),o=require("./CollisionType"),e=require("../Physics"),i=require("../Events"),r=require("./Shape"),l=function(){function l(o){var e=o.actor,i=o.collider;if(this.pos=new t.Vector(0,0),this.oldPos=new t.Vector(0,0),this.vel=new t.Vector(0,0),this.oldVel=new t.Vector(0,0),this.acc=new t.Vector(0,0),this.oldAcc=t.Vector.Zero,this.torque=0,this.motion=10,this.oldRotation=0,this.rotation=0,this.scale=t.Vector.One,this.oldScale=t.Vector.One,this.sx=0,this.sy=0,this.rx=0,this._geometryDirty=!1,this._totalMtv=t.Vector.Zero,!e&&!i)throw new Error("An actor or collider are required to create a body");this.actor=e,this.collider=!i&&e?this.useBoxCollider(e.width,e.height,e.anchor):i}return Object.defineProperty(l.prototype,"id",{get:function(){return this.actor?this.actor.id:-1},enumerable:!0,configurable:!0}),l.prototype.clone=function(){return new l({actor:null,collider:this.collider.clone()})},Object.defineProperty(l.prototype,"active",{get:function(){return!!this.actor&&!this.actor.isKilled()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"center",{get:function(){return this.pos},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"collider",{get:function(){return this._collider},set:function(t){t&&(this._collider=t,this._collider.body=this,this._wireColliderEventsToActor())},enumerable:!0,configurable:!0}),l.prototype.addMtv=function(t){this._totalMtv.addEqual(t)},l.prototype.applyMtv=function(){this.pos.addEqual(this._totalMtv),this._totalMtv.setTo(0,0)},l.prototype.markCollisionShapeDirty=function(){this._geometryDirty=!0},Object.defineProperty(l.prototype,"isColliderShapeDirty",{get:function(){return this._geometryDirty},enumerable:!0,configurable:!0}),l.prototype.captureOldTransform=function(){this.oldVel.setTo(this.vel.x,this.vel.y),this.oldPos.setTo(this.pos.x,this.pos.y),this.oldAcc.setTo(this.acc.x,this.acc.y),this.oldScale.setTo(this.scale.x,this.scale.y),this.oldRotation=this.rotation},l.prototype.integrate=function(t){var i=t/1e3,r=this.acc.clone();this.collider.type===o.CollisionType.Active&&r.addEqual(e.Physics.acc),this.vel.addEqual(r.scale(i)),this.pos.addEqual(this.vel.scale(i)).addEqual(r.scale(.5*i*i)),this.rx+=this.torque*(1/this.collider.inertia)*i,this.rotation+=this.rx*i,this.scale.x+=this.sx*t/1e3,this.scale.y+=this.sy*t/1e3,this.scale.equals(this.oldScale)||(this._geometryDirty=!0),this.collider.update(),this._geometryDirty=!1},l.prototype.useBoxCollider=function(o,e,i,l){return void 0===i&&(i=t.Vector.Half),void 0===l&&(l=t.Vector.Zero),null==o&&(o=this.actor?this.actor.width:0),null==e&&(e=this.actor?this.actor.height:0),this.collider.shape=r.Shape.Box(o,e,i,l),this.collider},l.prototype.usePolygonCollider=function(o,e){return void 0===e&&(e=t.Vector.Zero),this.collider.shape=r.Shape.Polygon(o,!1,e),this.collider},l.prototype.useCircleCollider=function(o,e){return void 0===e&&(e=t.Vector.Zero),this.collider.shape=r.Shape.Circle(o,e),this.collider},l.prototype.useEdgeCollider=function(t,o){return this.collider.shape=r.Shape.Edge(t,o),this.collider},l.prototype._wireColliderEventsToActor=function(){var t=this;this.collider.clear(),this.collider.on("precollision",function(o){t.actor&&t.actor.emit("precollision",new i.PreCollisionEvent(o.target.body.actor,o.other.body.actor,o.side,o.intersection))}),this.collider.on("postcollision",function(o){t.actor&&t.actor.emit("postcollision",new i.PostCollisionEvent(o.target.body.actor,o.other.body.actor,o.side,o.intersection))}),this.collider.on("collisionstart",function(o){t.actor&&t.actor.emit("collisionstart",new i.CollisionStartEvent(o.target.body.actor,o.other.body.actor,o.pair))}),this.collider.on("collisionend",function(o){t.actor&&t.actor.emit("collisionend",new i.CollisionEndEvent(o.target.body.actor,o.other.body.actor))})},l}();exports.Body=l;
},{"../Algebra":"NGcQ","./CollisionType":"liCD","../Physics":"uSEN","../Events":"XySq","./Shape":"Mmyc"}],"G2LY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CapturePointer=void 0;var e=function(){function e(){}return e.prototype.update=function(e,t){e.enableCapturePointer&&(e.isKilled()||t.input.pointers.checkAndUpdateActorUnderPointer(e))},e}();exports.CapturePointer=e;
},{}],"nIlm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CullingBox=void 0;var t=require("../Algebra"),i=require("../Drawing/Color"),o=function(){function o(){this._topLeft=new t.Vector(0,0),this._topRight=new t.Vector(0,0),this._bottomLeft=new t.Vector(0,0),this._bottomRight=new t.Vector(0,0)}return o.prototype.isSpriteOffScreen=function(i,o){var e=i.currentDrawing.drawWidth,r=i.currentDrawing.drawHeight,h=i.rotation,s=i.center,n=i.getWorldPos();this._topLeft.x=n.x-e/2,this._topLeft.y=n.y-r/2,this._topLeft=this._topLeft.rotate(h,s),this._topRight.x=n.x+e/2,this._topRight.y=n.y-r/2,this._topRight=this._topRight.rotate(h,s),this._bottomLeft.x=n.x-e/2,this._bottomLeft.y=n.y+r/2,this._bottomLeft=this._bottomLeft.rotate(h,s),this._bottomRight.x=n.x+e/2,this._bottomRight.y=n.y+r/2,this._bottomRight=this._bottomRight.rotate(h,s);var a=o.worldToScreenCoordinates(this._topLeft),l=o.worldToScreenCoordinates(this._topRight),_=o.worldToScreenCoordinates(this._bottomLeft),x=o.worldToScreenCoordinates(this._bottomRight);this._xCoords=[],this._yCoords=[],this._xCoords.push(a.x,l.x,_.x,x.x),this._yCoords.push(a.y,l.y,_.y,x.y),this._xMin=Math.min.apply(null,this._xCoords),this._yMin=Math.min.apply(null,this._yCoords),this._xMax=Math.max.apply(null,this._xCoords),this._yMax=Math.max.apply(null,this._yCoords);var y=o.screenToWorldCoordinates(new t.Vector(this._xMin,this._yMin)),c=o.screenToWorldCoordinates(new t.Vector(this._xMax,this._yMax));this._xMinWorld=y.x,this._yMinWorld=y.y,this._xMaxWorld=c.x,this._yMaxWorld=c.y;var d=[new t.Vector(this._xMin,this._yMin),new t.Vector(this._xMax,this._yMin),new t.Vector(this._xMin,this._yMax),new t.Vector(this._xMax,this._yMax)];if(d[0].x<0&&d[1].x>o.canvas.clientWidth&&(d[0].y>0||d[2].y<o.canvas.clientHeight))return!1;if(d[0].y<0&&d[2].y>o.canvas.clientHeight&&(d[1].x>0||d[0].x<o.canvas.clientWidth))return!1;for(var g=0;g<d.length;g++)if(d[g].x>0&&d[g].y>0&&d[g].x<o.canvas.clientWidth&&d[g].y<o.canvas.clientHeight)return!1;return!0},o.prototype.debugDraw=function(t){t.beginPath(),t.strokeStyle=i.Color.White.toString(),t.rect(this._xMinWorld,this._yMinWorld,this._xMaxWorld-this._xMinWorld,this._yMaxWorld-this._yMinWorld),t.stroke(),t.fillStyle=i.Color.Red.toString(),t.beginPath(),t.arc(this._topLeft.x,this._topLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=i.Color.Green.toString(),t.beginPath(),t.arc(this._topRight.x,this._topRight.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=i.Color.Blue.toString(),t.beginPath(),t.arc(this._bottomLeft.x,this._bottomLeft.y,5,0,2*Math.PI),t.closePath(),t.fill(),t.fillStyle=i.Color.Magenta.toString(),t.beginPath(),t.arc(this._bottomRight.x,this._bottomRight.y,5,0,2*Math.PI),t.closePath(),t.fill()},o}();exports.CullingBox=o;
},{"../Algebra":"NGcQ","../Drawing/Color":"p7Gh"}],"mlEX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OffscreenCulling=void 0;var e=require("./../Util/CullingBox"),r=require("../Events"),n=function(){function n(){this.cullingBox=new e.CullingBox}return n.prototype.update=function(e,n){var t=e.eventDispatcher,i=!0;null!=e.currentDrawing&&(i=this.cullingBox.isSpriteOffScreen(e,n));var c=!1;n&&n.currentScene&&n.currentScene.camera&&n.currentScene.camera.viewport&&(c=!n.currentScene.camera.viewport.intersect(e.body.collider.bounds)),e.isOffScreen?c&&i||(t.emit("enterviewport",new r.EnterViewPortEvent(e)),e.isOffScreen=!1):c&&i&&(t.emit("exitviewport",new r.ExitViewPortEvent(e)),e.isOffScreen=!0)},n}();exports.OffscreenCulling=n;
},{"./../Util/CullingBox":"nIlm","../Events":"XySq"}],"UgQh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.line=o,exports.point=e,exports.vector=r,exports.roundRect=i,exports.circle=l;var t=require("../Drawing/Color");function o(o,e,r,i,l,n,a,s){void 0===e&&(e=t.Color.Red),void 0===a&&(a=1),void 0===s&&(s="butt"),o.save(),o.beginPath(),o.lineWidth=a,o.lineCap=s,o.strokeStyle=e.toString(),o.moveTo(r,i),o.lineTo(l,n),o.closePath(),o.stroke(),o.restore()}function e(o,e,r){void 0===e&&(e=t.Color.Red),o.beginPath(),o.strokeStyle=e.toString(),o.arc(r.x,r.y,5,0,2*Math.PI),o.closePath(),o.stroke()}function r(t,o,e,r,i){void 0===i&&(i=1);var l=o?o.toString():"blue",n=r.scale(i);t.beginPath(),t.strokeStyle=l,t.moveTo(e.x,e.y),t.lineTo(e.x+n.x,e.y+n.y),t.closePath(),t.stroke()}function i(o,e,r,i,l,n,a,s){var v;if(void 0===n&&(n=5),void 0===a&&(a=t.Color.White),void 0===s&&(s=null),"number"==typeof n)v={tl:n,tr:n,br:n,bl:n};else{var c={tl:0,tr:0,br:0,bl:0};for(var u in c)if(c.hasOwnProperty(u)){var d=u;v[d]=n[d]||c[d]}}o.beginPath(),o.moveTo(e+v.tl,r),o.lineTo(e+i-v.tr,r),o.quadraticCurveTo(e+i,r,e+i,r+v.tr),o.lineTo(e+i,r+l-v.br),o.quadraticCurveTo(e+i,r+l,e+i-v.br,r+l),o.lineTo(e+v.bl,r+l),o.quadraticCurveTo(e,r+l,e,r+l-v.bl),o.lineTo(e,r+v.tl),o.quadraticCurveTo(e,r,e+v.tl,r),o.closePath(),s&&(o.fillStyle=s.toString(),o.fill()),a&&(o.strokeStyle=a.toString(),o.stroke())}function l(o,e,r,i,l,n){void 0===l&&(l=t.Color.White),void 0===n&&(n=null),o.beginPath(),o.arc(e,r,i,0,2*Math.PI),o.closePath(),n&&(o.fillStyle=n.toString(),o.fill()),l&&(o.strokeStyle=l.toString(),o.stroke())}
},{"../Drawing/Color":"p7Gh"}],"NyBG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionGroup=void 0;var e=function(){function e(e,t,r){this._name=e,this._category=t,this._mask=r}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"category",{get:function(){return this._category},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},enumerable:!0,configurable:!0}),e.prototype.canCollide=function(e){return 0!=(this.category&e.mask)&&0!=(e.category&this.mask)},e.All=new e("Collide with all groups",-1,-1),e}();exports.CollisionGroup=e;
},{}],"zTU8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pair=void 0;var i=require("./../Physics"),e=require("./../Drawing/Color"),o=l(require("../Util/DrawUtil")),t=require("./CollisionType");function r(){if("function"!=typeof WeakMap)return null;var i=new WeakMap;return r=function(){return i},i}function l(i){if(i&&i.__esModule)return i;if(null===i||"object"!=typeof i&&"function"!=typeof i)return{default:i};var e=r();if(e&&e.has(i))return e.get(i);var o={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in i)if(Object.prototype.hasOwnProperty.call(i,l)){var n=t?Object.getOwnPropertyDescriptor(i,l):null;n&&(n.get||n.set)?Object.defineProperty(o,l,n):o[l]=i[l]}return o.default=i,e&&e.set(i,o),o}var n=function(){function r(i,e){this.colliderA=i,this.colliderB=e,this.id=null,this.collision=null,this.id=r.calculatePairHash(i,e)}return r.canCollide=function(i,e){return!!i.group.canCollide(e.group)&&((i.type!==t.CollisionType.Fixed||e.type!==t.CollisionType.Fixed)&&(e.type!==t.CollisionType.PreventCollision&&i.type!==t.CollisionType.PreventCollision&&!(!i.active||!e.active)))},Object.defineProperty(r.prototype,"canCollide",{get:function(){var i=this.colliderA,e=this.colliderB;return r.canCollide(i,e)},enumerable:!0,configurable:!0}),r.prototype.collide=function(){this.collision=this.colliderA.collide(this.colliderB)},r.prototype.resolve=function(i){this.collision&&this.collision.resolve(i)},r.calculatePairHash=function(i,e){return i.id<e.id?"#"+i.id+"+"+e.id:"#"+e.id+"+"+i.id},r.prototype.debugDraw=function(t){this.collision&&(i.Physics.showContacts&&o.point(t,e.Color.Red,this.collision.point),i.Physics.showCollisionNormals&&o.vector(t,e.Color.Cyan,this.collision.point,this.collision.normal,30))},r}();exports.Pair=n;
},{"./../Physics":"uSEN","./../Drawing/Color":"p7Gh","../Util/DrawUtil":"UgQh","./CollisionType":"liCD"}],"KRUI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isCollider=c,exports.Collider=void 0;var e=require("../Drawing/Color"),t=a(require("../Util/DrawUtil")),o=require("../Algebra"),i=require("../Physics"),r=require("./BoundingBox"),n=require("./CollisionType"),s=require("./CollisionGroup"),p=require("../EventDispatcher"),u=require("./Pair");function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=i?Object.getOwnPropertyDescriptor(e,r):null;n&&(n.get||n.set)?Object.defineProperty(o,r,n):o[r]=e[r]}return o.default=e,t&&t.set(e,o),o}function c(e){return e instanceof l}var l=function(){function h(e){var t=e.body,i=e.type,r=e.group,u=e.shape,h=e.offset,a=e.useShapeInertia,c=void 0===a||a;this._events=new p.EventDispatcher(this),this.type=n.CollisionType.PreventCollision,this.group=s.CollisionGroup.All,this.mass=1,this.inertia=1e3,this.friction=.99,this.bounciness=.2,t&&t.collider&&!u?this._shape=t.collider.shape:(this._shape=u,this.body=t),this.useShapeInertia=c,this._shape.collider=this,this.type=i||this.type,this.group=r||this.group,this.offset=h||o.Vector.Zero}return h.prototype.clone=function(){return new h({body:null,type:this.type,shape:this._shape.clone(),group:this.group,offset:this.offset})},Object.defineProperty(h.prototype,"id",{get:function(){return this.body?this.body.id:-1},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"shape",{get:function(){return this._shape},set:function(e){this._shape=e,this._shape.collider=this,this.useShapeInertia&&(this.inertia=isNaN(this._shape.inertia)?this.inertia:this._shape.inertia)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"center",{get:function(){return this.bounds.center},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"active",{get:function(){return this.body.active},enumerable:!0,configurable:!0}),h.prototype.collide=function(e){return this.shape.collide(e.shape)},h.prototype.getClosestLineBetween=function(e){return this.shape.getClosestLineBetween(e.shape)},Object.defineProperty(h.prototype,"offset",{get:function(){return this.shape.offset.clone()},set:function(e){this.shape.offset=e.clone()},enumerable:!0,configurable:!0}),h.prototype.touching=function(e){var t=new u.Pair(this,e);return t.collide(),!!t.collision},Object.defineProperty(h.prototype,"bounds",{get:function(){return this.shape?this.shape.bounds:this.body?(new r.BoundingBox).translate(this.body.pos):new r.BoundingBox},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"localBounds",{get:function(){return this.shape?this.shape.localBounds:new r.BoundingBox},enumerable:!0,configurable:!0}),h.prototype.update=function(){this.shape&&this.shape.recalc()},h.prototype.emit=function(e,t){this._events.emit(e,t)},h.prototype.on=function(e,t){this._events.on(e,t)},h.prototype.off=function(e,t){this._events.off(e,t)},h.prototype.once=function(e,t){this._events.once(e,t)},h.prototype.clear=function(){this._events.clear()},h.prototype.debugDraw=function(o){i.Physics.showMotionVectors&&(t.vector(o,e.Color.Yellow,this.body.pos,this.body.acc.add(i.Physics.acc)),t.vector(o,e.Color.Red,this.body.pos,this.body.vel),t.point(o,e.Color.Red,this.body.pos)),i.Physics.showBounds&&this.bounds.debugDraw(o,e.Color.Yellow),i.Physics.showArea&&this.shape.debugDraw(o,e.Color.Green)},h}();exports.Collider=l;
},{"../Drawing/Color":"p7Gh","../Util/DrawUtil":"UgQh","../Algebra":"NGcQ","../Physics":"uSEN","./BoundingBox":"oyna","./CollisionType":"liCD","./CollisionGroup":"NyBG","../EventDispatcher":"c7EN","./Pair":"zTU8"}],"Tnas":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionGroupManager=void 0;var r=require("./CollisionGroup"),t=function(){function t(){}return t.create=function(t,e){if(this._currentGroup>this._MAX_GROUPS)throw new Error("Cannot have more than "+this._MAX_GROUPS+" collision groups");if(this._groups.get(t))throw new Error("Collision group "+t+" already exists");var o=new r.CollisionGroup(t,this._currentBit,void 0!==e?e:~this._currentBit);return this._currentBit=this._currentBit<<1|0,this._currentGroup++,this._groups.set(t,o),o},Object.defineProperty(t,"groups",{get:function(){return Array.from(this._groups.values())},enumerable:!0,configurable:!0}),t.groupByName=function(r){return this._groups.get(r)},t.reset=function(){this._groups=new Map,this._currentBit=this._STARTING_BIT,this._currentGroup=1},t._STARTING_BIT=1,t._MAX_GROUPS=32,t._currentGroup=1,t._currentBit=t._STARTING_BIT,t._groups=new Map,t}();exports.CollisionGroupManager=t;
},{"./CollisionGroup":"NyBG"}],"BGmr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DynamicTree=exports.TreeNode=void 0;var t=require("./../Physics"),e=require("./BoundingBox"),r=require("../Util/Log"),i=function(){function t(t){this.parent=t,this.parent=t||null,this.body=null,this.bounds=new e.BoundingBox,this.left=null,this.right=null,this.height=0}return t.prototype.isLeaf=function(){return!this.left&&!this.right},t}();exports.TreeNode=i;var n=function(){function n(t){void 0===t&&(t=new e.BoundingBox(-Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)),this.worldBounds=t,this.root=null,this.nodes={}}return n.prototype._insert=function(t){if(null===this.root)return this.root=t,void(this.root.parent=null);for(var e=t.bounds,r=this.root;!r.isLeaf();){var n=r.left,o=r.right,h=r.bounds.getPerimeter(),s=r.bounds.combine(e).getPerimeter(),u=2*s,a=2*(s-h),d=0,l=e.combine(n.bounds),g=void 0;n.isLeaf()?d=l.getPerimeter()+a:(g=n.bounds.getPerimeter(),d=l.getPerimeter()-g+a);var f=0,b=e.combine(o.bounds);if(o.isLeaf()?f=b.getPerimeter()+a:(g=o.bounds.getPerimeter(),f=b.getPerimeter()-g+a),u<d&&u<f)break;r=d<f?n:o}var c=r.parent,p=new i(c);p.bounds=e.combine(r.bounds),p.height=r.height+1,null!==c?(c.left===r?c.left=p:c.right=p,p.left=r,p.right=t,r.parent=p,t.parent=p):(p.left=r,p.right=t,r.parent=p,t.parent=p,this.root=p);for(var m=t.parent;m;){if(!(m=this._balance(m)).left)throw new Error("Parent of current leaf cannot have a null left child"+m);if(!m.right)throw new Error("Parent of current leaf cannot have a null right child"+m);m.height=1+Math.max(m.left.height,m.right.height),m.bounds=m.left.bounds.combine(m.right.bounds),m=m.parent}},n.prototype._remove=function(t){if(t!==this.root){var e,r=t.parent,i=r.parent;if(e=r.left===t?r.right:r.left,i){i.left===r?i.left=e:i.right=e,e.parent=i;for(var n=i;n;)(n=this._balance(n)).bounds=n.left.bounds.combine(n.right.bounds),n.height=1+Math.max(n.left.height,n.right.height),n=n.parent}else this.root=e,e.parent=null}else this.root=null},n.prototype.trackBody=function(t){var e=new i;e.body=t,e.bounds=t.collider.bounds,e.bounds.left-=2,e.bounds.top-=2,e.bounds.right+=2,e.bounds.bottom+=2,this.nodes[t.id]=e,this._insert(e)},n.prototype.updateBody=function(e){var i=this.nodes[e.id];if(!i)return!1;var n=e.collider.bounds;if(!this.worldBounds.contains(n))return r.Logger.getInstance().warn("Collider with id "+e.id+" is outside the world bounds and will no longer be tracked for physics"),this.untrackBody(e),!1;if(i.bounds.contains(n))return!1;this._remove(i),n.left-=t.Physics.boundsPadding,n.top-=t.Physics.boundsPadding,n.right+=t.Physics.boundsPadding,n.bottom+=t.Physics.boundsPadding;var o=e.vel.x*t.Physics.dynamicTreeVelocityMultiplier,h=e.vel.y*t.Physics.dynamicTreeVelocityMultiplier;return o<0?n.left+=o:n.right+=o,h<0?n.top+=h:n.bottom+=h,i.bounds=n,this._insert(i),!0},n.prototype.untrackBody=function(t){var e=this.nodes[t.collider.id];e&&(this._remove(e),this.nodes[t.collider.id]=null,delete this.nodes[t.collider.id])},n.prototype._balance=function(t){if(null===t)throw new Error("Cannot balance at null node");if(t.isLeaf()||t.height<2)return t;var e=t.left,r=t.right,i=t,n=e,o=r,h=e.left,s=e.right,u=r.left,a=r.right,d=o.height-n.height;if(d>1)return o.left=i,o.parent=i.parent,i.parent=o,o.parent?o.parent.left===i?o.parent.left=o:o.parent.right=o:this.root=o,u.height>a.height?(o.right=u,i.right=a,a.parent=i,i.bounds=n.bounds.combine(a.bounds),o.bounds=i.bounds.combine(u.bounds),i.height=1+Math.max(n.height,a.height),o.height=1+Math.max(i.height,u.height)):(o.right=a,i.right=u,u.parent=i,i.bounds=n.bounds.combine(u.bounds),o.bounds=i.bounds.combine(a.bounds),i.height=1+Math.max(n.height,u.height),o.height=1+Math.max(i.height,a.height)),o;if(d<-1){if(n.left=i,n.parent=i.parent,i.parent=n,n.parent)if(n.parent.left===i)n.parent.left=n;else{if(n.parent.right!==i)throw"Error rotating Dynamic Tree";n.parent.right=n}else this.root=n;return h.height>s.height?(n.right=h,i.left=s,s.parent=i,i.bounds=o.bounds.combine(s.bounds),n.bounds=i.bounds.combine(h.bounds),i.height=1+Math.max(o.height,s.height),n.height=1+Math.max(i.height,h.height)):(n.right=s,i.left=h,h.parent=i,i.bounds=o.bounds.combine(h.bounds),n.bounds=i.bounds.combine(s.bounds),i.height=1+Math.max(o.height,h.height),n.height=1+Math.max(i.height,s.height)),n}return t},n.prototype.getHeight=function(){return null===this.root?0:this.root.height},n.prototype.query=function(t,e){var r=t.collider.bounds;!function i(n){if(n&&n.bounds.intersect(r)){if(!n.isLeaf()||n.body===t)return i(n.left)||i(n.right);if(e.call(t,n.body))return!0}return!1}(this.root)},n.prototype.rayCastQuery=function(t,e,r){void 0===e&&(e=1/0);!function i(n){if(n&&n.bounds.rayCast(t,e)){if(!n.isLeaf())return i(n.left)||i(n.right);if(r.call(t,n.body))return!0}return!1}(this.root)},n.prototype.getNodes=function(){return function t(e){return e?[e].concat(t(e.left),t(e.right)):[]}(this.root)},n.prototype.debugDraw=function(t){!function e(r){r&&(r.isLeaf()?(t.lineWidth=1,t.strokeStyle="green"):(t.lineWidth=1,t.strokeStyle="white"),r.bounds.debugDraw(t),r.left&&e(r.left),r.right&&e(r.right))}(this.root)},n}();exports.DynamicTree=n;
},{"./../Physics":"uSEN","./BoundingBox":"oyna","../Util/Log":"p1Gn"}],"O6gl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DynamicTreeCollisionBroadphase=void 0;var i=require("./../Physics"),r=require("./DynamicTree"),e=require("./Pair"),o=require("../Algebra"),n=require("../Util/Log"),l=require("../Events"),t=require("./CollisionType"),s=function(i){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&i[r],o=0;if(e)return e.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&o>=i.length&&(i=void 0),{value:i&&i[o++],done:!i}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},a=function(){function a(){this._dynamicCollisionTree=new r.DynamicTree,this._collisionHash={},this._collisionPairCache=[],this._lastFramePairs=[],this._lastFramePairsHash={}}return a.prototype.track=function(i){i?this._dynamicCollisionTree.trackBody(i):n.Logger.getInstance().warn("Cannot track null physics body")},a.prototype.untrack=function(i){i?this._dynamicCollisionTree.untrackBody(i):n.Logger.getInstance().warn("Cannot untrack a null physics body")},a.prototype._shouldGenerateCollisionPair=function(i,r){var o=e.Pair.calculatePairHash(i,r);return!this._collisionHash[o]&&e.Pair.canCollide(i,r)},a.prototype.broadphase=function(r,n,l){var a,c,d,h=this,y=n/1e3,u=r.map(function(i){return i.collider}).filter(function(i){return i.active&&i.type!==t.CollisionType.PreventCollision});this._collisionPairCache=[],this._collisionHash={};for(var f=0,p=u.length;f<p;f++)d=u[f],this._dynamicCollisionTree.query(d.body,function(i){if(h._shouldGenerateCollisionPair(d,i.collider)){var r=new e.Pair(d,i.collider);h._collisionHash[r.id]=!0,h._collisionPairCache.push(r)}return!1});if(l&&(l.physics.pairs=this._collisionPairCache.length),i.Physics.checkForFastBodies){var v=function(r){if(r.type!==t.CollisionType.Active)return"continue";var n=r.body.vel.size*y+.5*r.body.acc.size*y*y,s=Math.min(r.bounds.height,r.bounds.width);if(i.Physics.disableMinimumSpeedForFastBody||n>s/2){l&&l.physics.fastBodies++;var a,c=r.body.pos.sub(r.body.oldPos),d=r.shape.center,h=r.shape.getFurthestPoint(r.body.vel),u=h.sub(c),f=new o.Ray(u,r.body.vel);f.pos=f.pos.add(f.dir.scale(-2*i.Physics.surfaceEpsilon));var p=new o.Vector(1/0,1/0);if(P._dynamicCollisionTree.rayCastQuery(f,n+2*i.Physics.surfaceEpsilon,function(o){if(r.body!==o&&o.collider.shape&&e.Pair.canCollide(r,o.collider)){var l=o.collider.shape.rayCast(f,n+10*i.Physics.surfaceEpsilon);if(l){var t=l.sub(u);t.size<p.size&&(p=t,a=o)}}return!1}),a&&o.Vector.isValid(p)){var v=new e.Pair(r,a.collider);P._collisionHash[v.id]||(P._collisionHash[v.id]=!0,P._collisionPairCache.push(v));var C=d.sub(h);r.body.pos=u.add(C).add(p).add(f.dir.scale(2*i.Physics.surfaceEpsilon)),r.shape.recalc(),l&&l.physics.fastBodyCollisions++}}},P=this;try{for(var C=s(u),b=C.next();!b.done;b=C.next()){v(b.value)}}catch(m){a={error:m}}finally{try{b&&!b.done&&(c=C.return)&&c.call(C)}finally{if(a)throw a.error}}}return this._collisionPairCache},a.prototype.narrowphase=function(i,r){for(var e=0;e<i.length;e++)i[e].collide(),r&&i[e].collision&&(r.physics.collisions++,r.physics.collidersHash[i[e].id]=i[e]);return i.filter(function(i){return i.collision})},a.prototype.resolve=function(r,e,o){var n,l;try{for(var t=s(r),a=t.next();!a.done;a=t.next()){var c=a.value;c.resolve(o),c.collision&&(c.colliderA.body.applyMtv(),c.colliderB.body.applyMtv(),c.colliderA.body.integrate(e*i.Physics.collisionShift),c.colliderB.body.integrate(e*i.Physics.collisionShift))}}catch(d){n={error:d}}finally{try{a&&!a.done&&(l=t.return)&&l.call(t)}finally{if(n)throw n.error}}return r.filter(function(i){return i.canCollide})},a.prototype.runCollisionStartEnd=function(i){var r,e,o,n,t={};try{for(var a=s(i),c=a.next();!c.done;c=a.next()){if(t[(f=c.value).id]=f,!this._lastFramePairsHash[f.id]){var d=f.colliderA,h=f.colliderB;d.emit("collisionstart",new l.CollisionStartEvent(d,h,f)),h.emit("collisionstart",new l.CollisionStartEvent(h,d,f))}}}catch(p){r={error:p}}finally{try{c&&!c.done&&(e=a.return)&&e.call(a)}finally{if(r)throw r.error}}try{for(var y=s(this._lastFramePairs),u=y.next();!u.done;u=y.next()){var f;if(!t[(f=u.value).id]){d=f.colliderA,h=f.colliderB;d.emit("collisionend",new l.CollisionEndEvent(d,h)),h.emit("collisionend",new l.CollisionEndEvent(h,d))}}}catch(v){o={error:v}}finally{try{u&&!u.done&&(n=y.return)&&n.call(y)}finally{if(o)throw o.error}}this._lastFramePairs=i,this._lastFramePairsHash=t},a.prototype.update=function(i){for(var r=0,e=i.length,o=0;o<e;o++)this._dynamicCollisionTree.updateBody(i[o])&&r++;return r},a.prototype.debugDraw=function(r){var e,o;if(i.Physics.broadphaseDebug&&this._dynamicCollisionTree.debugDraw(r),i.Physics.showContacts||i.Physics.showCollisionNormals)try{for(var n=s(this._collisionPairCache),l=n.next();!l.done;l=n.next()){l.value.debugDraw(r)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(o=n.return)&&o.call(n)}finally{if(e)throw e.error}}},a}();exports.DynamicTreeCollisionBroadphase=a;
},{"./../Physics":"uSEN","./DynamicTree":"BGmr","./Pair":"zTU8","../Algebra":"NGcQ","../Util/Log":"p1Gn","../Events":"XySq","./CollisionType":"liCD"}],"kKHB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Body");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./Collider");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./BoundingBox");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var n=require("./Circle");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}})});var o=require("./CollisionContact");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}})});var u=require("./CollisionJumpTable");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});var c=require("./ClosestLineJumpTable");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}})});var i=require("./CollisionGroup");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}})});var f=require("./CollisionGroupManager");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return f[e]}})});var a=require("./DynamicTree");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return a[e]}})});var l=require("./DynamicTreeCollisionBroadphase");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return l[e]}})});var s=require("./Edge");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}})});var d=require("./Pair");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return d[e]}})});var b=require("./ConvexPolygon");Object.keys(b).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return b[e]}})});var p=require("./Side");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return p[e]}})});var y=require("./Shape");Object.keys(y).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return y[e]}})});
},{"./Body":"oGoG","./Collider":"KRUI","./BoundingBox":"oyna","./Circle":"xS4a","./CollisionContact":"rA38","./CollisionJumpTable":"fXkm","./ClosestLineJumpTable":"j4ks","./CollisionGroup":"NyBG","./CollisionGroupManager":"Tnas","./DynamicTree":"BGmr","./DynamicTreeCollisionBroadphase":"O6gl","./Edge":"s26C","./Pair":"zTU8","./ConvexPolygon":"EI0S","./Side":"YM02","./Shape":"Mmyc"}],"Bb5D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TileMapCollisionDetection=void 0;var e=require("../Collision/Side"),i=require("../Events"),o=require("../Collision/CollisionType"),n=require("../Collision/Index"),l=function(){function l(){}return l.prototype.update=function(l,t){var r=l.eventDispatcher;if(l.body.collider.type!==o.CollisionType.PreventCollision&&t.currentScene&&t.currentScene.tileMaps)for(var s=0;s<t.currentScene.tileMaps.length;s++)for(var c=t.currentScene.tileMaps[s],p=void 0,u=e.Side.None,d=2;(p=c.collides(l))&&!(d--<0);)u=n.BoundingBox.getSideFromIntersection(p),r.emit("precollision",new i.PreCollisionEvent(l,null,u,p)),l.body.collider.type===o.CollisionType.Active&&(l.pos.y+=p.y,l.pos.x+=p.x,r.emit("postcollision",new i.PostCollisionEvent(l,null,u,p)))},l}();exports.TileMapCollisionDetection=l;
},{"../Collision/Side":"YM02","../Events":"XySq","../Collision/CollisionType":"liCD","../Collision/Index":"kKHB"}],"CPmg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./CapturePointer");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./OffscreenCulling");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./TileMapCollisionDetection");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});
},{"./CapturePointer":"G2LY","./OffscreenCulling":"mlEX","./TileMapCollisionDetection":"Bb5D"}],"OZee":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Graphic=void 0;var t=require("../Algebra"),i=require("../Collision/BoundingBox"),o=function(){function o(i){var e,s,r,n,h,l;this.id=o._ID++,this.showDebug=!1,this.flipHorizontal=!1,this.flipVertical=!1,this.rotation=0,this.opacity=1,this.scale=t.Vector.One,this.origin=null,this._width=0,this._height=0,i&&(this.origin=null!==(e=i.origin)&&void 0!==e?e:this.origin,this.flipHorizontal=null!==(s=i.flipHorizontal)&&void 0!==s?s:this.flipHorizontal,this.flipVertical=null!==(r=i.flipVertical)&&void 0!==r?r:this.flipVertical,this.rotation=null!==(n=i.rotation)&&void 0!==n?n:this.rotation,this.opacity=null!==(h=i.opacity)&&void 0!==h?h:this.opacity,this.scale=null!==(l=i.scale)&&void 0!==l?l:this.scale)}return o.prototype.cloneGraphicOptions=function(){return{origin:this.origin?this.origin.clone():null,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,rotation:this.rotation,opacity:this.opacity,scale:this.scale?this.scale.clone():null}},Object.defineProperty(o.prototype,"width",{get:function(){return this._width*this.scale.x},set:function(t){this._width=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height*this.scale.y},set:function(t){this._height=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"localBounds",{get:function(){return i.BoundingBox.fromDimension(this._width*this.scale.x,this._height*this.scale.y,t.Vector.Zero)},enumerable:!0,configurable:!0}),o.prototype.draw=function(t,i,o){this._preDraw(t,i,o),this._drawImage(t,0,0),this._postDraw(t)},o.prototype._preDraw=function(t,i,o){t.save(),t.translate(i,o),this._rotate(t),t.scale(this.scale.x,this.scale.y),this._flip(t),t.opacity=t.opacity*this.opacity},o.prototype._rotate=function(i){var o,e=null!==(o=this.origin)&&void 0!==o?o:(0,t.vec)(this.width/2,this.height/2);i.translate(e.x,e.y),i.rotate(this.rotation),i.translate(-e.x,-e.y)},o.prototype._flip=function(t){this.flipHorizontal&&(t.translate(this.width/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,this.height/this.scale.y),t.scale(1,-1))},o.prototype._postDraw=function(t){this.showDebug&&t.drawDebugRect(0,0,this.width,this.height),t.restore()},o._ID=0,o}();exports.Graphic=o;
},{"../Algebra":"NGcQ","../Collision/BoundingBox":"oyna"}],"zu78":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Animation=exports.AnimationStrategy=void 0;var t,e=require("./Graphic"),r=require("../Util/Util"),i=require("../EventDispatcher"),n=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),o=function(){return(o=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};exports.AnimationStrategy=t,function(t){t.End="end",t.Loop="loop",t.PingPong="pingpong",t.Freeze="freeze"}(t||(exports.AnimationStrategy=t={}));var a=function(e){function a(r){var n,o,a=e.call(this,r)||this;return a.frames=[],a.strategy=t.Loop,a.frameDuration=100,a._currentFrame=0,a._timeLeftInFrame=0,a._direction=1,a._done=!1,a._playing=!0,a._emitter=new i.EventDispatcher(a),a.frames=r.frames,a.strategy=null!==(n=r.strategy)&&void 0!==n?n:a.strategy,a.frameDuration=null!==(o=r.frameDuration)&&void 0!==o?o:a.frameDuration,a.goToFrame(0),a}return n(a,e),a.prototype.clone=function(){return new a(o({frames:this.frames.map(function(t){return o({},t)}),frameDuration:this.frameDuration,strategy:this.strategy},this.cloneGraphicOptions()))},a.fromSpriteSheet=function(e,r,i,n){return void 0===n&&(n=t.Loop),new a({frames:e.sprites.filter(function(t,e){return r.indexOf(e)>-1}).map(function(t){return{graphic:t,duration:i}}),strategy:n})},Object.defineProperty(a.prototype,"tags",{get:function(){return this.currentFrame.tags},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentFrame",{get:function(){return this._currentFrame>=0&&this._currentFrame<this.frames.length?this.frames[this._currentFrame]:null},enumerable:!0,configurable:!0}),a.prototype.getSource=function(){return this.frames[this._currentFrame].graphic.getSource()},a.prototype.play=function(){this._playing=!0},a.prototype.pause=function(){this._playing=!1},a.prototype.reset=function(){this._done=!1,this._currentFrame=0},Object.defineProperty(a.prototype,"canFinish",{get:function(){switch(this.strategy){case t.End:case t.Freeze:return!0;default:return!1}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0}),a.prototype.goToFrame=function(t){var e,r;this._currentFrame=t,this._timeLeftInFrame=this.frameDuration;var i=this.frames[this._currentFrame];i&&!this._done&&(this._timeLeftInFrame=(null==i?void 0:i.duration)||this.frameDuration,this.width=null===(e=i.graphic)||void 0===e?void 0:e.width,this.height=null===(r=i.graphic)||void 0===r?void 0:r.height,this.emit("frame",i))},a.prototype._nextFrame=function(){var e=this._currentFrame;if(this._done)return e;var i=-1;switch(this.strategy){case t.Loop:0===(i=(e+1)%this.frames.length)&&this.emit("loop",this);break;case t.End:(i=e+1)>=this.frames.length&&(this._done=!0,this._currentFrame=this.frames.length,this.emit("ended",this));break;case t.Freeze:(i=(0,r.clamp)(e+1,0,this.frames.length-1))>=this.frames.length-1&&(this._done=!0,this.emit("ended",this));break;case t.PingPong:e+this._direction>=this.frames.length&&(this._direction=-1,this.emit("loop",this)),e+this._direction<0&&(this._direction=1,this.emit("loop",this)),i=e+this._direction%this.frames.length}return i},a.prototype.tick=function(t){this._playing&&(this._timeLeftInFrame-=t,this._timeLeftInFrame<=0&&this.goToFrame(this._nextFrame()),this._updateDimensions())},a.prototype._updateDimensions=function(){var t,e;this.currentFrame&&(this.width=null===(t=this.currentFrame.graphic)||void 0===t?void 0:t.width,this.height=null===(e=this.currentFrame.graphic)||void 0===e?void 0:e.height)},a.prototype._drawImage=function(t,e,r){this.currentFrame&&this.currentFrame.graphic.draw(t,e,r)},a.prototype.emit=function(t,e){this._emitter.emit(t,e)},a.prototype.on=function(t,e){this._emitter.on(t,e)},a.prototype.off=function(t,e){this._emitter.off(t,e)},a.prototype.once=function(t,e){this._emitter.once(t,e)},a}(e.Graphic);exports.Animation=a;
},{"./Graphic":"OZee","../Util/Util":"Kkda","../EventDispatcher":"c7EN"}],"ZgjQ":[function(require,module,exports) {
"use strict";function e(e){return new Promise(function(t){setTimeout(function(){return t()},e)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.delay=e;
},{}],"SRl6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsGroup=void 0;var r=require("./Graphic"),t=require("./Animation"),e=function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),n=function(){return(n=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o]);return r}).apply(this,arguments)},o=function(r,t){var e="function"==typeof Symbol&&r[Symbol.iterator];if(!e)return r;var n,o,i=e.call(r),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a},i=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(o(arguments[t]));return r},a=function(r){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(r){function o(t){var e=r.call(this,t)||this;return e.members=[],e.members=t.members,e.width=0,e.height=0,e}return e(o,r),o.prototype.getSource=function(){return null},Object.defineProperty(o.prototype,"image",{get:function(){return null},enumerable:!0,configurable:!0}),o.prototype.clone=function(){return new o(n({members:i(this.members)},this.cloneGraphicOptions()))},o.prototype._isAnimationOrGroup=function(r){return r instanceof t.Animation||r instanceof o},o.prototype.tick=function(r){var t,e;try{for(var n=a(this.members),o=n.next();!o.done;o=n.next()){var i=o.value.graphic;this._isAnimationOrGroup(i)&&i.tick(r)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},o.prototype.reset=function(){var r,t;try{for(var e=a(this.members),n=e.next();!n.done;n=e.next()){var o=n.value.graphic;this._isAnimationOrGroup(o)&&o.reset()}}catch(i){r={error:i}}finally{try{n&&!n.done&&(t=e.return)&&t.call(e)}finally{if(r)throw r.error}}},o.prototype._drawImage=function(r,t,e){var n,o;try{for(var i=a(this.members),c=i.next();!c.done;c=i.next()){var u=c.value;r.save(),r.translate(t,e),u.graphic.draw(r,u.pos.x,u.pos.y),this.showDebug&&r.drawDebugRect(0,0,this.width,this.height),r.restore()}}catch(l){n={error:l}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},o}(r.Graphic);exports.GraphicsGroup=c;
},{"./Graphic":"OZee","./Animation":"zu78"}],"jeAN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsComponent=exports.GraphicsLayer=void 0;var t=require("../Algebra"),r=require("./Graphic"),e=require("./Animation"),i=require("../Util/Delay"),n=require("./GraphicsGroup"),o=function(){return(o=Object.assign||function(t){for(var r,e=1,i=arguments.length;e<i;e++)for(var n in r=arguments[e])Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}).apply(this,arguments)},a=function(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},s=function(){function e(t,r){this._options=t,this._graphics=r}return Object.defineProperty(e.prototype,"name",{get:function(){return this._options.name},enumerable:!0,configurable:!0}),e.prototype.hide=function(){return this._currentGfx=null,Promise.resolve()},e.prototype.show=function(t,e){var n=null;return n=t instanceof r.Graphic?t:this._graphics.getGraphic(t),this._currentGfx=n,new Promise(function(t){e&&e?(0,i.delay)(e).then(function(){t(n)}):t(n)})},Object.defineProperty(e.prototype,"order",{get:function(){return this._options.order},set:function(t){this._options.order=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){var r;return null!==(r=this._options.offset)&&void 0!==r?r:t.Vector.Zero},set:function(t){this._options.offset=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"graphic",{get:function(){return this._currentGfx},enumerable:!0,configurable:!0}),e}();exports.GraphicsLayer=s;var u=function(){function r(t){this.type="graphics",this.__debug={graphicBounds:null,colliderBounds:null},this._graphics={},this._layers=[],this._layerMap={},this.default=new s({name:"default",order:0},this),this.visible=!0,this.opacity=1,this.offset=null,this.anchor=null;var r=(t=o({visible:this.visible},t)).current,e=t.opacity,i=t.visible,n=t.graphics,a=t.offset;this._graphics=n||{},this.offset=null!=a?a:this.offset,this.opacity=null!=e?e:this.opacity,this.visible=!!i,r&&this._graphics[r]&&this.show(this._graphics[r]),this._layers.push(this.default)}return Object.defineProperty(r.prototype,"layers",{get:function(){return this._layers},enumerable:!0,configurable:!0}),r.prototype.createLayer=function(t){var r=new s(t,this);return this._maybeAddLayer(r)},r.prototype._maybeAddLayer=function(t){return this._layerMap[t.name]?this._layerMap[t.name]:(this._layerMap[t.name]=t,this._layers.push(t),this._layers.sort(function(t,r){return t.order-r.order}),t)},r.prototype.getLayer=function(t){return this._layerMap[t]},r.prototype.getGraphic=function(t){return this._graphics[t]},Object.defineProperty(r.prototype,"current",{get:function(){return this.default.graphic},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"graphics",{get:function(){return this._graphics},enumerable:!0,configurable:!0}),r.prototype.add=function(t,r){var e="default",i=null;return"string"==typeof t?(e=t,i=r):i=t,this._graphics[e]=i,"default"===e&&this.show("default"),i},r.prototype.show=function(t,r){return this.default.show(t,r)},r.prototype.hide=function(){return this.default.hide()},r.prototype._isAnimationOrGroup=function(t){return t instanceof e.Animation||t instanceof n.GraphicsGroup},r.prototype.update=function(t){var r,e,i;try{for(var n=a(this._layers),o=n.next();!o.done;o=n.next()){var s=o.value;this._isAnimationOrGroup(s.graphic)&&(null===(i=s.graphic)||void 0===i||i.tick(t))}}catch(u){r={error:u}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}},r.prototype.draw=function(r,e,i){var n,o,s,u;if(this.visible){var p=null!==(s=this.anchor)&&void 0!==s?s:t.Vector.Zero;this._layers.sort(function(t,r){return t.order-r.order});try{for(var c=a(this._layers),h=c.next();!h.done;h=c.next()){var l=h.value;if(l.graphic){var f=-l.graphic.width*l.graphic.scale.x*p.x+e,y=-l.graphic.height*l.graphic.scale.y*p.y+i;null===(u=l.graphic)||void 0===u||u.draw(r,f+l.offset.x,y+l.offset.y)}}}catch(d){n={error:d}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}},r.prototype.clone=function(){return new r({opacity:this.opacity})},r}();exports.GraphicsComponent=u;
},{"../Algebra":"NGcQ","./Graphic":"OZee","./Animation":"zu78","../Util/Delay":"ZgjQ","./GraphicsGroup":"SRl6"}],"EGNO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Entity=void 0;var t=require("./Class"),o=function(){var t=function(o,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n])})(o,n)};return function(o,n){function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),n=function(t){function n(o){void 0===o&&(o=[]);var e=t.call(this)||this;return e.id=n._ID++,e.components={},o.forEach(function(t){return e.addComponent(t)}),e}return o(n,t),n.prototype.addComponent=function(t){return t.owner=this,this.components[t.type]=t,this},n.prototype.removeComponent=function(t){return delete this.components[t],this},n.prototype.hasComponent=function(t){return!!this.components[t]},n._ID=0,n}(t.Class);exports.Entity=n;
},{"./Class":"yTUi"}],"hPn9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformComponent=exports.CoordPlane=void 0;var o,r=require("./Algebra");exports.CoordPlane=o,function(o){o.World="world",o.Screen="screen"}(o||(exports.CoordPlane=o={}));var e=function(){function e(){this.type="transform",this.owner=null,this.coordPlane=o.World,this.pos=r.Vector.Zero,this.z=0,this.rotation=0,this.scale=r.Vector.One}return e.type="transform",e}();exports.TransformComponent=e;
},{"./Algebra":"NGcQ"}],"vmFf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isActor=S,exports.Actor=exports.ActorImpl=void 0;var t=require("./Resources/Texture"),e=require("./Events"),r=require("./Drawing/Color"),o=require("./Drawing/Sprite"),i=require("./Util/Log"),n=require("./Actions/ActionContext"),s=require("./Actions/Action"),a=require("./Algebra"),l=require("./Collision/Body"),c=require("./Configurable"),h=P(require("./Traits/Index")),p=P(require("./Drawing/SpriteEffects")),u=P(require("./Util/Util")),d=require("./Collision/CollisionType"),f=require("./Util/Decorators"),y=require("./Collision/Collider"),g=require("./Collision/Shape"),b=require("./Graphics/GraphicsComponent"),v=require("./Entity"),w=require("./Transform");function _(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return _=function(){return t},t}function P(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=_();if(e&&e.has(t))return e.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=o?Object.getOwnPropertyDescriptor(t,i):null;n&&(n.get||n.set)?Object.defineProperty(r,i,n):r[i]=t[i]}return r.default=t,e&&e.set(t,r),r}function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var x=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),D=function(t,e,r,o){var i,n=arguments.length,s=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"===("undefined"==typeof Reflect?"undefined":m(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(n<3?i(s):n>3?i(e,r,s):i(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s},O=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function S(t){return t instanceof j}var C=function(c){function v(t,e,r,o,a){var u=c.call(this)||this;u._height=0,u._width=0,u.isOffScreen=!1,u.visible=!0,u.opacity=1,u.previousOpacity=1,u.logger=i.Logger.getInstance(),u.scene=null,u.parent=null,u.children=[],u._isInitialized=!1,u.frames={},u._effectsDirty=!1,u.currentDrawing=null,u._draggable=!1,u._dragging=!1,u._pointerDragStartHandler=function(){u._dragging=!0},u._pointerDragEndHandler=function(){u._dragging=!1},u._pointerDragMoveHandler=function(t){u._dragging&&(u.pos=t.pointer.lastWorldPos)},u._pointerDragLeaveHandler=function(t){u._dragging&&(u.pos=t.pointer.lastWorldPos)},u.traits=[],u.enableCapturePointer=!1,u.capturePointer={captureMoveEvents:!1,captureDragEvents:!1},u._zIndex=0,u._isKilled=!1,u._opacityFx=new p.Opacity(u.opacity),u._capturePointerEvents=["pointerup","pointerdown","pointermove","pointerenter","pointerleave","pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],u._captureMoveEvents=["pointermove","pointerenter","pointerleave","pointerdragmove","pointerdragenter","pointerdragleave"],u._captureDragEvents=["pointerdragstart","pointerdragend","pointerdragmove","pointerdragenter","pointerdragleave"],u._initDefaults();var f=!0,v=d.CollisionType.Passive;if(t&&"object"===m(t)){var _=t;_.pos?(t=_.pos?_.pos.x:0,e=_.pos?_.pos.y:0):(t=_.x||0,e=_.y||0),r=_.width,o=_.height,_.body&&(f=!1,u.body=_.body),_.anchor&&(u.anchor=_.anchor),_.collisionType&&(v=_.collisionType)}return u._width=r||0,u._height=o||0,f&&(u.body=new l.Body({collider:new y.Collider({type:d.CollisionType.Passive,shape:g.Shape.Box(u._width,u._height,u.anchor)})})),u.body&&u.body.collider&&(u.body.collider.type=v),u.pos.x=t||0,u.pos.y=e||0,a&&(u.color=a,u.opacity=a.a),u.graphics=new b.GraphicsComponent,u.addComponent(u.graphics),u.transform=new w.TransformComponent,u.addComponent(u.transform),u.traits.push(new h.OffscreenCulling),u.traits.push(new h.CapturePointer),u.actionQueue=new s.ActionQueue(u),u.actions=new n.ActionContext(u),u}return x(v,c),Object.defineProperty(v.prototype,"body",{get:function(){return this._body},set:function(t){this._body=t,this._body.actor=this},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"pos",{get:function(){return this.body.pos},set:function(t){this.body.pos.setTo(t.x,t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"oldPos",{get:function(){return this.body.oldPos},set:function(t){this.body.oldPos.setTo(t.x,t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"vel",{get:function(){return this.body.vel},set:function(t){this.body.vel.setTo(t.x,t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"oldVel",{get:function(){return this.body.oldVel},set:function(t){this.body.oldVel.setTo(t.x,t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"acc",{get:function(){return this.body.acc},set:function(t){this.body.acc.setTo(t.x,t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"oldAcc",{get:function(){return this.body.oldAcc},set:function(t){this.body.oldAcc.setTo(t.x,t.y)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"rotation",{get:function(){return this.body.rotation},set:function(t){this.body.rotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"rx",{get:function(){return this.body.rx},set:function(t){this.body.rx=t},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"scale",{get:function(){return this.body.scale},set:function(t){this.body.scale=t},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"oldScale",{get:function(){return this.body.oldScale},set:function(t){this.body.oldScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"sx",{get:function(){return this.body.sx},set:function(t){this.body.sx=t},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"sy",{get:function(){return this.body.sy},set:function(t){this.body.sy=t},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"draggable",{get:function(){return this._draggable},set:function(t){t&&(t&&!this._draggable?(this.on("pointerdragstart",this._pointerDragStartHandler),this.on("pointerdragend",this._pointerDragEndHandler),this.on("pointerdragmove",this._pointerDragMoveHandler),this.on("pointerdragleave",this._pointerDragLeaveHandler)):!t&&this._draggable&&(this.off("pointerdragstart",this._pointerDragStartHandler),this.off("pointerdragend",this._pointerDragEndHandler),this.off("pointerdragmove",this._pointerDragMoveHandler),this.off("pointerdragleave",this._pointerDragLeaveHandler)),this._draggable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t.clone()},enumerable:!0,configurable:!0}),v.prototype.enableTileMapCollision=function(){this.traits.push(new h.TileMapCollisionDetection)},v.prototype.onInitialize=function(t){},Object.defineProperty(v.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0}),v.prototype._initialize=function(t){var r,o;this.isInitialized||(this.onInitialize(t),c.prototype.emit.call(this,"initialize",new e.InitializeEvent(t,this)),this._isInitialized=!0);try{for(var i=O(this.children),n=i.next();!n.done;n=i.next()){n.value._initialize(t)}}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},v.prototype._initDefaults=function(){this.anchor=j.defaults.anchor.clone()},v.prototype._checkForPointerOptIn=function(t){if(t){var e=t.toLowerCase();-1!==this._capturePointerEvents.indexOf(e)&&(this.enableCapturePointer=!0,-1!==this._captureMoveEvents.indexOf(e)&&(this.capturePointer.captureMoveEvents=!0),-1!==this._captureDragEvents.indexOf(e)&&(this.capturePointer.captureDragEvents=!0))}},v.prototype.on=function(t,e){this._checkForPointerOptIn(t),c.prototype.on.call(this,t,e)},v.prototype.once=function(t,e){this._checkForPointerOptIn(t),c.prototype.once.call(this,t,e)},v.prototype.off=function(t,e){c.prototype.off.call(this,t,e)},v.prototype._prekill=function(t){c.prototype.emit.call(this,"prekill",new e.PreKillEvent(this)),this.onPreKill(t)},v.prototype.onPreKill=function(t){},v.prototype._postkill=function(t){c.prototype.emit.call(this,"postkill",new e.PostKillEvent(this)),this.onPostKill(t)},v.prototype.onPostKill=function(t){},v.prototype.kill=function(){this.scene?(this._prekill(this.scene),this.emit("kill",new e.KillEvent(this)),this._isKilled=!0,this.scene.remove(this),this._postkill(this.scene)):this.logger.warn("Cannot kill actor, it was never added to the Scene")},v.prototype.unkill=function(){this._isKilled=!1},v.prototype.isKilled=function(){return this._isKilled},v.prototype.add=function(t){t.body.collider.type=d.CollisionType.PreventCollision,u.addItemToArray(t,this.children)&&(t.parent=this)},v.prototype.remove=function(t){u.removeItemFromArray(t,this.children)&&(t.parent=null)},v.prototype.setDrawing=function(t){t=t.toString(),this.currentDrawing!==this.frames[t]&&(null!=this.frames[t]?(this.frames[t].reset(),this.currentDrawing=this.frames[t]):i.Logger.getInstance().error("the specified drawing key "+t+" does not exist"))},v.prototype.addDrawing=function(){2===arguments.length?(this.frames[arguments[0]]=arguments[1],this.currentDrawing||(this.currentDrawing=arguments[1]),this._effectsDirty=!0):(arguments[0]instanceof o.Sprite&&this.addDrawing("default",arguments[0]),arguments[0]instanceof t.Texture&&this.addDrawing("default",arguments[0].asSprite()))},Object.defineProperty(v.prototype,"z",{get:function(){return this.getZIndex()},set:function(t){this.setZIndex(t)},enumerable:!0,configurable:!0}),v.prototype.getZIndex=function(){return this._zIndex},v.prototype.setZIndex=function(t){this.scene.cleanupDrawTree(this),this._zIndex=t,this.scene.updateDrawTree(this)},Object.defineProperty(v.prototype,"center",{get:function(){return new a.Vector(this.pos.x+this.width/2-this.anchor.x*this.width,this.pos.y+this.height/2-this.anchor.y*this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"width",{get:function(){return this._width*this.getGlobalScale().x},set:function(t){this._width=t/this.scale.x,this.body.collider.shape=g.Shape.Box(this._width,this._height,this.anchor),this.body.markCollisionShapeDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"height",{get:function(){return this._height*this.getGlobalScale().y},set:function(t){this._height=t/this.scale.y,this.body.collider.shape=g.Shape.Box(this._width,this._height,this.anchor),this.body.markCollisionShapeDirty()},enumerable:!0,configurable:!0}),v.prototype.getWorldRotation=function(){return this.parent?this.rotation+this.parent.getWorldRotation():this.rotation},v.prototype.getWorldPos=function(){if(!this.parent)return this.pos.clone();var t=[],e=this;for(t.push(this);e.parent;)e=e.parent,t.push(e);var r=t.reduceRight(function(t,e){return e.parent?t+e.pos.x*e.getGlobalScale().x:t+e.pos.x},0),o=t.reduceRight(function(t,e){return e.parent?t+e.pos.y*e.getGlobalScale().y:t+e.pos.y},0),i=e.getWorldPos(),n=this.getWorldRotation();return new a.Vector(r,o).rotate(n,i)},v.prototype.getGlobalScale=function(){if(!this.parent)return new a.Vector(this.scale.x,this.scale.y);var t=this.parent.getGlobalScale();return new a.Vector(this.scale.x*t.x,this.scale.y*t.y)},v.prototype.contains=function(t,e,r){void 0===r&&(r=!1);var o=this.getWorldPos().sub(this.pos),i=this.body.collider.bounds.translate(o).contains(new a.Vector(t,e));return r?i||this.children.some(function(r){return r.contains(t,e,!0)}):i},v.prototype.within=function(t,e){return this.body.collider.shape.getClosestLineBetween(t.body.collider.shape).getLength()<=e},v.prototype._reapplyEffects=function(t){t.removeEffect(this._opacityFx),t.addEffect(this._opacityFx)},v.prototype.update=function(t,e){var r,o;this._initialize(t),this._preupdate(t,e),this.actionQueue.update(e),this.color&&(this.color.a=this.opacity),0===this.opacity&&(this.visible=!1),this.previousOpacity!==this.opacity&&(this.previousOpacity=this.opacity,this._opacityFx.opacity=this.opacity,this._effectsDirty=!0),this.body.captureOldTransform(),this.body.integrate(e),this.transform.pos=this.pos,this.transform.z=this.z,this.transform.rotation=this.rotation,this.transform.scale=this.scale;try{for(var i=O(this.traits),n=i.next();!n.done;n=i.next()){n.value.update(this,t,e)}}catch(a){r={error:a}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}for(var s=0;s<this.children.length;s++)this.children[s].update(t,e);this._postupdate(t,e)},v.prototype.onPreUpdate=function(t,e){},v.prototype.onPostUpdate=function(t,e){},v.prototype._preupdate=function(t,r){this.emit("preupdate",new e.PreUpdateEvent(t,r,this)),this.onPreUpdate(t,r)},v.prototype._postupdate=function(t,r){this.emit("postupdate",new e.PostUpdateEvent(t,r,this)),this.onPostUpdate(t,r)},v.prototype.draw=function(t,e){if(t.save(),t.translate(this.pos.x,this.pos.y),t.rotate(this.rotation),t.scale(this.scale.x,this.scale.y),t.save(),t.translate(-this._width*this.anchor.x,-this._height*this.anchor.y),this._predraw(t,e),this.currentDrawing){var r=this.currentDrawing,o=(this._width-r.width*r.scale.x)*this.anchor.x,i=(this._height-r.height*r.scale.y)*this.anchor.y;this._effectsDirty&&(this._reapplyEffects(this.currentDrawing),this._effectsDirty=!1),this.currentDrawing.draw(t,o,i)}else this.color&&this.body&&this.body.collider&&this.body.collider.shape&&this.body.collider.shape.draw(t,this.color,new a.Vector(this.width*this.anchor.x,this.height*this.anchor.y));t.restore();for(var n=0;n<this.children.length;n++)this.children[n].visible&&this.children[n].draw(t,e);this._postdraw(t,e),t.restore()},v.prototype.onPreDraw=function(t,e){},v.prototype.onPostDraw=function(t,e){},v.prototype._predraw=function(t,r){this.emit("predraw",new e.PreDrawEvent(t,r,this)),this.onPreDraw(t,r)},v.prototype._postdraw=function(t,r){this.emit("postdraw",new e.PreDrawEvent(t,r,this)),this.onPostDraw(t,r)},v.prototype.debugDraw=function(t){this.emit("predebugdraw",new e.PreDebugDrawEvent(t,this)),this.body.collider.debugDraw(t);var o=this.body.collider.localBounds.translate(this.getWorldPos());o.debugDraw(t),t.fillText("id: "+this.id,o.left+3,o.top+10),t.fillStyle=r.Color.Yellow.toString(),t.beginPath(),t.arc(this.getWorldPos().x,this.getWorldPos().y,3,0,2*Math.PI),t.closePath(),t.fill();for(var i=0;i<this.traits.length;i++)this.traits[i]instanceof h.OffscreenCulling&&this.traits[i].cullingBox.debugDraw(t);t.strokeStyle=r.Color.Yellow.toString(),t.beginPath();var n=Math.min(this.width,this.height);t.arc(this.getWorldPos().x,this.getWorldPos().y,n,0,2*Math.PI),t.closePath(),t.stroke();var s={"0 Pi":0,"Pi/2":Math.PI/2,Pi:Math.PI,"3/2 Pi":3*Math.PI/2},a=t.font;for(var l in s)t.fillStyle=r.Color.Yellow.toString(),t.font="14px",t.textAlign="center",t.fillText(l,this.getWorldPos().x+Math.cos(s[l])*(n+10),this.getWorldPos().y+Math.sin(s[l])*(n+10));t.font=a;for(var c=0;c<this.children.length;c++)this.children[c].debugDraw(t);this.emit("postdebugdraw",new e.PostDebugDrawEvent(t,this))},v.prototype.getAncestors=function(){for(var t,e=[this],r=this;t=r.parent;)r=t,e.push(r);return e.reverse()},v.defaults={anchor:a.Vector.Half},D([(0,f.obsolete)({message:"ex.Actor.sx will be removed in v0.25.0",alternateMethod:"Set width and height directly in constructor"})],v.prototype,"sx",null),D([(0,f.obsolete)({message:"ex.Actor.sy will be removed in v0.25.0",alternateMethod:"Set width and height directly in constructor"})],v.prototype,"sy",null),v}(v.Entity);exports.ActorImpl=C;var j=function(t){function e(e,r,o,i,n){return t.call(this,e,r,o,i,n)||this}return x(e,t),e}((0,c.Configurable)(C));exports.Actor=j;
},{"./Resources/Texture":"HrNa","./Events":"XySq","./Drawing/Color":"p7Gh","./Drawing/Sprite":"PpGD","./Util/Log":"p1Gn","./Actions/ActionContext":"vA04","./Actions/Action":"gDdL","./Algebra":"NGcQ","./Collision/Body":"oGoG","./Configurable":"A4Kj","./Traits/Index":"CPmg","./Drawing/SpriteEffects":"OEQf","./Util/Util":"Kkda","./Collision/CollisionType":"liCD","./Util/Decorators":"kQDE","./Collision/Collider":"KRUI","./Collision/Shape":"Mmyc","./Graphics/GraphicsComponent":"jeAN","./Entity":"EGNO","./Transform":"hPn9"}],"PDm1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UIActor=exports.ScreenElement=void 0;var e=require("./Algebra"),t=require("./Actor"),r=u(require("./Traits/Index")),o=require("./Collision/CollisionType"),n=require("./Collision/Shape"),i=require("./Util/Decorators"),c=require("./Transform");function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=o?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),f=function(e,t,r,o){var n,i=arguments.length,c=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,o);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(c=(i<3?n(c):i>3?n(t,r,c):n(t,r))||c);return i>3&&c&&Object.defineProperty(t,r,c),c},s=function(t){function i(e,i,l,u){var p=this;return(p="object"!==a(e)?t.call(this,e,i,l,u)||this:t.call(this,e)||this).traits=[],p.traits.push(new r.CapturePointer),p.anchor.setTo(0,0),p.body.collider.type=o.CollisionType.PreventCollision,p.body.collider.shape=n.Shape.Box(p.width,p.height,p.anchor),p.enableCapturePointer=!0,p.transform.coordPlane=c.CoordPlane.Screen,p}return p(i,t),i.prototype._initialize=function(e){this._engine=e,t.prototype._initialize.call(this,e)},i.prototype.contains=function(r,o,n){if(void 0===n&&(n=!0),n)return t.prototype.contains.call(this,r,o);var i=this._engine.worldToScreenCoordinates(new e.Vector(r,o));return t.prototype.contains.call(this,i.x,i.y)},i}(t.Actor);exports.ScreenElement=s;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t=f([(0,i.obsolete)({message:"Will be removed in v0.25.0",alternateMethod:"ScreenElement"})],t)}(s);exports.UIActor=y;
},{"./Algebra":"NGcQ","./Actor":"vmFf","./Traits/Index":"CPmg","./Collision/CollisionType":"liCD","./Collision/Shape":"Mmyc","./Util/Decorators":"kQDE","./Transform":"hPn9"}],"y7ZJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Timer=void 0;var e=function(){function e(t,s,i,r){if(this.id=0,this.interval=10,this.repeats=!1,this.maxNumberOfRepeats=-1,this._elapsedTime=0,this._totalTimeAlive=0,this._paused=!1,this._numberOfTicks=0,this.complete=!1,this.scene=null,"function"!=typeof t){var a=t;t=a.fcn,s=a.interval,i=a.repeats,r=a.numberOfRepeats}if(r&&r>=0&&(this.maxNumberOfRepeats=r,!i))throw new Error("repeats must be set to true if numberOfRepeats is set");this.id=e.id++,this.interval=s||this.interval,this.repeats=i||this.repeats,this._callbacks=[],t&&this.on(t)}return e.prototype.on=function(e){this._callbacks.push(e)},e.prototype.off=function(e){var t=this._callbacks.indexOf(e);this._callbacks.splice(t,1)},e.prototype.update=function(e){var t=this;this._paused||(this._totalTimeAlive+=e,this._elapsedTime+=e,this.maxNumberOfRepeats>-1&&this._numberOfTicks>=this.maxNumberOfRepeats&&(this.complete=!0),!this.complete&&this._elapsedTime>=this.interval&&(this._callbacks.forEach(function(e){e.call(t)}),this._numberOfTicks++,this.repeats?this._elapsedTime=0:this.complete=!0))},e.prototype.reset=function(e,t){if(e&&e>=0&&(this.interval=e),this.maxNumberOfRepeats&&this.maxNumberOfRepeats>=0&&(this.maxNumberOfRepeats=t,!this.repeats))throw new Error("repeats must be set to true if numberOfRepeats is set");this.complete=!1,this._elapsedTime=0,this._numberOfTicks=0},Object.defineProperty(e.prototype,"timesRepeated",{get:function(){return this._numberOfTicks},enumerable:!0,configurable:!0}),e.prototype.getTimeRunning=function(){return this._totalTimeAlive},e.prototype.pause=function(){this._paused=!0},e.prototype.unpause=function(){this._paused=!1},e.prototype.cancel=function(){this.scene&&this.scene.cancelTimer(this)},e.id=0,e}();exports.Timer=e;
},{}],"tEFe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sprite=void 0;var t=require("./Graphic"),e=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(){return(i=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=function(t){function r(e){var i,r,o=t.call(this,e)||this;return o.rawImage=e.image,o.sourceView=null!==(i=e.sourceView)&&void 0!==i?i:{x:0,y:0,width:0,height:0},o.destSize=null!==(r=e.destSize)&&void 0!==r?r:{width:0,height:0},o.rawImage.whenLoaded.then(function(){o._updateSpriteDimensions()}),o}return e(r,t),r.from=function(t){return new r({image:t})},r.prototype._updateSpriteDimensions=function(){var t=this.rawImage,e=t.width,i=t.height;this.sourceView.width=this.sourceView.width||e,this.sourceView.height=this.sourceView.height||i,this.destSize.width=this.destSize.width||e,this.destSize.height=this.destSize.height||i,this.width=Math.ceil(this.destSize.width),this.height=Math.ceil(this.destSize.height)},r.prototype._drawImage=function(t,e,i){this.rawImage.isLoaded()&&(this._updateSpriteDimensions(),t.drawImage(this,this.sourceView.x,this.sourceView.y,this.sourceView.width,this.sourceView.height,e,i,this.destSize.width,this.destSize.height))},r.prototype.getSource=function(){return this.rawImage.image},r.prototype.clone=function(){return new r(i({image:this.rawImage,sourceView:i({},this.sourceView),destSize:i({},this.destSize)},this.cloneGraphicOptions()))},r}(t.Graphic);exports.Sprite=r;
},{"./Graphic":"OZee"}],"hmKU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpriteSheet=void 0;var e=require("./Sprite"),i=function(){function i(e){this.sprites=[];var i=e.image,t=e.sprites;this.sprites=t,this.image=i}return i.fromGrid=function(t){for(var r=[],s=t.image,n=t.grid,o=n.rows,p=n.columns,h=n.spriteWidth,u=n.spriteHeight,a=n.padding,d=0;d<p;d++)for(var g=0;g<o;g++)r[d+g*p]=new e.Sprite({image:s,sourceView:{x:d*h+(null!=a?a:0),y:g*u+(null!=a?a:0),width:h,height:u},destSize:{height:u,width:h}});return new i({image:s,sprites:r})},i}();exports.SpriteSheet=i;
},{"./Sprite":"tEFe"}],"XkNM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RawImage=void 0;var e=require("../Resources/Resource"),t=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),o=function(e){function o(t,n){void 0===n&&(n=!1);var a=e.call(this,t,"blob",n)||this;return a.path=t,a.id=o._ID++,a.image=new Image,a.whenLoaded=new Promise(function(e){a._whenLoadedResolve=e}),a}return t(o,e),Object.defineProperty(o.prototype,"width",{get:function(){return this.image.naturalWidth},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.image.naturalHeight},enumerable:!0,configurable:!0}),o.prototype._isDataUrl=function(e){return e.indexOf("data:image/")>-1},o.prototype._resolveWhenLoaded=function(e){var t=this;this.image.addEventListener("load",function(){e(t.image),t._whenLoadedResolve(t.image)})},o.prototype.load=function(){var t=this;return new Promise(function(o,n){t.isLoaded()?o(t.image):(t._resolveWhenLoaded(o),t._isDataUrl(t.path)?t.image.src=t.path:e.prototype.load.call(t).then(function(){t.image.src=e.prototype.getData.call(t)}))})},o.fromLegacyTexture=function(e){var t=new o(e.path);return e.isLoaded()?(t.image=e.image,t.data=e.data):e.loaded.then(function(){t.image=e.image,t.data=e.data}),t},o.prototype.unload=function(){this.data=null,this.image=new Image},o._ID=0,o}(e.Resource);exports.RawImage=o;
},{"../Resources/Resource":"lN80"}],"MzmB":[function(require,module,exports) {
"use strict";function e(e){return 0==(e&e-1)}function r(e){--e;for(var r=1;r<32;r<<=1)e|=e>>r;return e+1}function o(o){return e(o)?o:r(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPowerOfTwo=e,exports.nextHighestPowerOfTwo=r,exports.ensurePowerOfTwo=o;
},{}],"Syvu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Raster=void 0;var t=require("./Graphic"),e=require("../Drawing/Color"),i=require("./Context/webgl-util"),o=require("../Algebra"),r=require("../Collision/BoundingBox"),n=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),s=function(t){function s(o){var r,n,s,h,l,a,u,c=t.call(this,o)||this;c._dirty=!0,c._smoothing=!1,c._lineWidth=1,c._lineDash=[],c._padding=0,o&&(c.color=null!==(r=o.color)&&void 0!==r?r:e.Color.Black,c.strokeColor=null==o?void 0:o.strokeColor,c.smoothing=null!==(n=o.smoothing)&&void 0!==n?n:c.smoothing,c.lineWidth=null!==(s=o.lineWidth)&&void 0!==s?s:c.lineWidth,c.lineDash=null!==(h=o.lineDash)&&void 0!==h?h:c.lineDash,c.padding=null!==(l=o.padding)&&void 0!==l?l:c.padding),c._bitmap=document.createElement("canvas");var p=null!==(a=o.width)&&void 0!==a?a:c._bitmap.width,d=null!==(u=o.height)&&void 0!==u?u:c._bitmap.height;c._bitmap.width=(0,i.ensurePowerOfTwo)(p),c._bitmap.height=(0,i.ensurePowerOfTwo)(d);var g=c._bitmap.getContext("2d");if(!g)throw new Error("Browser does not support 2d canvas drawing, cannot create Raster graphic");return c._ctx=g,c}return n(s,t),s.prototype.cloneRasterOptions=function(){return{color:this.color?this.color.clone():null,strokeColor:this.strokeColor?this.strokeColor.clone():null,smoothing:this.smoothing,lineWidth:this.lineWidth,lineDash:this.lineDash,padding:this.padding}},Object.defineProperty(s.prototype,"dirty",{get:function(){return this._dirty},enumerable:!0,configurable:!0}),s.prototype.flagDirty=function(){this._dirty=!0},Object.defineProperty(s.prototype,"width",{get:function(){return this._bitmap.width},set:function(t){this._bitmap.width=t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this._bitmap.height},set:function(t){this._bitmap.height=t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"localBounds",{get:function(){return r.BoundingBox.fromDimension(this.width*this.scale.x,this.height*this.scale.y,o.Vector.Zero)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"smoothing",{get:function(){return this._smoothing},set:function(t){this._smoothing=t,this.flagDirty()},enumerable:!0,configurable:!0}),s.prototype._createColorProxy=function(t){var e=this;return new Proxy(t,{set:function(t,i,o){return t[i]=o,e.flagDirty(),!0}})},Object.defineProperty(s.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t?this._createColorProxy(t):t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(t){this._strokeColor=t?this._createColorProxy(t):t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"lineDash",{get:function(){return this._lineDash},set:function(t){this._lineDash=t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding=t,this.flagDirty()},enumerable:!0,configurable:!0}),s.prototype.rasterize=function(){this._dirty=!1,this._ctx.clearRect(0,0,this.width,this.height),this._ctx.save(),this._applyRasterProperites(this._ctx),this.execute(this._ctx),this._ctx.restore(),this._flagTextureDirty=!0},s.prototype._applyRasterProperites=function(t){var e,i,o;this._bitmap.width=this.width+2*this.padding,this._bitmap.height=this.height+2*this.padding,t.translate(this.padding,this.padding),t.imageSmoothingEnabled=this.smoothing,t.lineWidth=this.lineWidth,t.setLineDash(null!==(e=this.lineDash)&&void 0!==e?e:t.getLineDash()),t.strokeStyle=null===(i=this.strokeColor)||void 0===i?void 0:i.toString(),t.fillStyle=null===(o=this.color)||void 0===o?void 0:o.toString()},s.prototype._drawImage=function(t,e,i){this._dirty&&this.rasterize(),t.drawImage(this,e,i)},s.prototype.getSource=function(){return this._bitmap},s}(t.Graphic);exports.Raster=s;
},{"./Graphic":"OZee","../Drawing/Color":"p7Gh","./Context/webgl-util":"MzmB","../Algebra":"NGcQ","../Collision/BoundingBox":"oyna"}],"vFQJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Circle=void 0;var t=require("./Raster"),r=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function i(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),e=function(){return(e=Object.assign||function(t){for(var r,e=1,i=arguments.length;e<i;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)},i=function(t){function i(r){var e=t.call(this,r)||this;return e._radius=0,e.radius=r.radius,e.rasterize(),e}return r(i,t),Object.defineProperty(i.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*this._radius,this.height=2*this._radius,this.flagDirty()},enumerable:!0,configurable:!0}),i.prototype.clone=function(){return new i(e(e({radius:this.radius},this.cloneGraphicOptions()),this.cloneRasterOptions()))},i.prototype.execute=function(t){this.radius>0&&(t.beginPath(),t.arc(this.radius,this.radius,this.radius,0,2*Math.PI),this.color&&t.fill(),this.strokeColor&&t.stroke())},i}(t.Raster);exports.Circle=i;
},{"./Raster":"Syvu"}],"mGqB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rect=void 0;var t=require("./Raster"),e=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),r=function(){return(r=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},o=function(t){function o(e){var r=t.call(this,e)||this;return r.width=e.width,r.height=e.height,r.rasterize(),r}return e(o,t),o.prototype.clone=function(){return new o(r(r({width:this.width,height:this.height},this.cloneGraphicOptions()),this.cloneRasterOptions()))},o.prototype.execute=function(t){this.color&&t.fillRect(0,0,this.width,this.height),this.strokeColor&&t.strokeRect(0,0,this.width,this.height)},o}(t.Raster);exports.Rect=o;
},{"./Raster":"Syvu"}],"jxBF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Polygon=void 0;var t=require("../Algebra"),n=require("./Raster"),e=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),o=function(){return(o=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},r=function(n){function r(t){var e=n.call(this,t)||this;return e.points=t.points,e.rasterize(),e}return e(r,n),Object.defineProperty(r.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t;var n=this.minPoint;this.width=this._points.reduce(function(t,n){return Math.max(n.x,t)},0)-n.x,this.height=this._points.reduce(function(t,n){return Math.max(n.y,t)},0)-n.y,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minPoint",{get:function(){var n=this._points.reduce(function(t,n){return Math.min(n.x,t)},1/0),e=this._points.reduce(function(t,n){return Math.min(n.y,t)},1/0);return(0,t.vec)(n,e)},enumerable:!0,configurable:!0}),r.prototype.clone=function(){return new r(o(o({points:this.points.map(function(t){return t.clone()})},this.cloneGraphicOptions()),this.cloneRasterOptions()))},r.prototype.execute=function(t){if(this.points&&this.points.length){t.beginPath();var n=this.minPoint.negate(),e=this.points[0].add(n);t.moveTo(e.x,e.y),this.points.forEach(function(e){t.lineTo(e.x+n.x,e.y+n.y)}),t.lineTo(e.x,e.y),t.closePath(),this.color&&t.fill(),this.strokeColor&&t.stroke()}},r}(n.Raster);exports.Polygon=r;
},{"../Algebra":"NGcQ","./Raster":"Syvu"}],"IhtB":[function(require,module,exports) {
"use strict";var t,i,o,s,e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Font=exports.Direction=exports.FontStyle=exports.BaseAlign=exports.TextAlign=exports.FontUnit=void 0,exports.FontUnit=t,function(t){t.Em="em",t.Rem="rem",t.Px="px",t.Pt="pt",t.Percent="%"}(t||(exports.FontUnit=t={})),exports.TextAlign=i,function(t){t.Left="left",t.Right="right",t.Center="center",t.Start="start",t.End="end"}(i||(exports.TextAlign=i={})),exports.BaseAlign=o,function(t){t.Top="top",t.Hanging="hanging",t.Middle="middle",t.Alphabetic="alphabetic",t.Ideographic="ideographic",t.Bottom="bottom"}(o||(exports.BaseAlign=o={})),exports.FontStyle=s,function(t){t.Normal="normal",t.Italic="italic",t.Oblique="oblique"}(s||(exports.FontStyle=s={})),exports.Direction=e,function(t){t.LeftToRight="ltr",t.RightToLeft="rtl"}(e||(exports.Direction=e={}));var n=function(){function n(n){var l,h,r,a,d,f,u,c,g,p,x;this.family="sans-serif",this.style=s.Normal,this.bold=!1,this.unit=t.Px,this.textAlign=i.Left,this.baseAlign=o.Alphabetic,this.direction=e.LeftToRight,this.size=10,this.shadow=null,n&&(this.family=null!==(l=n.family)&&void 0!==l?l:this.family,this.style=null!==(h=n.style)&&void 0!==h?h:this.style,this.bold=null!==(r=n.bold)&&void 0!==r?r:this.bold,this.size=null!==(a=n.size)&&void 0!==a?a:this.size,this.unit=null!==(d=n.unit)&&void 0!==d?d:this.unit,this.textAlign=null!==(f=n.textAlign)&&void 0!==f?f:this.textAlign,this.baseAlign=null!==(u=n.baseAlign)&&void 0!==u?u:this.baseAlign,this.direction=null!==(c=n.direction)&&void 0!==c?c:this.direction,n.shadow&&(this.shadow.blur=null!==(g=n.shadow.blur)&&void 0!==g?g:this.shadow.blur,this.shadow.offset=null!==(p=n.shadow.offset)&&void 0!==p?p:this.shadow.offset,this.shadow.color=null!==(x=n.shadow.color)&&void 0!==x?x:this.shadow.color))}return Object.defineProperty(n.prototype,"fontString",{get:function(){return this.style+" "+(this.bold?"bold":"")+" "+this.size+this.unit+" "+this.family},enumerable:!0,configurable:!0}),n.prototype.apply=function(t){t.textAlign=this.textAlign,t.textBaseline=this.baseAlign,t.font=this.fontString,t.direction=this.direction,this.shadow&&(t.shadowColor=this.shadow.color.toString(),t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offset.x,t.shadowOffsetY=this.shadow.offset.y)},n.prototype.clone=function(){return new n({size:this.size,unit:this.unit,family:this.family,style:this.style,bold:this.bold,textAlign:this.textAlign,baseAlign:this.baseAlign,direction:this.direction,shadow:this.shadow?{blur:this.shadow.blur,offset:this.shadow.offset,color:this.shadow.color}:null})},n}();exports.Font=n;
},{}],"fKxy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Text=void 0;var t=require("./Raster"),e=require("./Font"),i=require("../Util/DrawUtil"),r=require("../Drawing/Color"),o=require("../Algebra"),n=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),h=function(){return(h=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t){function s(i){var r,o=t.call(this,i)||this;return o.text=i.text,o.font=null!==(r=i.font)&&void 0!==r?r:new e.Font,o.flagDirty(),o}return n(s,t),s.prototype.clone=function(){return new s(h(h({text:this.text.slice(),font:this.font.clone()},this.cloneGraphicOptions()),this.cloneRasterOptions()))},Object.defineProperty(s.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,this.flagDirty()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"font",{get:function(){return this._font},set:function(t){this._font=t?this._createFontProxy(t):t,this.flagDirty()},enumerable:!0,configurable:!0}),s.prototype._createFontProxy=function(t){var e=this;return new Proxy(t,{set:function(t,i,r){return t[i]=r,e.flagDirty(),!0}})},Object.defineProperty(s.prototype,"_halfWidth",{get:function(){return Math.floor(this.width/2)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"_halfHeight",{get:function(){return Math.floor(this.height/2)},enumerable:!0,configurable:!0}),s.prototype._drawImage=function(t,e,i){this.dirty&&this.rasterize(),t.drawImage(this,e-this._halfWidth,i-this._halfHeight)},s.prototype._rotate=function(t){var e,i=null!==(e=this.origin)&&void 0!==e?e:(0,o.vec)(this.width/4,-this.height/16);t.translate(i.x,i.y),t.rotate(this.rotation),t.translate(-i.x,-i.y)},s.prototype._flip=function(t){this.flipHorizontal&&(t.translate(this.width/2/this.scale.x,0),t.scale(-1,1)),this.flipVertical&&(t.translate(0,-this.height/8/this.scale.y),t.scale(1,-1))},s.prototype._postDraw=function(t){this.showDebug&&t.drawDebugRect(-this._halfWidth,-this._halfHeight,this.width,this.height),t.restore()},s.prototype.execute=function(t){var e,o;if(this.text){null===(e=this.font)||void 0===e||e.apply(t);var n=t.measureText(this.text);this._bitmap.width=2*(n.width+2*this.padding),this._bitmap.height=2*(2*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent+this.padding)||16),this._applyRasterProperites(t),null===(o=this.font)||void 0===o||o.apply(t),this.color&&t.fillText(this.text,this.padding+this._halfWidth,this.padding+this._halfHeight),this.strokeColor&&t.strokeText(this.text,this.padding+this._halfWidth,this.padding+this._halfHeight),this.showDebug&&((0,i.line)(t,r.Color.Red,0,this._halfHeight,this.width,this._halfHeight,2),(0,i.line)(t,r.Color.Red,this._halfWidth,0,this._halfWidth,this.height,2))}},s}(t.Raster);exports.Text=s;
},{"./Raster":"Syvu","./Font":"IhtB","../Util/DrawUtil":"UgQh","../Drawing/Color":"p7Gh","../Algebra":"NGcQ"}],"rOBo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StateStack=void 0;var t=function(){function t(){this._states=[],this._currentState=this._getDefaultState()}return t.prototype._getDefaultState=function(){return{opacity:1,z:0}},t.prototype._cloneState=function(){return{opacity:this._currentState.opacity,z:this._currentState.z}},t.prototype.save=function(){this._states.push(this._currentState),this._currentState=this._cloneState()},t.prototype.restore=function(){this._currentState=this._states.pop()},Object.defineProperty(t.prototype,"current",{get:function(){return this._currentState},enumerable:!0,configurable:!0}),t}();exports.StateStack=t;
},{}],"bjvb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExcaliburGraphicsContext2DCanvas=void 0;var t=require("../../Drawing/Color"),e=require("./state-stack"),i=function(){function i(i){this._ctx=i,this.backgroundColor=t.Color.ExcaliburBlue,this._state=new e.StateStack,this.snapToPixel=!1}return Object.defineProperty(i.prototype,"width",{get:function(){return this._ctx.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._ctx.canvas.height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"opacity",{get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"z",{get:function(){return this._state.current.z},set:function(t){this._state.current.z=t},enumerable:!0,configurable:!0}),i.prototype.drawDebugRect=function(t,e,i,r){this._ctx.save(),this._ctx.strokeStyle="red",this._ctx.strokeRect(t,e,i,r),this._ctx.restore()},i.prototype.drawDebugLine=function(t,e){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle="red",this._ctx.moveTo(t.x,t.y),this._ctx.lineTo(e.x,e.y),this._ctx.lineWidth=2,this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()},i.prototype.drawImage=function(t,e,i,r,o,c,n,s,a){var h=this;this._ctx.globalAlpha=this.opacity;var u=[t.getSource(),e,i,r,o,c,n,s,a].filter(function(t){return void 0!==t}).map(function(t){return"number"==typeof t&&h.snapToPixel?~~t:t});this._ctx.drawImage.apply(this._ctx,u)},i.prototype.save=function(){this._ctx.save()},i.prototype.restore=function(){this._ctx.restore()},i.prototype.translate=function(t,e){this._ctx.translate(this.snapToPixel?~~t:t,this.snapToPixel?~~e:e)},i.prototype.rotate=function(t){this._ctx.rotate(t)},i.prototype.scale=function(t,e){this._ctx.scale(t,e)},i.prototype.clear=function(){this._ctx.clearRect(0,0,this.width,this.height),this._ctx.fillStyle=this.backgroundColor.toString(),this._ctx.fillRect(0,0,this.width,this.height)},i.prototype.flush=function(){},i}();exports.ExcaliburGraphicsContext2DCanvas=i;
},{"../../Drawing/Color":"p7Gh","./state-stack":"rOBo"}],"uPb3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Matrix=void 0;var a=function(){function a(){this.data=new Float32Array(16)}return a.ortho=function(t,d,i,s,h,n){var r=new a;return r.data[0]=2/(d-t),r.data[1]=0,r.data[2]=0,r.data[3]=0,r.data[4]=0,r.data[5]=2/(s-i),r.data[6]=0,r.data[7]=0,r.data[8]=0,r.data[9]=0,r.data[10]=-2/(n-h),r.data[11]=0,r.data[12]=-(d+t)/(d-t),r.data[13]=-(s+i)/(s-i),r.data[14]=-(n+h)/(n-h),r.data[15]=1,r},a.prototype.clone=function(){var t=new a;return t.data[0]=this.data[0],t.data[1]=this.data[1],t.data[2]=this.data[2],t.data[3]=this.data[3],t.data[4]=this.data[4],t.data[5]=this.data[5],t.data[6]=this.data[6],t.data[7]=this.data[7],t.data[8]=this.data[8],t.data[9]=this.data[9],t.data[10]=this.data[10],t.data[11]=this.data[11],t.data[12]=this.data[12],t.data[13]=this.data[13],t.data[14]=this.data[14],t.data[15]=this.data[15],t},a.identity=function(){var t=new a;return t.data[0]=1,t.data[1]=0,t.data[2]=0,t.data[3]=0,t.data[4]=0,t.data[5]=1,t.data[6]=0,t.data[7]=0,t.data[8]=0,t.data[9]=0,t.data[10]=1,t.data[11]=0,t.data[12]=0,t.data[13]=0,t.data[14]=0,t.data[15]=1,t},a.translation=function(t,d,i){void 0===i&&(i=0);var s=a.identity();return s.data[12]=t,s.data[13]=d,s.data[14]=i,s},a.scale=function(t,d){var i=a.identity();return i.data[0]=t,i.data[5]=d,i.data[10]=1,i.data[15]=1,i},a.rotation=function(t){var d=a.identity();return d.data[0]=Math.cos(t),d.data[4]=-Math.sin(t),d.data[1]=Math.sin(t),d.data[5]=Math.cos(t),d},a.prototype.multv=function(a){return[a[0]*this.data[0]+a[1]*this.data[4]+0*this.data[6]+1*this.data[12],a[0]*this.data[1]+a[1]*this.data[5]+0*this.data[9]+1*this.data[13]]},a.prototype.multm=function(t){var d=new a,i=this.data[0],s=this.data[1],h=this.data[2],n=this.data[3],r=this.data[4],e=this.data[5],o=this.data[6],u=this.data[7],c=this.data[8],p=this.data[9],v=this.data[10],f=this.data[11],y=this.data[12],l=this.data[13],M=this.data[14],w=this.data[15],x=t.data[0],m=t.data[1],_=t.data[2],b=t.data[3],j=t.data[4],A=t.data[5],F=t.data[6],O=t.data[7],P=t.data[8],g=t.data[9],k=t.data[10],q=t.data[11],z=t.data[12],B=t.data[13],C=t.data[14],D=t.data[15];return d.data[0]=i*x+r*m+c*_+y*b,d.data[1]=s*x+e*m+p*_+l*b,d.data[2]=h*x+o*m+v*_+M*b,d.data[3]=n*x+u*m+f*_+w*b,d.data[4]=i*j+r*A+c*F+y*O,d.data[5]=s*j+e*A+p*F+l*O,d.data[6]=h*j+o*A+v*F+M*O,d.data[7]=n*j+u*A+f*F+w*O,d.data[8]=i*P+r*g+c*k+y*q,d.data[9]=s*P+e*g+p*k+l*q,d.data[10]=h*P+o*g+v*k+M*q,d.data[11]=n*P+u*g+f*k+w*q,d.data[12]=i*z+r*B+c*C+y*D,d.data[13]=s*z+e*B+p*C+l*D,d.data[14]=h*z+o*B+v*C+M*D,d.data[15]=n*z+u*B+f*C+w*D,d},a.prototype.translate=function(a,t){var d=this.data[0],i=this.data[1],s=this.data[2],h=this.data[3],n=this.data[4],r=this.data[5],e=this.data[6],o=this.data[7],u=this.data[8],c=this.data[9],p=this.data[10],v=this.data[11],f=this.data[12],y=this.data[13],l=this.data[14],M=this.data[15];return this.data[12]=d*a+n*t+u+f,this.data[13]=i*a+r*t+c+y,this.data[14]=s*a+e*t+p+l,this.data[15]=h*a+o*t+v+M,this},a.prototype.rotate=function(a){var t=this.data[0],d=this.data[1],i=this.data[2],s=this.data[3],h=this.data[4],n=this.data[5],r=this.data[6],e=this.data[7],o=Math.sin(a),u=Math.cos(a);return this.data[0]=u*t+o*h,this.data[1]=u*d+o*n,this.data[2]=u*i+o*r,this.data[3]=u*s+o*e,this.data[4]=u*h-o*t,this.data[5]=u*n-o*d,this.data[6]=u*r-o*i,this.data[7]=u*e-o*s,this},a.prototype.scale=function(a,t){var d=this.data[0],i=this.data[1],s=this.data[2],h=this.data[3],n=this.data[4],r=this.data[5],e=this.data[6],o=this.data[7];return this.data[0]=d*a,this.data[1]=i*a,this.data[2]=s*a,this.data[3]=h*a,this.data[4]=n*t,this.data[5]=r*t,this.data[6]=e*t,this.data[7]=o*t,this},a}();exports.Matrix=a;
},{}],"ALYm":[function(require,module,exports) {
module.exports="#define GLSLIFY 1\nattribute vec4 a_position;\n\n// Opacity \nattribute float a_opacity;\nvarying float v_opacity;\n\n// UV coordinate\nattribute vec2 a_texcoord;\nvarying vec2 v_texcoord;\n\n// Texture number\nattribute lowp float a_textureIndex;\nvarying lowp float v_textureIndex;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n   // Set the vertex position using the ortho transform matrix\n   gl_Position = u_matrix * a_position;\n\n   // Pass through the Opacity to the fragment shader\n   v_opacity = a_opacity;\n   // Pass through the UV coord to the fragment shader\n   v_texcoord = a_texcoord;\n   // Pass through the texture number to the fragment shader\n   v_textureIndex = a_textureIndex;\n}";
},{}],"IjUI":[function(require,module,exports) {
module.exports="precision mediump float;\n#define GLSLIFY 1\n\n// UV coord\nvarying vec2 v_texcoord;\n\n// Texture index\nvarying lowp float v_textureIndex;\n\n// Opacity\nvarying float v_opacity;\n\nuniform sampler2D textures[%%count%%];\n\nvoid main() {\n   // In order to support the most efficient sprite batching, we have multiple\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\n   // that do not apply to a particular sprite.\n\n   // Error color\n   vec4 color = vec4(1.0, 0.0, 0.0, 1.0);\n\n   // Always at least 1 texture at 0\n   if (v_textureIndex <= .5) {\n      gl_FragColor = texture2D(textures[0], v_texcoord);\n      gl_FragColor.w = gl_FragColor.w * v_opacity;\n      %%texture_picker%%\n   } else {\n      gl_FragColor = color;\n   }\n}";
},{}],"EFHz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Shader=void 0;var t=r(require("./shaders/vertex.glsl")),e=r(require("./shaders/fragment.glsl"));function r(t){return t&&t.__esModule?t:{default:t}}var o=function(){function r(t){this.maxTextures=t,this._program=null,this._positionLocation=-1,this._textureIndexLocation=-1,this._texcoordLocation=-1,this._opacityLocation=-1,this._matrixUniform=null,this._texturesUniform=null}return r.prototype._createProgram=function(t,e,r){var o=t.createProgram();if(null===o)throw Error("Could not create graphics shader program");if(t.attachShader(o,e),t.attachShader(o,r),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw Error("Could not link the program: ["+t.getProgramInfoLog(o)+"]");return o},r.prototype._compileShader=function(t,e,r){var o=t.createShader(r);if(null===o)throw Error("Could not build shader: ["+e+"]");if(r===t.FRAGMENT_SHADER&&(e=this._transformFragmentSource(e)),t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw Error("Could not compile shader ["+t.getShaderInfoLog(o)+"]");return o},r.prototype._transformFragmentSource=function(t){for(var e=t.replace("%%count%%",this.maxTextures.toString()),r="",o=0;o<this.maxTextures;o++)r+="   } else if (v_textureIndex <= "+o+".5) {\n\n                gl_FragColor = texture2D(textures["+o+"], v_texcoord);\n\n                gl_FragColor.w = gl_FragColor.w * v_opacity;\n";return e=e.replace("%%texture_picker%%",r)},r.prototype.compile=function(r){var o=this._compileShader(r,t.default,r.VERTEX_SHADER),i=this._compileShader(r,e.default,r.FRAGMENT_SHADER),n=this._createProgram(r,o,i);return this._positionLocation=r.getAttribLocation(n,"a_position"),this._textureIndexLocation=r.getAttribLocation(n,"a_textureIndex"),this._texcoordLocation=r.getAttribLocation(n,"a_texcoord"),this._opacityLocation=r.getAttribLocation(n,"a_opacity"),this._matrixUniform=r.getUniformLocation(n,"u_matrix"),this._texturesUniform=r.getUniformLocation(n,"textures"),this._program=n},Object.defineProperty(r.prototype,"program",{get:function(){return this._program},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positionLocation",{get:function(){return this._positionLocation},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textureIndexLocation",{get:function(){return this._textureIndexLocation},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"texcoordLocation",{get:function(){return this._texcoordLocation},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"opacityLocation",{get:function(){return this._opacityLocation},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"matrixUniform",{get:function(){return this._matrixUniform},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"texturesUniform",{get:function(){return this._texturesUniform},enumerable:!0,configurable:!0}),r}();exports.Shader=o;
},{"./shaders/vertex.glsl":"ALYm","./shaders/fragment.glsl":"IjUI"}],"c6P6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MatrixStack=void 0;var r=require("../../Math/matrix"),t=function(){function t(){this._transforms=[],this._currentTransform=r.Matrix.identity()}return t.prototype.save=function(){this._transforms.push(this._currentTransform),this._currentTransform=this._currentTransform.clone()},t.prototype.restore=function(){this._currentTransform=this._transforms.pop()},t.prototype.translate=function(r,t){return this._currentTransform.translate(r,t)},t.prototype.rotate=function(r){return this._currentTransform.rotate(r)},t.prototype.scale=function(r,t){return this._currentTransform.scale(r,t)},Object.defineProperty(t.prototype,"transform",{get:function(){return this._currentTransform},set:function(r){this._currentTransform=r},enumerable:!0,configurable:!0}),t}();exports.MatrixStack=t;
},{"../../Math/matrix":"uPb3"}],"UdiZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Batch=void 0;var t=function(){function t(t,e,s){this.textureManager=t,this.maxDraws=e,this.maxTextures=s,this.textures=[],this.commands=[],this._graphicMap={}}return t.prototype.isFull=function(){return this.commands.length>=this.maxDraws||this.textures.length>=this.maxTextures},t.prototype.canAdd=function(){return!(this.commands.length>=this.maxDraws)&&this.textures.length<this.maxTextures},t.prototype._isCommandFull=function(){return this.commands.length>=this.maxDraws},t.prototype._isTextureFull=function(){return this.textures.length>=this.maxTextures},t.prototype._wouldAddTexture=function(t){return!this._graphicMap[t.image.id]},t.prototype.maybeAdd=function(t){return!(this._isCommandFull()||this._isTextureFull()&&this._wouldAddTexture(t))&&(this.add(t),!0)},t.prototype.add=function(t){this._graphicMap[t.image.id]||(this._graphicMap[t.image.id]=t.image,this.textureManager.hasWebGLTexture(t.image)&&this.textures.push(this.textureManager.getWebGLTexture(t.image))),this.commands.push(t)},t.prototype.bindTextures=function(t){for(var e=0;e<this.maxTextures;e++)t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,this.textures[e]||this.textures[0])},t.prototype._dispose=function(){this.clear()},t.prototype.clear=function(){this.commands.length=0,this.textures.length=0,this._graphicMap={}},t}();exports.Batch=t;
},{}],"mzdc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawRectCommand=exports.DrawImageCommand=void 0;var t=function(){function t(t,i,h,s,e,d,o,n,g){this.opacity=1,this.z=0,this.width=0,this.height=0,this.dest=[0,0],this.view=[0,0,0,0],this._geom=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.init(t,i,h,s,e,d,o,n,g)}return t.prototype.init=function(t,i,h,s,e,d,o,n,g){this.image=t,this.width=(null==t?void 0:t.width)||s||0,this.height=(null==t?void 0:t.height)||e||0,this.view=[0,0,null!=s?s:null==t?void 0:t.width,null!=e?e:null==t?void 0:t.height],this.dest=[i,h],void 0!==d&&void 0!==o&&void 0!==n&&void 0!==g&&(this.view=[i,h,null!=s?s:null==t?void 0:t.width,null!=e?e:null==t?void 0:t.height],this.dest=[d,o],this.width=n,this.height=g);var r=0;return this._geom[r++]=[this.dest[0],this.dest[1]],this._geom[r++]=[this.dest[0],this.dest[1]+this.height],this._geom[r++]=[this.dest[0]+this.width,this.dest[1]],this._geom[r++]=[this.dest[0]+this.width,this.dest[1]],this._geom[r++]=[this.dest[0],this.dest[1]+this.height],this._geom[r++]=[this.dest[0]+this.width,this.dest[1]+this.height],this},t.prototype._dispose=function(){this.image=null,this.width=0,this.height=0,this.view=[0,0,0,0],this.dest=[0,0];var t=0;this._geom[t++]=[this.dest[0],this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]],this._geom[t++]=[this.dest[0],this.dest[1]+this.height],this._geom[t++]=[this.dest[0]+this.width,this.dest[1]+this.height]},t.prototype.applyTransform=function(t,i,h){if(t)for(var s=0;s<this._geom.length;s++)this._geom[s]=t.multv(this._geom[s]);this.opacity=i,this.z=h},Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geom},enumerable:!0,configurable:!0}),t}();exports.DrawImageCommand=t;var i=function(){return function(t,i,h,s){this.dest=[0,0],this.width=0,this.height=0,this.dest=[t,i],this.width=h,this.height=s}}();exports.DrawRectCommand=i;
},{}],"Vikr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextureManager=void 0;var e=require("../Raster"),t=require("./webgl-util"),r=function(){function r(e){this._graphicTexture={},this._exgl=e,this._potCanvas=document.createElement("canvas"),this._potCtx=this._potCanvas.getContext("2d")}return r.prototype.hasWebGLTexture=function(e){return!!this._graphicTexture[e.id]},r.prototype.getWebGLTexture=function(e){return this._graphicTexture[e.id]},r.prototype.updateFromGraphic=function(t){var r,i=this._exgl.__gl;if(!(t.width<=0||t.height<=0))if(this.hasWebGLTexture(t)){if(t instanceof e.Raster&&t._flagTextureDirty){t._flagTextureDirty=!1,i.bindTexture(i.TEXTURE_2D,t.__glTexture);var a=this._ensurePowerOfTwoImage(t.getSource());i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,a)}}else{r=t.__glTexture=i.createTexture();var T=this._ensurePowerOfTwoImage(t.getSource());i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,T),this._graphicTexture[t.id]=r}},r.prototype._ensurePowerOfTwoImage=function(e){return(0,t.isPowerOfTwo)(e.width)&&(0,t.isPowerOfTwo)(e.height)||(this._potCanvas.width=(0,t.ensurePowerOfTwo)(e.width),this._potCanvas.height=(0,t.ensurePowerOfTwo)(e.height),this._potCtx.clearRect(0,0,this._potCanvas.width,this._potCanvas.height),this._potCtx.imageSmoothingEnabled=!1,this._potCtx.drawImage(e,0,0,e.width,e.height),e=this._potCanvas),e},r}();exports.TextureManager=r;
},{"../Raster":"Syvu","./webgl-util":"MzmB"}],"h0yN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pool=void 0;var o=function(){function o(o,t){void 0===t&&(t=100),this.objectFactory=o,this._pool=[],this._freeIds=[],this.allocate(t)}return o.prototype.allocate=function(o){for(var t=this._pool.length;t<o;t++)this._pool.push(this.objectFactory()),this._pool[t]._poolId=t,this._pool[t]._free=!0,this._freeIds.push(t)},o.prototype.get=function(){0===this._freeIds.length&&(console.log("Pool empty: allocating more doubling"),this.allocate(this._pool.length));var o=this._freeIds.pop(),t=this._pool[o];if(t._poolId!==o)throw new Error("pool corrupt");return t._free=!1,t},o.prototype.free=function(o){o._dispose(),o._free=!0,this._freeIds.push(o._poolId)},o}();exports.Pool=o;
},{}],"xRtj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExcaliburGraphicsContextWebGL=void 0;var t=require("../../Math/matrix"),e=require("./shader"),r=require("./matrix-stack"),i=require("./batch"),a=require("./command"),s=require("./texture-manager"),o=require("../../Drawing/Color"),n=require("./webgl-util"),h=require("./state-stack"),c=require("./pool"),u=require("../../Util/Log"),_=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(){function l(t){this._textureManager=new s.TextureManager(this),this._stack=new r.MatrixStack,this._state=new h.StateStack,this._vertBuffer=null,this._maxDrawingsPerBatch=2e3,this._shaderTextureMax=8,this._batches=[],this.snapToPixel=!0,this.backgroundColor=o.Color.ExcaliburBlue,this._diag={images:0,batches:0,uniqueTextures:0,maxTexturePerDraw:this._shaderTextureMax},this.__gl=t;this._verts=new Float32Array(42*this._maxDrawingsPerBatch),this._init()}return Object.defineProperty(l.prototype,"opacity",{get:function(){return this._state.current.opacity},set:function(t){this._state.current.opacity=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"z",{get:function(){return this._state.current.z},set:function(t){this._state.current.z=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"width",{get:function(){return this.__gl.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"height",{get:function(){return this.__gl.canvas.height},enumerable:!0,configurable:!0}),l.prototype._init=function(){var r=this,s=this.__gl;this._shaderTextureMax=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),console.log("Max textures["+this._shaderTextureMax+"]"),this._commandPool=new c.Pool(function(){return new a.DrawImageCommand},this._maxDrawingsPerBatch),this._batchPool=new c.Pool(function(){return new i.Batch(r._textureManager,r._maxDrawingsPerBatch,r._shaderTextureMax)});var o=this._shader=new e.Shader(this._shaderTextureMax),n=o.compile(s);s.viewport(0,0,s.canvas.width,s.canvas.height),s.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.useProgram(n),this._ortho=t.Matrix.ortho(0,s.canvas.width,s.canvas.height,0,400,-400),this._vertBuffer=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,this._vertBuffer),s.bufferData(s.ARRAY_BUFFER,this._verts,s.DYNAMIC_DRAW);s.vertexAttribPointer(o.positionLocation,3,s.FLOAT,!1,28,0),s.enableVertexAttribArray(o.positionLocation),s.vertexAttribPointer(o.texcoordLocation,2,s.FLOAT,!1,28,12),s.enableVertexAttribArray(o.texcoordLocation),s.vertexAttribPointer(o.textureIndexLocation,1,s.FLOAT,!1,28,20),s.enableVertexAttribArray(o.textureIndexLocation),s.vertexAttribPointer(o.opacityLocation,1,s.FLOAT,!1,28,24),s.enableVertexAttribArray(o.opacityLocation),s.uniformMatrix4fv(o.matrixUniform,!1,this._ortho.data);for(var h=[],u=0;u<this._shaderTextureMax;u++)h[u]=u;s.uniform1iv(o.texturesUniform,h);var _=this._ortho;s.uniformMatrix4fv(this._shader.matrixUniform,!1,_.data)},l.prototype.drawImage=function(t,e,r,i,a,s,o,n,h){if(!t)return u.Logger.getInstance().warn("Cannot draw a null or undefined image"),void(console.trace&&console.trace());this._textureManager.updateFromGraphic(t);var c=this._commandPool.get().init(t,e,r,i,a,s,o,n,h);if(c.applyTransform(this._stack.transform,this._state.current.opacity,this._state.current.z),0===this._batches.length&&this._batches.push(this._batchPool.get()),!this._batches[this._batches.length-1].maybeAdd(c)){var _=this._batchPool.get();_.add(c),this._batches.push(_)}},l.prototype._updateVertexBufferData=function(t){var e,r,i=0,a=0,s=0,o=0,h=0,c=0,u=0,l=0,g=0,f=0;try{for(var v=_(t.commands),d=v.next();!d.done;d=v.next()){var x=d.value;a=x.dest[0],s=x.dest[1],o=x.view[0],h=x.view[1],c=x.view[2],u=x.view[3],l=(0,n.ensurePowerOfTwo)(x.image.getSource().width||x.width),g=(0,n.ensurePowerOfTwo)(x.image.getSource().height||x.height),this._textureManager.hasWebGLTexture(x.image)&&(f=t.textures.indexOf(this._textureManager.getWebGLTexture(x.image))),this.snapToPixel&&(a=~~a,s=~~s);var b=o/l,p=h/g,m=(o+c)/l,y=(h+u)/g;this._verts[i++]=x.geometry[0][0],this._verts[i++]=x.geometry[0][1],this._verts[i++]=x.z,this._verts[i++]=b,this._verts[i++]=p,this._verts[i++]=f,this._verts[i++]=x.opacity,this._verts[i++]=x.geometry[1][0],this._verts[i++]=x.geometry[1][1],this._verts[i++]=x.z,this._verts[i++]=b,this._verts[i++]=y,this._verts[i++]=f,this._verts[i++]=x.opacity,this._verts[i++]=x.geometry[2][0],this._verts[i++]=x.geometry[2][1],this._verts[i++]=x.z,this._verts[i++]=m,this._verts[i++]=p,this._verts[i++]=f,this._verts[i++]=x.opacity,this._verts[i++]=x.geometry[3][0],this._verts[i++]=x.geometry[3][1],this._verts[i++]=x.z,this._verts[i++]=m,this._verts[i++]=p,this._verts[i++]=f,this._verts[i++]=x.opacity,this._verts[i++]=x.geometry[4][0],this._verts[i++]=x.geometry[4][1],this._verts[i++]=x.z,this._verts[i++]=b,this._verts[i++]=y,this._verts[i++]=f,this._verts[i++]=x.opacity,this._verts[i++]=x.geometry[5][0],this._verts[i++]=x.geometry[5][1],this._verts[i++]=x.z,this._verts[i++]=m,this._verts[i++]=y,this._verts[i++]=f,this._verts[i++]=x.opacity}}catch(w){e={error:w}}finally{try{d&&!d.done&&(r=v.return)&&r.call(v)}finally{if(e)throw e.error}}},Object.defineProperty(l.prototype,"diag",{get:function(){return this._diag},enumerable:!0,configurable:!0}),l.prototype.save=function(){this._stack.save(),this._state.save()},l.prototype.restore=function(){this._stack.restore(),this._state.restore()},l.prototype.translate=function(t,e){this._stack.translate(t,e)},l.prototype.rotate=function(t){this._stack.rotate(t)},l.prototype.scale=function(t,e){this._stack.scale(t,e)},l.prototype.transform=function(t){this._stack.transform=t},l.prototype.clear=function(){var t=this.__gl;t.clearColor(this.backgroundColor.r/255,this.backgroundColor.g/255,this.backgroundColor.b/255,this.backgroundColor.a),t.clear(t.COLOR_BUFFER_BIT)},l.prototype.flush=function(){var t,e,r,i,a=this.__gl;this._diag.images=0,this._diag.uniqueTextures=0,this._diag.batches=0,this._diag.maxTexturePerDraw=this._shaderTextureMax,this.clear();try{for(var s=_(this._batches),o=s.next();!o.done;o=s.next()){var n=o.value,h=6*n.commands.length;this._updateVertexBufferData(n),a.bindBuffer(a.ARRAY_BUFFER,this._vertBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this._verts),n.bindTextures(a),a.drawArrays(a.TRIANGLES,0,h),this._diag.images+=n.commands.length,this._diag.uniqueTextures+=n.textures.length;try{for(var c=(r=void 0,_(n.commands)),u=c.next();!u.done;u=c.next()){var l=u.value;this._commandPool.free(l)}}catch(g){r={error:g}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}this._batchPool.free(n)}}catch(f){t={error:f}}finally{try{o&&!o.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this._diag.batches=this._batches.length,this._batches.length=0},l.prototype.drawDebugRect=function(t,e,r,i){},l.prototype.drawDebugLine=function(t,e){},l}();exports.ExcaliburGraphicsContextWebGL=l;
},{"../../Math/matrix":"uPb3","./shader":"EFHz","./matrix-stack":"c6P6","./batch":"UdiZ","./command":"mzdc","./texture-manager":"Vikr","../../Drawing/Color":"p7Gh","./webgl-util":"MzmB","./state-stack":"rOBo","./pool":"h0yN","../../Util/Log":"p1Gn"}],"qIYM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Graphic");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./Sprite");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./SpriteSheet");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var n=require("./GraphicsComponent");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}})});var u=require("./GraphicsGroup");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});var o=require("./RawImage");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}})});var c=require("./Animation");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return c[e]}})});var f=require("./Raster");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return f[e]}})});var a=require("./Circle");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return a[e]}})});var i=require("./Rect");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return i[e]}})});var s=require("./Polygon");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return s[e]}})});var l=require("./Text");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return l[e]}})});var b=require("./Font");Object.keys(b).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return b[e]}})});var d=require("./Context/ExcaliburGraphicsContext2DCanvas");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return d[e]}})});var p=require("./Context/ExcaliburGraphicsContextWebGL");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return p[e]}})});
},{"./Graphic":"OZee","./Sprite":"tEFe","./SpriteSheet":"hmKU","./GraphicsComponent":"jeAN","./GraphicsGroup":"SRl6","./RawImage":"XkNM","./Animation":"zu78","./Raster":"Syvu","./Circle":"vFQJ","./Rect":"mGqB","./Polygon":"jxBF","./Text":"fKxy","./Font":"IhtB","./Context/ExcaliburGraphicsContext2DCanvas":"bjvb","./Context/ExcaliburGraphicsContextWebGL":"xRtj"}],"QP5n":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cell=exports.CellImpl=exports.TileSprite=exports.TileMap=exports.TileMapImpl=void 0;var t=require("./Collision/BoundingBox"),e=require("./Drawing/Color"),r=require("./Class"),i=require("./Algebra"),o=require("./Util/Log"),n=p(require("./Events")),s=require("./Configurable"),h=require("./Graphics"),l=require("./Entity"),a=require("./Transform");function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}function p(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var n=i?Object.getOwnPropertyDescriptor(t,o):null;n&&(n.get||n.set)?Object.defineProperty(r,o,n):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var f=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),d=function(t){function r(e,r,i,n,s,h){var l=t.call(this)||this;if(l._collidingX=-1,l._collidingY=-1,l._onScreenXStart=0,l._onScreenXEnd=9999,l._onScreenYStart=0,l._onScreenYEnd=9999,l._spriteSheets={},l.logger=o.Logger.getInstance(),l.data=[],e&&"object"===u(e)){var a=e;e=a.x,r=a.y,i=a.cellWidth,n=a.cellHeight,s=a.rows,h=a.cols}l.x=e,l.y=r,l.cellWidth=i,l.cellHeight=n,l.rows=s,l.cols=h,l.data=new Array(s*h);for(var c=function(t){for(var o=function(o){var s;s=new v(t*i+e,o*n+r,i,n,t+o*h,!1,[],l),l.data[t+o*h]=s},a=0;a<s;a++)o(a)},p=0;p<h;p++)c(p);return l}return f(r,t),r.prototype.on=function(e,r){t.prototype.on.call(this,e,r)},r.prototype.registerSpriteSheet=function(t,e){this._spriteSheets[t]=e},r.prototype.collides=function(t){var e=t.pos.x+t.width,r=t.pos.y+t.height,o=t.body.collider.bounds,n=[];if(t.width<=0||t.height<=0)return null;for(var s=o.left;s<=e;s+=Math.min(t.width/2,this.cellWidth/2))for(var h=o.top;h<=r;h+=Math.min(t.height/2,this.cellHeight/2)){var l=this.getCellByPoint(s,h);if(l&&l.solid){var a=o.intersect(l.bounds),c=t.center.sub(l.center);a&&a.dot(c)>0&&n.push(a)}}return 0===n.length?null:n.reduce(function(t,e){var r=t.x,o=t.y;return Math.abs(t.x)<Math.abs(e.x)&&(r=e.x),Math.abs(t.y)<Math.abs(e.y)&&(o=e.y),new i.Vector(r,o)})},r.prototype.getCellByIndex=function(t){return this.data[t]},r.prototype.getCell=function(t,e){return t<0||e<0||t>=this.cols||e>=this.rows?null:this.data[t+e*this.cols]},r.prototype.getCellsOnScreen=function(){for(var t=this._onScreenXStart,e=Math.min(this._onScreenXEnd,this.cols),r=this._onScreenYStart,i=Math.min(this._onScreenYEnd,this.rows),o=[];t<e;t++){for(;r<i;r++){var n=this.getCell(t,r);n&&n.graphics.current&&o.push(n)}r=this._onScreenYStart}return o},r.prototype.getCellByPoint=function(t,e){t=Math.floor((t-this.x)/this.cellWidth),e=Math.floor((e-this.y)/this.cellHeight);var r=this.getCell(t,e);return t>=0&&e>=0&&t<this.cols&&e<this.rows&&r?r:null},r.prototype.update=function(t,e){this.emit("preupdate",new n.PreUpdateEvent(t,e,this));var r=t.screenToWorldCoordinates(new i.Vector(0,0)),o=t.screenToWorldCoordinates(new i.Vector(t.canvas.clientWidth,t.canvas.clientHeight));this._onScreenXStart=Math.max(Math.floor((r.x-this.x)/this.cellWidth)-2,0),this._onScreenYStart=Math.max(Math.floor((r.y-this.y)/this.cellHeight)-2,0),this._onScreenXEnd=Math.max(Math.floor((o.x-this.x)/this.cellWidth)+2,0),this._onScreenYEnd=Math.max(Math.floor((o.y-this.y)/this.cellHeight)+2,0),this.emit("postupdate",new n.PostUpdateEvent(t,e,this))},r.prototype._newdraw=function(t,e){var r;t.save(),t.translate(this.x,this.y);for(var i=this._onScreenXStart,o=Math.min(this._onScreenXEnd,this.cols),n=this._onScreenYStart,s=Math.min(this._onScreenYEnd,this.rows);i<o;i++){for(;n<s;n++)null===(r=this.getCell(i,n))||void 0===r||r.graphics.draw(t,i*this.cellWidth,n*this.cellHeight);n=this._onScreenYStart}t.restore()},r.prototype.draw=function(t,e){this.emit("predraw",new n.PreDrawEvent(t,e,this)),t.save(),t.translate(this.x,this.y);for(var r,i,o,s=this._onScreenXStart,h=Math.min(this._onScreenXEnd,this.cols),l=this._onScreenYStart,a=Math.min(this._onScreenYEnd,this.rows);s<h;s++){for(;l<a;l++)for(i=0,o=(r=this.getCell(s,l).sprites.filter(function(t){return t.spriteId>-1})).length;i<o;i++){var c=this._spriteSheets[r[i].spriteSheetKey];if(c){var p=c.getSprite(r[i].spriteId);p?p.draw(t,s*this.cellWidth,l*this.cellHeight):this.logger.warn("Sprite does not exist for id",r[i].spriteId,"in sprite sheet",r[i].spriteSheetKey,p,c)}else this.logger.warn("Sprite sheet",r[i].spriteSheetKey,"does not exist",c)}l=this._onScreenYStart}t.restore(),this.emit("postdraw",new n.PostDrawEvent(t,e,this))},r.prototype.debugDraw=function(t){var r=this.cols*this.cellWidth,i=this.rows*this.cellHeight;t.save(),t.strokeStyle=e.Color.Red.toString();for(var o=0;o<this.cols+1;o++)t.beginPath(),t.moveTo(this.x+o*this.cellWidth,this.y),t.lineTo(this.x+o*this.cellWidth,this.y+i),t.stroke();for(var n=0;n<this.rows+1;n++)t.beginPath(),t.moveTo(this.x,this.y+n*this.cellHeight),t.lineTo(this.x+r,this.y+n*this.cellHeight),t.stroke();var s=e.Color.Red;s.a=.3,this.data.filter(function(t){return t.solid}).forEach(function(e){t.fillStyle=s.toString(),t.fillRect(e.x,e.y,e.width,e.height)}),this._collidingY>-1&&this._collidingX>-1&&(t.fillStyle=e.Color.Cyan.toString(),t.fillRect(this.x+this._collidingX*this.cellWidth,this.y+this._collidingY*this.cellHeight,this.cellWidth,this.cellHeight)),t.restore()},r}(r.Class);exports.TileMapImpl=d;var y=function(t){function e(e,r,i,o,n,s){return t.call(this,e,r,i,o,n,s)||this}return f(e,t),e}((0,s.Configurable)(d));exports.TileMap=y;var g=function(){return function(t,e){this.spriteSheetKey=t,this.spriteId=e}}();exports.TileSprite=g;var S=function(e){function r(r,o,n,s,l,c,p,f){void 0===c&&(c=!1),void 0===p&&(p=[]);var d=e.call(this)||this;if(d.solid=!1,d.sprites=[],d.graphics=new h.GraphicsComponent,r&&"object"===u(r)){var y=r;r=y.x,o=y.y,n=y.width,s=y.height,l=y.index,c=y.solid,p=y.sprites,y.tileMap}return d.x=r,d.y=o,d.width=n,d.height=s,d.index=l,d.solid=c,d.sprites=p,d.addComponent(d.graphics),d.transform=new a.TransformComponent,d.transform.pos=(0,i.vec)(d.x,d.y),d.addComponent(d.transform),d._bounds=new t.BoundingBox(d.x,d.y,d.x+d.width,d.y+d.height),d}return f(r,e),Object.defineProperty(r.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"center",{get:function(){return new i.Vector(this.x+this.width/2,this.y+this.height/2)},enumerable:!0,configurable:!0}),r.prototype.pushSprite=function(t){this.sprites.push(t)},r.prototype.removeSprite=function(t){var e;(e=this.sprites.indexOf(t))>-1&&this.sprites.splice(e,1)},r.prototype.clearSprites=function(){this.sprites.length=0},r}(l.Entity);exports.CellImpl=S;var v=function(t){function e(e,r,i,o,n,s,h,l){return t.call(this,e,r,i,o,n,s,h,l)||this}return f(e,t),e}((0,s.Configurable)(S));exports.Cell=v;
},{"./Collision/BoundingBox":"oyna","./Drawing/Color":"p7Gh","./Class":"yTUi","./Algebra":"NGcQ","./Util/Log":"p1Gn","./Events":"XySq","./Configurable":"A4Kj","./Graphics":"qIYM","./Entity":"EGNO","./Transform":"hPn9"}],"hSwP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AudioContextFactory=void 0;var t=function(){function t(){}return t.create=function(){return this._INSTANCE||(window.AudioContext||window.webkitAudioContext)&&(this._INSTANCE=new window.AudioContext),this._INSTANCE},t._INSTANCE=null,t}();exports.AudioContextFactory=t;
},{}],"PqN8":[function(require,module,exports) {
"use strict";var t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Promise=exports.PromiseState=void 0,exports.PromiseState=t,function(t){t[t.Resolved=0]="Resolved",t[t.Rejected=1]="Rejected",t[t.Pending=2]="Pending"}(t||(exports.PromiseState=t={}));var e=function(){function e(){this._state=t.Pending,this._successCallbacks=[],this._rejectCallback=function(){}}return e.resolve=function(t){return(new e).resolve(t)},e.reject=function(t){return(new e).reject(t)},e.join=function(){var t=[];if(arguments.length>0&&!Array.isArray(arguments[0]))for(var r=0;r<arguments.length;r++)t[r-0]=arguments[r];else 1===arguments.length&&Array.isArray(arguments[0])&&(t=arguments[0]);var s=new e;if(!t||!t.length)return s.resolve();var n=t.length,i=0,o=0,a=[];return t.forEach(function(t){t.then(function(){(i+=1)===n?s.resolve():i+o+a.length===n&&s.reject(a)},function(){i+(o+=1)+a.length===n&&s.reject(a)}).error(function(t){a.push(t),a.length+i+o===n&&s.reject(a)})}),s},e.prototype.then=function(e,r){if(e&&(this._successCallbacks.push(e),this.state()===t.Resolved))try{e.call(this,this._value)}catch(s){this._handleError(s)}if(r&&(this._rejectCallback=r,this.state()===t.Rejected))try{r.call(this,this._value)}catch(s){this._handleError(s)}return this},e.prototype.error=function(t){return t&&(this._errorCallback=t),this},e.prototype.resolve=function(e){var r=this;if(this._state!==t.Pending)throw new Error("Cannot resolve a promise that is not in a pending state!");this._value=e;try{this._state=t.Resolved,this._successCallbacks.forEach(function(t){t.call(r,r._value)})}catch(s){this._handleError(s)}return this},e.prototype.reject=function(e){if(this._state!==t.Pending)throw new Error("Cannot reject a promise that is not in a pending state!");this._value=e;try{this._state=t.Rejected,this._rejectCallback.call(this,this._value)}catch(r){this._handleError(r)}return this},e.prototype.state=function(){return this._state},e.prototype._handleError=function(t){if(!this._errorCallback)throw t;this._errorCallback.call(this,t)},e}();exports.Promise=e;
},{}],"KQch":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebAudio=void 0;var e=require("../Resources/Sound/AudioContext"),t=require("../Promises"),n=require("./Log");function o(e){return!!e.playbackState}var r=function(){function r(){}return r.unlock=function(){var u=new t.Promise;if(r._unlocked||!e.AudioContextFactory.create())return u.resolve(!0);var i=setTimeout(function(){n.Logger.getInstance().warn("Excalibur was unable to unlock the audio context, audio probably will not play in this browser."),u.resolve()},200),c=e.AudioContextFactory.create();return c.resume().then(function(){var e=c.createBuffer(1,1,22050),n=c.createBufferSource(),a=!1;n.buffer=e,n.connect(c.destination),n.onended=function(){return a=!0},n.noteOn?n.noteOn(0):n.start(0),setTimeout(function(){o(n)?n.playbackState!==n.PLAYING_STATE&&n.playbackState!==n.FINISHED_STATE||(r._unlocked=!0):(c.currentTime>0||a)&&(r._unlocked=!0)},0),clearTimeout(i),u.state()===t.PromiseState.Pending&&u.resolve()},function(){u.state()===t.PromiseState.Pending&&u.reject(!1)}),u},r.isUnlocked=function(){return this._unlocked},r._unlocked=!1,r}();exports.WebAudio=r;
},{"../Resources/Sound/AudioContext":"hSwP","../Promises":"PqN8","./Log":"p1Gn"}],"r7m0":[function(require,module,exports) {
module.exports="/ludum-46/Loader.logo.647a87f4.png";
},{}],"R3Xd":[function(require,module,exports) {

},{}],"wtst":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Canvas=void 0;var t=require("./Raster"),r=function(){var t=function(r,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(r,n)};return function(r,n){function o(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),n=function(){return(n=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++)for(var e in r=arguments[n])Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t}).apply(this,arguments)},o=function(t){function o(r){var n=t.call(this,r)||this;return n._options=r,n}return r(o,t),o.prototype.clone=function(){return new o(n(n(n({},this._options),this.cloneGraphicOptions()),this.cloneRasterOptions()))},o.prototype.execute=function(t){this._options.drawHandler(t,0),this.flagDirty()},o}(t.Raster);exports.Canvas=o;
},{"./Raster":"Syvu"}],"jUb1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Loader=void 0;var t=require("./Drawing/Color"),e=require("./Util/WebAudio"),n=require("./Util/Log"),o=require("./Class"),i=c(require("./Util/DrawUtil")),r=u(require("./Loader.logo.png")),a=u(require("./Loader.css")),s=require("./Graphics/Canvas");function u(t){return t&&t.__esModule?t:{default:t}}function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=o?Object.getOwnPropertyDescriptor(t,i):null;r&&(r.get||r.set)?Object.defineProperty(n,i,r):n[i]=t[i]}return n.default=t,e&&e.set(t,n),n}var h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=function(o){function u(t){var e=o.call(this)||this;return e.canvas=new s.Canvas({drawHandler:e.draw.bind(e)}),e._resourceList=[],e._index=0,e._playButtonShown=!1,e._resourceCount=0,e._numLoaded=0,e._progressCounts={},e._totalCounts={},e.logo=r.default,e.logoWidth=468,e.logoHeight=118,e.backgroundColor="#176BAA",e.suppressPlayButton=!1,e._playButtonStyles=a.default.toString(),e.playButtonText="Play game",e.startButtonFactory=function(){var t=document.createElement("button");return t.id="excalibur-play",t.textContent=e.playButtonText,t.style.display="none",t},e.getData=function(){},e.setData=function(){},e.processData=function(){},e.onprogress=function(t){n.Logger.getInstance().debug("[ex.Loader] Loading "+(100*t.loaded/t.total).toFixed(0))},e.oncomplete=function(){},e.onerror=function(){},t&&e.addResources(t),e}return h(u,o),Object.defineProperty(u.prototype,"_image",{get:function(){return this._imageElement||(this._imageElement=new Image,this._imageElement.src=this.logo),this._imageElement},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_playButton",{get:function(){return this._playButtonRootElement||(this._playButtonRootElement=document.createElement("div"),this._playButtonRootElement.style.position="absolute",document.body.appendChild(this._playButtonRootElement)),this._styleBlock||(this._styleBlock=document.createElement("style"),this._styleBlock.textContent=this._playButtonStyles,document.head.appendChild(this._styleBlock)),this._playButtonElement||(this._playButtonElement=this.startButtonFactory(),this._playButtonRootElement.appendChild(this._playButtonElement)),this._playButtonElement},enumerable:!0,configurable:!0}),u.prototype.wireEngine=function(t){this._engine=t,this.canvas.width=this._engine.canvas.width,this.canvas.height=this._engine.canvas.height},u.prototype.addResource=function(t){var e=this._index++;this._resourceList.push(t),this._progressCounts[e]=0,this._totalCounts[e]=1,this._resourceCount++},u.prototype.addResources=function(t){for(var e=0,n=t.length;e<n;e++)this.addResource(t[e])},u.prototype.isLoaded=function(){return this._numLoaded===this._resourceCount},u.prototype.showPlayButton=function(){var t=this;return this.suppressPlayButton?Promise.resolve():(this._playButtonShown=!0,this._playButton.style.display="block",new Promise(function(e){t._playButton.addEventListener("click",function(){return e()}),t._playButton.addEventListener("touchend",function(){return e()}),t._playButton.addEventListener("pointerup",function(){return e()})}))},u.prototype.hidePlayButton=function(){this._playButtonShown=!1,this._playButton.style.display="none"},u.prototype.load=function(){var t=this;return new Promise(function(n){var o=t;if(0!==t._resourceList.length){var i=new Array(t._resourceList.length),r=t._resourceList.length;t._resourceList.forEach(function(a,s){t._engine&&a.wireEngine(t._engine),a.onprogress=function(t){var e=t.total,n=t.loaded;i[s]={loaded:n/e*(100/r),total:100};var a=i.reduce(function(t,e){return{loaded:t.loaded+e.loaded,total:100}},{loaded:0,total:100});o.onprogress.call(o,a)},a.oncomplete=a.onerror=function(){o._numLoaded++,o._numLoaded===o._resourceCount&&setTimeout(function(){o.showPlayButton().then(function(){e.WebAudio.unlock().then(function(){o.hidePlayButton(),o.oncomplete.call(o),n()})})},200)}}),function t(e,n){e[n]&&e[n].load().then(function(){t(e,n+1)})}(t._resourceList,0)}else o.showPlayButton().then(function(){e.WebAudio.unlock().then(function(){o.hidePlayButton(),o.oncomplete.call(o),n()})})})},u.prototype.draw=function(e){var n=this._engine.canvasHeight/this._engine.pixelRatio,o=this._engine.canvasWidth/this._engine.pixelRatio;if(this._playButtonRootElement){var r=this._engine.canvas.offsetLeft,a=this._engine.canvas.offsetTop,s=this._playButton.clientWidth,u=this._playButton.clientHeight;this._playButtonRootElement.style.left=r+o/2-s/2+"px",this._playButtonRootElement.style.top=a+n/2-u/2+100+"px"}e.fillStyle=this.backgroundColor,e.fillRect(0,0,o,n);var l=n/2,c=Math.min(this.logoWidth,.75*o),h=o/2-c/2,p=Math.floor(c*(this.logoHeight/this.logoWidth)),d=this._engine.getAntialiasing();if(this._engine.setAntialiasing(!0),e.drawImage(this._image,0,0,this.logoWidth,this.logoHeight,h,l-p-20,c,p),this.suppressPlayButton||!this._playButtonShown){e.lineWidth=2,i.roundRect(e,h,l,c,20,10);var y=c*(this._numLoaded/this._resourceCount)-10;i.roundRect(e,h+5,l+5,y>10?y:10,10,5,null,t.Color.White),this._engine.setAntialiasing(d)}else this._engine.setAntialiasing(d)},u.prototype.update=function(t,e){},u}(o.Class);exports.Loader=p;
},{"./Drawing/Color":"p7Gh","./Util/WebAudio":"KQch","./Util/Log":"p1Gn","./Class":"yTUi","./Util/DrawUtil":"UgQh","./Loader.logo.png":"r7m0","./Loader.css":"R3Xd","./Graphics/Canvas":"wtst"}],"OWe5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Detector=void 0;var e=require("./Log"),t=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r={webgl:"WebGL",webaudio:"WebAudio",gamepadapi:"Gamepad API"},o=function(){function o(){this._features=null,this.failedTests=[],this._criticalTests={canvasSupport:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},arrayBufferSupport:function(){var e=new XMLHttpRequest;e.open("GET","/");try{e.responseType="arraybuffer"}catch(t){return!1}return"arraybuffer"===e.responseType},dataUrlSupport:function(){return 0===document.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")},objectUrlSupport:function(){return"URL"in window&&"revokeObjectURL"in URL&&"createObjectURL"in URL},rgbaSupport:function(){var e=document.createElement("a").style;return e.cssText="background-color:rgba(150,255,150,.5)",(""+e.backgroundColor).indexOf("rgba")>-1}},this._warningTest={webAudioSupport:function(){return!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext||window.oAudioContext)},webglSupport:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("webgl"))}},this._features=this._loadBrowserFeatures()}return o.prototype.getBrowserFeatures=function(){return null===this._features&&(this._features=this._loadBrowserFeatures()),this._features},o.prototype.logBrowserFeatures=function(){var e,o,n="%cSUPPORTED BROWSER FEATURES\n==========================%c\n",a=["font-weight: bold; color: navy","font-weight: normal; color: inherit"],i=this.getBrowserFeatures();try{for(var s=t(Object.keys(r)),u=s.next();!u.done;u=s.next()){var c=u.value;i[c]?(n+="(%câ%c)",a.push("font-weight: bold; color: green"),a.push("font-weight: normal; color: inherit")):(n+="(%câ%c)",a.push("font-weight: bold; color: red"),a.push("font-weight: normal; color: inherit")),n+=" "+r[c]+"\n"}}catch(l){e={error:l}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(e)throw e.error}}a.unshift(n),console.log.apply(console,a)},o.prototype._loadBrowserFeatures=function(){var e=this;return{canvas:e._criticalTests.canvasSupport(),arraybuffer:e._criticalTests.arrayBufferSupport(),dataurl:e._criticalTests.dataUrlSupport(),objecturl:e._criticalTests.objectUrlSupport(),rgba:e._criticalTests.rgbaSupport(),webaudio:e._warningTest.webAudioSupport(),webgl:e._warningTest.webglSupport(),gamepadapi:!!navigator.getGamepads}},o.prototype.test=function(){var t=!1;for(var r in this._criticalTests)this._criticalTests[r].call(this)||(this.failedTests.push(r),e.Logger.getInstance().error("Critical browser feature missing, Excalibur requires:",r),t=!0);if(t)return!1;for(var o in this._warningTest)this._warningTest[o]()||e.Logger.getInstance().warn("Warning browser feature missing, Excalibur will have reduced performance:",o);return!0},o}();exports.Detector=o;
},{"./Log":"p1Gn"}],"O7SY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MockedElement=exports.BinaryTreeNode=exports.SortedList=void 0;var t=function(){function t(t){this._getComparable=t}return t.prototype.find=function(t){return this._find(this._root,t)},t.prototype._find=function(t,e){return null!=t&&(this._getComparable.call(e)===t.getKey()?t.getData().indexOf(e)>-1:this._getComparable.call(e)<t.getKey()?this._find(t.getLeft(),e):this._find(t.getRight(),e))},t.prototype.get=function(t){return this._get(this._root,t)},t.prototype._get=function(t,e){return null==t?[]:e===t.getKey()?t.getData():e<t.getKey()?this._get(t.getLeft(),e):this._get(t.getRight(),e)},t.prototype.add=function(t){return null==this._root?(this._root=new e(this._getComparable.call(t),[t],null,null),!0):this._insert(this._root,t)},t.prototype._insert=function(t,i){return null!=t&&(this._getComparable.call(i)===t.getKey()?!(t.getData().indexOf(i)>-1)&&(t.getData().push(i),!0):this._getComparable.call(i)<t.getKey()?null==t.getLeft()?(t.setLeft(new e(this._getComparable.call(i),[i],null,null)),!0):this._insert(t.getLeft(),i):null==t.getRight()?(t.setRight(new e(this._getComparable.call(i),[i],null,null)),!0):this._insert(t.getRight(),i))},t.prototype.removeByComparable=function(t){this._root=this._remove(this._root,t)},t.prototype._remove=function(t,e){if(null==t)return null;if(this._getComparable.call(e)!==t.getKey())return this._getComparable.call(e)<t.getKey()?(t.setLeft(this._remove(t.getLeft(),e)),t):(t.setRight(this._remove(t.getRight(),e)),t);var i=t.getData().indexOf(e);if(i>-1){if(t.getData().splice(i,1),0===t.getData().length){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();var n=this._findMinNode(t.getRight());return t.setKey(n.getKey()),t.setData(n.getData()),t.setRight(this._cleanup(t.getRight(),n)),t}return t}return null},t.prototype._cleanup=function(t,e){var i=e.getKey();if(null==t)return null;if(i===t.getKey()){if(null==t.getLeft()&&null==t.getRight())return null;if(null==t.getLeft())return t.getRight();if(null==t.getRight())return t.getLeft();var n=this._findMinNode(t.getRight());return t.setKey(n.getKey()),t.setData(n.getData()),t.setRight(this._cleanup(t.getRight(),n)),t}return this._getComparable.call(e)<t.getKey()?(t.setLeft(this._cleanup(t.getLeft(),e)),t):(t.setRight(this._cleanup(t.getRight(),e)),t)},t.prototype._findMinNode=function(t){for(var e=t;null!=e.getLeft();)e=e.getLeft();return e},t.prototype.list=function(){var t=new Array;return this._list(this._root,t),t},t.prototype._list=function(t,e){null!=t&&(this._list(t.getLeft(),e),t.getData().forEach(function(t){e.push(t)}),this._list(t.getRight(),e))},t}();exports.SortedList=t;var e=function(){function t(t,e,i,n){this._key=t,this._data=e,this._left=i,this._right=n}return t.prototype.getKey=function(){return this._key},t.prototype.setKey=function(t){this._key=t},t.prototype.getData=function(){return this._data},t.prototype.setData=function(t){this._data=t},t.prototype.getLeft=function(){return this._left},t.prototype.setLeft=function(t){this._left=t},t.prototype.getRight=function(){return this._right},t.prototype.setRight=function(t){this._right=t},t}();exports.BinaryTreeNode=e;var i=function(){function t(t){this._key=0,this._key=t}return t.prototype.getTheKey=function(){return this._key},t.prototype.setKey=function(t){this._key=t},t}();exports.MockedElement=i;
},{}],"pAjs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Camera=exports.RadiusAroundActorStrategy=exports.ElasticToActorStrategy=exports.LockCameraToActorAxisStrategy=exports.LockCameraToActorStrategy=exports.Axis=exports.StrategyContainer=void 0;var t,e=require("./Util/EasingFunctions"),i=require("./Promises"),o=require("./Algebra"),r=require("./Util/Util"),n=require("./Events"),s=require("./Class"),a=require("./Collision/BoundingBox"),h=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=function(){function t(t){this.camera=t}return t.prototype.lockToActor=function(t){this.camera.addStrategy(new p(t))},t.prototype.lockToActorAxis=function(t,e){this.camera.addStrategy(new l(t,e))},t.prototype.elasticToActor=function(t,e,i){this.camera.addStrategy(new _(t,e,i))},t.prototype.radiusAroundActor=function(t,e){this.camera.addStrategy(new f(t,e))},t}();exports.StrategyContainer=u,exports.Axis=t,function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(t||(exports.Axis=t={}));var p=function(){return function(t){this.target=t,this.action=function(t,e,i,o){return t.center}}}();exports.LockCameraToActorStrategy=p;var l=function(){return function(e,i){var r=this;this.target=e,this.axis=i,this.action=function(e,i,n,s){var a=e.center,h=i.getFocus();return r.axis===t.X?new o.Vector(a.x,h.y):new o.Vector(h.x,a.y)}}}();exports.LockCameraToActorAxisStrategy=l;var _=function(){return function(t,e,i){var o=this;this.target=t,this.cameraElasticity=e,this.cameraFriction=i,this.action=function(t,e,i,r){var n=t.center,s=e.getFocus(),a=e.vel.clone(),h=n.sub(s).scale(o.cameraElasticity),c=(a=a.add(h)).scale(-1).scale(o.cameraFriction);return a=a.add(c),s=s.add(a)}}}();exports.ElasticToActorStrategy=_;var f=function(){return function(t,e){var i=this;this.target=t,this.radius=e,this.action=function(t,e,o,r){var n=t.center,s=e.getFocus(),a=n.sub(s),h=a.size;if(h>=i.radius){var c=h-i.radius;return s.add(a.normalize().scale(c))}return s}}}();exports.RadiusAroundActorStrategy=f;var g=function(t){function s(){var i=null!==t&&t.apply(this,arguments)||this;return i._cameraStrategies=[],i.strategy=new u(i),i.z=1,i.dz=0,i.az=0,i.rotation=0,i.rx=0,i.pos=o.Vector.Zero,i.vel=o.Vector.Zero,i.acc=o.Vector.Zero,i._cameraMoving=!1,i._currentLerpTime=0,i._lerpDuration=1e3,i._lerpStart=null,i._lerpEnd=null,i._isShaking=!1,i._shakeMagnitudeX=0,i._shakeMagnitudeY=0,i._shakeDuration=0,i._elapsedShakeTime=0,i._xShake=0,i._yShake=0,i._isZooming=!1,i._zoomStart=1,i._zoomEnd=1,i._currentZoomTime=0,i._zoomDuration=0,i._zoomEasing=e.EasingFunctions.EaseInOutCubic,i._easing=e.EasingFunctions.EaseInOutCubic,i._isInitialized=!1,i}return h(s,t),Object.defineProperty(s.prototype,"angularVelocity",{get:function(){return this.rx},set:function(t){this.rx=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"x",{get:function(){return this.pos.x},set:function(t){this._follow||this._cameraMoving||(this.pos.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"y",{get:function(){return this.pos.y},set:function(t){this._follow||this._cameraMoving||(this.pos.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dx",{get:function(){return this.vel.x},set:function(t){this.vel.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dy",{get:function(){return this.vel.y},set:function(t){this.vel.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"ax",{get:function(){return this.acc.x},set:function(t){this.acc.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"ay",{get:function(){return this.acc.y},set:function(t){this.acc.y=t},enumerable:!0,configurable:!0}),s.prototype.getFocus=function(){return this.pos},s.prototype.move=function(t,o,r){if(void 0===r&&(r=e.EasingFunctions.EaseInOutCubic),"function"!=typeof r)throw"Please specify an EasingFunction";return this._follow?(new i.Promise).reject(t):(this._lerpPromise&&this._lerpPromise.state()===i.PromiseState.Pending&&this._lerpPromise.resolve(t),this._lerpPromise=new i.Promise,this._lerpStart=this.getFocus().clone(),this._lerpDuration=o,this._lerpEnd=t,this._currentLerpTime=0,this._cameraMoving=!0,this._easing=r,this._lerpPromise)},s.prototype.shake=function(t,e,i){this._isShaking=!0,this._shakeMagnitudeX=t,this._shakeMagnitudeY=e,this._shakeDuration=i},s.prototype.zoom=function(t,o,r){return void 0===o&&(o=0),void 0===r&&(r=e.EasingFunctions.EaseInOutCubic),this._zoomPromise=new i.Promise,o?(this._isZooming=!0,this._zoomEasing=r,this._currentZoomTime=0,this._zoomDuration=o,this._zoomStart=this.z,this._zoomEnd=t):(this._isZooming=!1,this.z=t,this._zoomPromise.resolve(!0)),this._zoomPromise},s.prototype.getZoom=function(){return this.z},Object.defineProperty(s.prototype,"viewport",{get:function(){if(this._engine){var t=this._engine.halfDrawWidth,e=this._engine.halfDrawHeight;return new a.BoundingBox(this.x-t,this.y-e,this.x+t,this.y+e)}return new a.BoundingBox(0,0,0,0)},enumerable:!0,configurable:!0}),s.prototype.addStrategy=function(t){this._cameraStrategies.push(t)},s.prototype.removeStrategy=function(t){(0,r.removeItemFromArray)(t,this._cameraStrategies)},s.prototype.clearAllStrategies=function(){this._cameraStrategies.length=0},s.prototype._preupdate=function(t,e){this.emit("preupdate",new n.PreUpdateEvent(t,e,this)),this.onPreUpdate(t,e)},s.prototype.onPreUpdate=function(t,e){},s.prototype._postupdate=function(t,e){this.emit("postupdate",new n.PostUpdateEvent(t,e,this)),this.onPostUpdate(t,e)},s.prototype.onPostUpdate=function(t,e){},Object.defineProperty(s.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0}),s.prototype._initialize=function(e){this.isInitialized||(this.onInitialize(e),t.prototype.emit.call(this,"initialize",new n.InitializeEvent(e,this)),this._isInitialized=!0,this._engine=e)},s.prototype.onInitialize=function(t){},s.prototype.on=function(e,i){t.prototype.on.call(this,e,i)},s.prototype.off=function(e,i){t.prototype.off.call(this,e,i)},s.prototype.once=function(e,i){t.prototype.once.call(this,e,i)},s.prototype.update=function(t,i){var o,r;if(this._initialize(t),this._preupdate(t,i),this.pos=this.pos.add(this.vel.scale(i/1e3)),this.z+=this.dz*i/1e3,this.vel=this.vel.add(this.acc.scale(i/1e3)),this.dz+=this.az*i/1e3,this.rotation+=this.angularVelocity*i/1e3,this._isZooming)if(this._currentZoomTime<this._zoomDuration){var n=(0,this._zoomEasing)(this._currentZoomTime,this._zoomStart,this._zoomEnd,this._zoomDuration);this.z=n,this._currentZoomTime+=i}else this._isZooming=!1,this.z=this._zoomEnd,this._currentZoomTime=0,this._zoomPromise.resolve(!0);if(this._cameraMoving)if(this._currentLerpTime<this._lerpDuration){var s=e.EasingFunctions.CreateVectorEasingFunction(this._easing)(this._currentLerpTime,this._lerpStart,this._lerpEnd,this._lerpDuration);this.pos=s,this._currentLerpTime+=i}else{this.pos=this._lerpEnd;var a=this._lerpEnd.clone();this._lerpStart=null,this._lerpEnd=null,this._currentLerpTime=0,this._cameraMoving=!1,this._lerpPromise.resolve(a)}this._isDoneShaking()?(this._isShaking=!1,this._elapsedShakeTime=0,this._shakeMagnitudeX=0,this._shakeMagnitudeY=0,this._shakeDuration=0,this._xShake=0,this._yShake=0):(this._elapsedShakeTime+=i,this._xShake=1+(Math.random()*this._shakeMagnitudeX|0),this._yShake=1+(Math.random()*this._shakeMagnitudeY|0));try{for(var h=c(this._cameraStrategies),u=h.next();!u.done;u=h.next()){var p=u.value;this.pos=p.action.call(p,p.target,this,t,i)}}catch(l){o={error:l}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(o)throw o.error}}this._postupdate(t,i)},s.prototype.draw=function(t){var e=this.getFocus(),i=t.width,o=t.height,r=this._engine?this._engine.pixelRatio:window.devicePixelRatio,n=this.getZoom(),s=i/n/r,a=o/n/r;t.scale(n,n),t.translate(-e.x+s/2+this._xShake,-e.y+a/2+this._yShake)},s.prototype.debugDraw=function(t){var e=this.getFocus();t.fillStyle="red",t.strokeStyle="white",t.lineWidth=3,t.beginPath(),t.arc(e.x,e.y,15,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.arc(e.x,e.y,5,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.setLineDash([5,15]),t.lineWidth=5,t.strokeStyle="white",t.strokeRect(this.viewport.left,this.viewport.top,this.viewport.width,this.viewport.height),t.closePath()},s.prototype._isDoneShaking=function(){return!this._isShaking||this._elapsedShakeTime>=this._shakeDuration},s}(s.Class);exports.Camera=g;
},{"./Util/EasingFunctions":"LpjS","./Promises":"PqN8","./Algebra":"NGcQ","./Util/Util":"Kkda","./Events":"XySq","./Class":"yTUi","./Collision/BoundingBox":"oyna"}],"rRqb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Label=exports.LabelImpl=exports.FontStyle=exports.BaseAlign=exports.TextAlign=exports.FontUnit=void 0;var t=require("./Drawing/Color"),e=require("./Actor"),o=require("./Configurable"),n=require("./Algebra"),r=require("./Collision/CollisionType");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s,a,l,c,p=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();exports.FontUnit=s,function(t){t[t.Em=0]="Em",t[t.Rem=1]="Rem",t[t.Px=2]="Px",t[t.Pt=3]="Pt",t[t.Percent=4]="Percent"}(s||(exports.FontUnit=s={})),exports.TextAlign=a,function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Start=3]="Start",t[t.End=4]="End"}(a||(exports.TextAlign=a={})),exports.BaseAlign=l,function(t){t[t.Top=0]="Top",t[t.Hanging=1]="Hanging",t[t.Middle=2]="Middle",t[t.Alphabetic=3]="Alphabetic",t[t.Ideographic=4]="Ideographic",t[t.Bottom=5]="Bottom"}(l||(exports.BaseAlign=l={})),exports.FontStyle=c,function(t){t[t.Normal=0]="Normal",t[t.Italic=1]="Italic",t[t.Oblique=2]="Oblique"}(c||(exports.FontStyle=c={}));var u=function(e){function o(o,p,u,f,h){var x=e.call(this,o&&"object"===i(o)?o:{pos:new n.Vector(p,u)})||this;x.bold=!1,x.fontSize=10,x.fontStyle=c.Normal,x.fontUnit=s.Px,x.textAlign=a.Left,x.baseAlign=l.Bottom,x.letterSpacing=0,x.caseInsensitive=!0;var y="";return o&&"object"===i(o)?(f=o.fontFamily,h=o.spriteFont,y=o.text):y=o,x.text=y||"",x.color=t.Color.Black,x.spriteFont=h,x.body.collider.type=r.CollisionType.PreventCollision,x.fontFamily=f||"sans-serif",x._textShadowOn=!1,x._shadowOffsetX=0,x._shadowOffsetY=0,x}return p(o,e),o.prototype.getTextWidth=function(t){var e=t.font;t.font=this._fontString;var o=t.measureText(this.text).width;return t.font=e,o},o.prototype._lookupFontUnit=function(t){switch(t){case s.Em:return"em";case s.Rem:return"rem";case s.Pt:return"pt";case s.Px:return"px";case s.Percent:return"%";default:return"px"}},o.prototype._lookupTextAlign=function(t){switch(t){case a.Left:return"left";case a.Right:return"right";case a.Center:return"center";case a.End:return"end";case a.Start:default:return"start"}},o.prototype._lookupBaseAlign=function(t){switch(t){case l.Alphabetic:return"alphabetic";case l.Bottom:return"bottom";case l.Hanging:return"hanging";case l.Ideographic:return"ideographic";case l.Middle:return"middle";case l.Top:return"top";default:return"alphabetic"}},o.prototype._lookupFontStyle=function(t){var e=this.bold?" bold":"";switch(t){case c.Italic:return"italic"+e;case c.Normal:return"normal"+e;case c.Oblique:return"oblique"+e;default:return"normal"+e}},o.prototype.setTextShadow=function(t,e,o){this.spriteFont.setTextShadow(t,e,o)},o.prototype.useTextShadow=function(t){this.spriteFont.useTextShadow(t)},o.prototype.clearTextShadow=function(){this._textShadowOn=!1,this._shadowOffsetX=0,this._shadowOffsetY=0},o.prototype.update=function(t,o){e.prototype.update.call(this,t,o)},o.prototype.draw=function(t,o){t.save(),t.translate(this.pos.x,this.pos.y),t.scale(this.scale.x,this.scale.y),t.rotate(this.rotation),this._textShadowOn&&(t.save(),t.translate(this._shadowOffsetX,this._shadowOffsetY),this._fontDraw(t),t.restore()),this._fontDraw(t),e.prototype.draw.call(this,t,o),t.restore()},o.prototype._fontDraw=function(t){if(this.spriteFont)this.spriteFont.draw(t,this.text,0,0,{color:this.color.clone(),baseAlign:this.baseAlign,textAlign:this.textAlign,fontSize:this.fontSize,letterSpacing:this.letterSpacing,opacity:this.opacity});else{var e=t.textAlign,o=t.textBaseline;t.textAlign=this._lookupTextAlign(this.textAlign),t.textBaseline=this._lookupBaseAlign(this.baseAlign),this.color&&(this.color.a=this.opacity),t.fillStyle=this.color.toString(),t.font=this._fontString,this.maxWidth?t.fillText(this.text,0,0,this.maxWidth):t.fillText(this.text,0,0),t.textAlign=e,t.textBaseline=o}},Object.defineProperty(o.prototype,"_fontString",{get:function(){return this._lookupFontStyle(this.fontStyle)+" "+this.fontSize+this._lookupFontUnit(this.fontUnit)+" "+this.fontFamily},enumerable:!0,configurable:!0}),o.prototype.debugDraw=function(t){e.prototype.debugDraw.call(this,t)},o}(e.Actor);exports.LabelImpl=u;var f=function(t){function e(e,o,n,r,i){return t.call(this,e,o,n,r,i)||this}return p(e,t),e}((0,o.Configurable)(u));exports.Label=f;
},{"./Drawing/Color":"p7Gh","./Actor":"vmFf","./Configurable":"A4Kj","./Algebra":"NGcQ","./Collision/CollisionType":"liCD"}],"NgAR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Trigger=void 0;var t=require("./Drawing/Color"),e=require("./Actions/Action"),r=require("./EventDispatcher"),i=require("./Actor"),o=require("./Algebra"),n=require("./Events"),c=a(require("./Util/Util")),l=require("./Collision/CollisionType");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var n=i?Object.getOwnPropertyDescriptor(t,o):null;n&&(n.get||n.set)?Object.defineProperty(r,o,n):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}var s=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),p={pos:o.Vector.Zero,width:10,height:10,visible:!1,action:function(){},filter:function(){return!0},repeat:-1},f=function(o){function u(t){var u=o.call(this,t.pos.x,t.pos.y,t.width,t.height)||this;return u.action=function(){},u.filter=function(){return!0},u.repeat=-1,t=c.extend({},p,t),u.filter=t.filter||u.filter,u.repeat=t.repeat||u.repeat,u.action=t.action||u.action,t.target&&(u.target=t.target),u.visible=t.visible,u.body.collider.type=l.CollisionType.Passive,u.eventDispatcher=new r.EventDispatcher(u),u.actionQueue=new e.ActionQueue(u),u.on("collisionstart",function(t){(0,i.isActor)(t.other)&&u.filter(t.other)&&(u.emit("enter",new n.EnterTriggerEvent(u,t.other)),u._dispatchAction(),0===u.repeat&&u.kill())}),u.on("collisionend",function(t){(0,i.isActor)(t.other)&&u.filter(t.other)&&u.emit("exit",new n.ExitTriggerEvent(u,t.other))}),u}return s(u,o),Object.defineProperty(u.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t,this.filter=function(e){return e===t}},enumerable:!0,configurable:!0}),u.prototype._initialize=function(t){o.prototype._initialize.call(this,t)},u.prototype._dispatchAction=function(){this.action.call(this),this.repeat--},u.prototype.debugDraw=function(e){o.prototype.debugDraw.call(this,e),e.save(),e.translate(this.pos.x,this.pos.y);var r=this.body.collider.bounds,i=this.getWorldPos();r.left=r.left-i.x,r.right=r.right-i.x,r.top=r.top-i.y,r.bottom=r.bottom-i.y,e.fillStyle=t.Color.Violet.toString(),e.strokeStyle=t.Color.Violet.toString(),e.fillText("Trigger",10,10),r.debugDraw(e),e.restore()},u}(i.Actor);exports.Trigger=f;
},{"./Drawing/Color":"p7Gh","./Actions/Action":"gDdL","./EventDispatcher":"c7EN","./Actor":"vmFf","./Algebra":"NGcQ","./Events":"XySq","./Util/Util":"Kkda","./Collision/CollisionType":"liCD"}],"UUno":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isVanillaActor=t,exports.isScreenElement=i;var e=require("../ScreenElement"),r=require("../Label"),n=require("../Trigger");function t(t){return!(t instanceof e.ScreenElement||t instanceof n.Trigger||t instanceof r.Label)}function i(r){return r instanceof e.ScreenElement}
},{"../ScreenElement":"PDm1","../Label":"rRqb","../Trigger":"NgAR"}],"Jytr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GraphicsSystem=void 0;var t=require("../Actor"),r=require("./GraphicsComponent"),o=require("../Transform"),e=require("./Rect"),n=require("../Drawing/Color"),i=function(t){var r="function"==typeof Symbol&&Symbol.iterator,o=r&&t[r],e=0;if(o)return o.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(t,r){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var e,n,i=o.call(t),c=[];try{for(;(void 0===r||r-- >0)&&!(e=i.next()).done;)c.push(e.value)}catch(s){n={error:s}}finally{try{e&&!e.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return c},s=function(){function s(t,e){this.ctx=t,this.scene=e,this.types=[r.GraphicsComponent.type,o.TransformComponent.type]}return s.prototype.update=function(r,o){var s,a,l,h,d,u,p,f,y,v,_,g,m;this._clearScreen(),r.sort(function(t,r){return t.components.transform.z-r.components.transform.z});try{for(var x=i(r),b=x.next();!b.done;b=x.next()){var w=b.value;if(g=w.components.transform,m=w.components.graphics,!this._isOffscreen(w)){this._pushCameraTransform(g),this.ctx.save(),m.update(o),this._applyEntityTransform(g);var C=c(this._applyActorAnchor(w),2),B=C[0],T=C[1];this.ctx.z=g.z,this.ctx.opacity=m.opacity*(null!==(l=w.opacity)&&void 0!==l?l:1),m.draw(this.ctx,B,T),this.scene._engine.isDebug&&(this.ctx.z=99,(0,t.isActor)(w)&&(m.__debug.colliderBounds?(m.__debug.colliderBounds.width=w.body.collider.bounds.width,m.__debug.colliderBounds.height=w.body.collider.bounds.height):m.__debug.colliderBounds=new e.Rect({color:n.Color.Transparent,lineWidth:4,strokeColor:n.Color.Red,width:w.width,height:w.height}),m.__debug.colliderBounds.draw(this.ctx,0,0),m.__debug.graphicBounds?(m.__debug.graphicBounds.width=null!==(y=null===(f=m.current)||void 0===f?void 0:f.width)&&void 0!==y?y:0,m.__debug.graphicBounds.height=null!==(_=null===(v=m.current)||void 0===v?void 0:v.height)&&void 0!==_?_:0):m.__debug.graphicBounds=new e.Rect({color:n.Color.Transparent,lineWidth:4,strokeColor:n.Color.Blue,width:null!==(d=null===(h=m.current)||void 0===h?void 0:h.width)&&void 0!==d?d:0,height:null!==(p=null===(u=m.current)||void 0===u?void 0:u.height)&&void 0!==p?p:0}),m.__debug.graphicBounds.draw(this.ctx,B,T))),this.ctx.restore(),this._popCameraTransform(g)}}}catch(S){s={error:S}}finally{try{b&&!b.done&&(a=x.return)&&a.call(x)}finally{if(s)throw s.error}}this.ctx.flush()},s.prototype._clearScreen=function(){this.ctx.clear()},s.prototype._isOffscreen=function(r){return!!(0,t.isActor)(r)&&r.isOffScreen},s.prototype._applyEntityTransform=function(t){this.ctx.translate(t.pos.x,t.pos.y),this.ctx.rotate(t.rotation),this.ctx.scale(t.scale.x,t.scale.y)},s.prototype._applyActorAnchor=function(r){if((0,t.isActor)(r)){this.ctx.translate(-r.width*r.anchor.x,-r.height*r.anchor.y);var o=r.graphics.current;if(o)return[(r.width-o.width*o.scale.x)*r.anchor.x,(r.height-o.height*o.scale.y)*r.anchor.y]}return[0,0]},s.prototype._pushCameraTransform=function(t){var r;t.coordPlane===o.CoordPlane.World&&(this.ctx.save(),(null===(r=null==this?void 0:this.scene)||void 0===r?void 0:r.camera)&&this.scene.camera.draw(this.ctx))},s.prototype._popCameraTransform=function(t){t.coordPlane===o.CoordPlane.World&&this.ctx.restore()},s}();exports.GraphicsSystem=s;
},{"../Actor":"vmFf","./GraphicsComponent":"jeAN","../Transform":"hPn9","./Rect":"mGqB","../Drawing/Color":"p7Gh"}],"pJ6L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParticleEmitter=exports.ParticleEmitterImpl=exports.Particle=exports.ParticleImpl=exports.EmitterType=void 0;var t=require("./Actor"),i=require("./Drawing/Color"),e=require("./Algebra"),r=f(require("./Util/Util")),o=f(require("./Util/DrawUtil")),a=f(require("./Traits/Index")),s=require("./Configurable"),n=require("./Math/Random"),l=require("./Collision/CollisionType"),c=require("./Graphics"),p=require("./Entity"),h=require("./Transform");function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function f(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var i=u();if(i&&i.has(t))return i.get(t);var e={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=r?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(e,o,a):e[o]=t[o]}return e.default=t,i&&i.set(t,e),e}var d,m=function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function r(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();exports.EmitterType=d,function(t){t[t.Circle=0]="Circle",t[t.Rectangle=1]="Rectangle"}(d||(exports.EmitterType=d={}));var y=function(t){function o(r,o,a,s,n,l,p,u,f,d){var m=t.call(this)||this;m.position=new e.Vector(0,0),m.velocity=new e.Vector(0,0),m.acceleration=new e.Vector(0,0),m.particleRotationalVelocity=0,m.currentRotation=0,m.focus=null,m.focusAccel=0,m.opacity=1,m.beginColor=i.Color.White,m.endColor=i.Color.White,m.life=300,m.fadeFlag=!1,m._rRate=1,m._gRate=1,m._bRate=1,m._aRate=0,m._currentColor=i.Color.White,m.emitter=null,m.particleSize=5,m.particleSprite=null,m.graphics=new c.GraphicsComponent,m.sizeRate=0,m.elapsedMultiplier=0;var y=r;if(y&&!(r instanceof S)){var g=r;y=g.emitter,o=g.life,a=g.opacity,n=g.endColor,s=g.beginColor,l=g.position,p=g.velocity,u=g.acceleration,f=g.startSize,d=g.endSize}return m.emitter=y,m.life=o||m.life,m.opacity=a||m.opacity,m.endColor=n||m.endColor.clone(),m.beginColor=s||m.beginColor.clone(),m._currentColor=m.beginColor.clone(),m.position=l||m.position,m.velocity=p||m.velocity,m.acceleration=u||m.acceleration,m._rRate=(m.endColor.r-m.beginColor.r)/m.life,m._gRate=(m.endColor.g-m.beginColor.g)/m.life,m._bRate=(m.endColor.b-m.beginColor.b)/m.life,m._aRate=m.opacity/m.life,m.startSize=f||0,m.endSize=d||0,m.endSize>0&&m.startSize>0&&(m.sizeRate=(m.endSize-m.startSize)/m.life,m.particleSize=m.startSize),m.transform=new h.TransformComponent,m.addComponent(m.transform),m.addComponent(m.graphics),m.transform.pos=m.position,m.transform.rotation=m.currentRotation,m.transform.scale=(0,e.vec)(m.particleSize,m.particleSize),m.graphics.opacity=m.opacity,m}return m(o,t),o.prototype.kill=function(){this.emitter.removeParticle(this)},o.prototype.update=function(t){if(this.life=this.life-t,this.elapsedMultiplier=this.elapsedMultiplier+t,this.life<0&&this.kill(),this.fadeFlag&&(this.opacity=r.clamp(this._aRate*this.life,1e-4,1)),this.startSize>0&&this.endSize>0&&(this.particleSize=r.clamp(this.sizeRate*t+this.particleSize,Math.min(this.startSize,this.endSize),Math.max(this.startSize,this.endSize))),this._currentColor.r=r.clamp(this._currentColor.r+this._rRate*t,0,255),this._currentColor.g=r.clamp(this._currentColor.g+this._gRate*t,0,255),this._currentColor.b=r.clamp(this._currentColor.b+this._bRate*t,0,255),this._currentColor.a=r.clamp(this.opacity,1e-4,1),this.focus){var i=this.focus.sub(this.position).normalize().scale(this.focusAccel).scale(t/1e3);this.velocity=this.velocity.add(i)}else this.velocity=this.velocity.add(this.acceleration.scale(t/1e3));this.position=this.position.add(this.velocity.scale(t/1e3)),this.particleRotationalVelocity&&(this.currentRotation=(this.currentRotation+this.particleRotationalVelocity*t/1e3)%(2*Math.PI)),this.transform.pos=this.position,this.transform.rotation=this.currentRotation,this.transform.scale=(0,e.vec)(this.particleSize,this.particleSize),this.graphics.opacity=this.opacity},o.prototype.draw=function(t){if(this.particleSprite)return this.particleSprite.rotation=this.currentRotation,this.particleSprite.scale.setTo(this.particleSize,this.particleSize),void this.particleSprite.draw(t,this.position.x,this.position.y);this._currentColor.a=r.clamp(this.opacity,1e-4,1),t.fillStyle=this._currentColor.toString(),t.beginPath(),t.arc(this.position.x,this.position.y,this.particleSize,0,2*Math.PI),t.fill(),t.closePath()},o}(p.Entity);exports.ParticleImpl=y;var g=function(t){function i(i,e,r,o,a,s,n,l,c,p){return t.call(this,i,e,r,o,a,s,n,l,c,p)||this}return m(i,t),i}((0,s.Configurable)(y));exports.Particle=g;var C=function(t){function s(o,s,c,p){var h=t.call(this,"number"==typeof o?{pos:new e.Vector(o,s),width:c,height:p}:o)||this;h.numParticles=0,h.isEmitting=!0,h.particles=null,h.deadParticles=null,h.minVel=0,h.maxVel=0,h.acceleration=new e.Vector(0,0),h.minAngle=0,h.maxAngle=0,h.emitRate=1,h.particleLife=2e3,h.opacity=1,h.fadeFlag=!1,h.focus=null,h.focusAccel=1,h.startSize=null,h.endSize=null,h.minSize=5,h.maxSize=5,h.beginColor=i.Color.White,h.endColor=i.Color.White,h.particleSprite=null,h.sprite=null,h.emitterType=d.Rectangle,h.radius=0,h.particleRotationalVelocity=0,h.randomRotation=!1,h._particlesToEmit=0,h.body.collider.type=l.CollisionType.PreventCollision,h.particles=new r.Collection,h.deadParticles=new r.Collection,h.random=new n.Random;for(var u=0;u<h.traits.length;u++)h.traits[u]instanceof a.OffscreenCulling&&h.traits.splice(u,1);return h}return m(s,t),s.prototype.removeParticle=function(t){this.deadParticles.push(t)},s.prototype.emitParticles=function(t){for(var i=0;i<t;i++)this.particles.push(this._createParticle())},s.prototype.clearParticles=function(){this.particles.clear()},s.prototype._createParticle=function(){var t=0,i=0,o=r.randomInRange(this.minAngle,this.maxAngle,this.random),a=r.randomInRange(this.minVel,this.maxVel,this.random),s=this.startSize||r.randomInRange(this.minSize,this.maxSize,this.random),n=a*Math.cos(o),l=a*Math.sin(o);if(this.emitterType===d.Rectangle)t=r.randomInRange(this.pos.x,this.pos.x+this.width,this.random),i=r.randomInRange(this.pos.y,this.pos.y+this.height,this.random);else if(this.emitterType===d.Circle){var c=r.randomInRange(0,this.radius,this.random);t=c*Math.cos(o)+this.pos.x,i=c*Math.sin(o)+this.pos.y}var p=new g(this,this.particleLife,this.opacity,this.beginColor,this.endColor,new e.Vector(t,i),new e.Vector(n,l),this.acceleration,this.startSize,this.endSize);return p.fadeFlag=this.fadeFlag,p.particleSize=s,this.particleSprite&&(p.particleSprite=this.particleSprite),p.particleRotationalVelocity=this.particleRotationalVelocity,this.randomRotation&&(p.currentRotation=r.randomInRange(0,2*Math.PI,this.random)),this.focus&&(p.focus=this.focus.add(new e.Vector(this.pos.x,this.pos.y)),p.focusAccel=this.focusAccel),p.graphics.show(this.sprite),p.graphics.anchor=e.Vector.Half,p},s.prototype.update=function(i,e){var r=this;t.prototype.update.call(this,i,e),this.isEmitting&&(this._particlesToEmit+=this.emitRate*(e/1e3),this._particlesToEmit>1&&(this.emitParticles(Math.floor(this._particlesToEmit)),this._particlesToEmit=this._particlesToEmit-Math.floor(this._particlesToEmit))),this.particles.forEach(function(t){return t.update(e)}),this.deadParticles.forEach(function(t){return r.particles.removeElement(t)}),this.deadParticles.clear()},s.prototype.draw=function(t){this.particles.forEach(function(i){return i.draw(t)})},s.prototype.debugDraw=function(e){t.prototype.debugDraw.call(this,e),e.fillStyle=i.Color.Black.toString(),e.fillText("Particles: "+this.particles.count(),this.pos.x,this.pos.y+20),this.focus&&(e.fillRect(this.focus.x+this.pos.x,this.focus.y+this.pos.y,3,3),o.line(e,i.Color.Yellow,this.focus.x+this.pos.x,this.focus.y+this.pos.y,this.center.x,this.center.y),e.fillText("Focus",this.focus.x+this.pos.x,this.focus.y+this.pos.y))},s}(t.Actor);exports.ParticleEmitterImpl=C;var S=function(t){function i(i,e,r,o){return t.call(this,i,e,r,o)||this}return m(i,t),i}((0,s.Configurable)(C));exports.ParticleEmitter=S;
},{"./Actor":"vmFf","./Drawing/Color":"p7Gh","./Algebra":"NGcQ","./Util/Util":"Kkda","./Util/DrawUtil":"UgQh","./Traits/Index":"CPmg","./Configurable":"A4Kj","./Math/Random":"yYMg","./Collision/CollisionType":"liCD","./Graphics":"qIYM","./Entity":"EGNO","./Transform":"hPn9"}],"xS6v":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Scene=void 0;var e=require("./ScreenElement"),t=require("./Physics"),r=require("./Events"),i=require("./Util/Log"),n=require("./Timer"),o=require("./Collision/DynamicTreeCollisionBroadphase"),s=require("./Util/SortedList"),a=require("./Engine"),c=require("./TileMap"),l=require("./Camera"),h=require("./Actor"),p=require("./Class"),u=v(require("./Util/Util")),d=v(require("./Util/Actors")),f=require("./Trigger"),y=require("./Graphics/GraphicsSystem"),g=require("./Entity"),_=require("./Particles");function m(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return m=function(){return e},e}function v(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=m();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=i?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}var w=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),b=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},D=function(p){function m(e){var t=p.call(this)||this;return t.actors=[],t.entities=[],t._bodies=[],t.triggers=[],t.tileMaps=[],t.screenElements=[],t._isInitialized=!1,t._sortedDrawingTree=new s.SortedList(h.Actor.prototype.getZIndex),t._broadphase=new o.DynamicTreeCollisionBroadphase,t._killQueue=[],t._triggerKillQueue=[],t._timers=[],t._cancelQueue=[],t._logger=i.Logger.getInstance(),t.camera=new l.Camera,t._engine=e,e&&(t.camera.x=e.halfDrawWidth,t.camera.y=e.halfDrawHeight),t}return w(m,p),m.prototype.on=function(e,t){p.prototype.on.call(this,e,t)},m.prototype.once=function(e,t){p.prototype.once.call(this,e,t)},m.prototype.off=function(e,t){p.prototype.off.call(this,e,t)},m.prototype.onInitialize=function(e){},m.prototype.onActivate=function(e,t){},m.prototype.onDeactivate=function(e,t){},m.prototype.onPreUpdate=function(e,t){},m.prototype.onPostUpdate=function(e,t){},m.prototype.onPreDraw=function(e,t){},m.prototype.onPostDraw=function(e,t){},m.prototype._initializeChildren=function(){var e,t;try{for(var r=b(this.actors),i=r.next();!i.done;i=r.next()){i.value._initialize(this._engine)}}catch(n){e={error:n}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},Object.defineProperty(m.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0}),m.prototype._initialize=function(e){this.isInitialized||(this._engine=e,this._graphicsContext=e.graphicsContext,this._graphicsSystem=new y.GraphicsSystem(this._graphicsContext,this),this.camera&&(this.camera.x=e.halfDrawWidth,this.camera.y=e.halfDrawHeight),this.onInitialize.call(this,e),this._initializeChildren(),this._logger.debug("Scene.onInitialize",this,e),this.eventDispatcher.emit("initialize",new r.InitializeEvent(e,this)),this._isInitialized=!0)},m.prototype._activate=function(e,t){this._logger.debug("Scene.onActivate",this),this.onActivate(e,t)},m.prototype._deactivate=function(e,t){this._logger.debug("Scene.onDeactivate",this),this.onDeactivate(e,t)},m.prototype._preupdate=function(e,t){this.emit("preupdate",new r.PreUpdateEvent(e,t,this)),this.onPreUpdate(e,t)},m.prototype._postupdate=function(e,t){this.emit("postupdate",new r.PostUpdateEvent(e,t,this)),this.onPostUpdate(e,t)},m.prototype._predraw=function(e,t){this.emit("predraw",new r.PreDrawEvent(e,t,this)),this.onPreDraw(e,t)},m.prototype._postdraw=function(e,t){this.emit("postdraw",new r.PostDrawEvent(e,t,this)),this.onPostDraw(e,t)},m.prototype.update=function(e,r){var i,n,o,s;for(this._preupdate(e,r),this.camera&&this.camera.update(e,r),o=0,s=this._cancelQueue.length;o<s;o++)this.removeTimer(this._cancelQueue[o]);this._cancelQueue.length=0;try{for(var a=b(this._timers),c=a.next();!c.done;c=a.next()){c.value.update(r)}}catch(g){i={error:g}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}for(o=0,s=this.screenElements.length;o<s;o++)this.screenElements[o].update(e,r);for(o=0,s=this.tileMaps.length;o<s;o++)this.tileMaps[o].update(e,r);for(o=0,s=this.actors.length;o<s;o++)this.actors[o].update(e,r),this._bodies[o]=this.actors[o].body;for(o=0,s=this.triggers.length;o<s;o++)this.triggers[o].update(e,r);if(this._collectActorStats(e),e.input.pointers.dispatchPointerEvents(),this._broadphase&&t.Physics.enabled){var l=Date.now();this._broadphase.update(this._bodies,r);for(var h=this._broadphase.broadphase(this._bodies,r,e.stats.currFrame),p=Date.now(),u=Date.now(),d=t.Physics.collisionPasses,f=r/d;d>0;)h=this._broadphase.narrowphase(h,e.stats.currFrame),h=this._broadphase.resolve(h,f,t.Physics.collisionResolutionStrategy),this._broadphase.runCollisionStartEnd(h),d--;var y=Date.now();e.stats.currFrame.physics.broadphase=p-l,e.stats.currFrame.physics.narrowphase=y-u}e.stats.currFrame.actors.killed=this._killQueue.length+this._triggerKillQueue.length,this._processKillQueue(this._killQueue,this.actors),this._processKillQueue(this._triggerKillQueue,this.triggers),this._postupdate(e,r)},m.prototype._processKillQueue=function(e,t){var r,i,n;try{for(var o=b(e),s=o.next();!s.done;s=o.next()){var a=s.value;a.isKilled()&&(n=t.indexOf(a))>-1&&(this._sortedDrawingTree.removeByComparable(a),t.splice(n,1))}}catch(c){r={error:c}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}e.length=0},m.prototype._getTileMapCells=function(){var e,t,r=[];for(e=0,t=this.tileMaps.length;e<t;e++)r=r.concat(this.tileMaps[e].getCellsOnScreen());return r},m.prototype._getParticles=function(){var e,t,r=this.actors.filter(function(e){return e instanceof _.ParticleEmitter}),i=[];try{for(var n=b(r),o=n.next();!o.done;o=n.next()){var s=o.value;i=i.concat(s.particles.toArray())}}catch(a){e={error:a}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return i},m.prototype.draw=function(e,t){if(this._predraw(e,t),e.save(),a.Engine._useLegacyDrawing)this.__legacyDraw(e,t);else{var r=this.entities.concat(this._getParticles()).concat(this._getTileMapCells());this._graphicsSystem.update(r,t)}e.restore(),this._postdraw(e,t)},m.prototype.__legacyDraw=function(e,t){var r,i;for(this._graphicsContext.clear(),this._predraw(e,t),e.save(),this.camera&&this.camera.draw(this._graphicsContext),r=0,i=this.tileMaps.length;r<i;r++)this.tileMaps[r].draw(e,t);var n=this._sortedDrawingTree.list();for(r=0,i=n.length;r<i;r++)n[r].visible&&!n[r].isOffScreen&&n[r].draw(e,t);for(this._engine&&this._engine.isDebug&&(e.strokeStyle="yellow",this.debugDraw(e)),e.restore(),r=0,i=this.screenElements.length;r<i;r++)this.screenElements[r].visible&&this.screenElements[r].draw(e,t);if(this._engine&&this._engine.isDebug)for(r=0,i=this.screenElements.length;r<i;r++)this.screenElements[r].debugDraw(e);this._postdraw(e,t)},m.prototype.debugDraw=function(e){var t,i;for(this.emit("predebugdraw",new r.PreDebugDrawEvent(e,this)),t=0,i=this.tileMaps.length;t<i;t++)this.tileMaps[t].debugDraw(e);for(t=0,i=this.actors.length;t<i;t++)this.actors[t].debugDraw(e);for(t=0,i=this.triggers.length;t<i;t++)this.triggers[t].debugDraw(e);this._broadphase.debugDraw(e,20),this.camera.debugDraw(e),this.emit("postdebugdraw",new r.PostDebugDrawEvent(e,this))},m.prototype.contains=function(e){return this.actors.indexOf(e)>-1},m.prototype.add=function(t){t instanceof h.Actor&&t.unkill(),t instanceof e.ScreenElement?u.contains(this.screenElements,t)||(this.addScreenElement(t),this.addEntity(t)):t instanceof h.Actor?u.contains(this.actors,t)||(this._addChild(t),this.addEntity(t)):t instanceof n.Timer?u.contains(this._timers,t)||this.addTimer(t):t instanceof c.TileMap&&(u.contains(this.tileMaps,t)||this.addTileMap(t))},m.prototype.remove=function(t){if(t instanceof e.ScreenElement)return this.removeScreenElement(t),void this.removeEntity(t);t instanceof h.Actor&&(this._removeChild(t),this.removeEntity(t)),t instanceof g.Entity&&this.removeEntity(t),t instanceof n.Timer&&this.removeTimer(t),t instanceof c.TileMap&&this.removeTileMap(t)},m.prototype.addEntity=function(e){this.entities.push(e)},m.prototype.removeEntity=function(e){var t=this.entities.indexOf(e);t>-1&&this.entities.splice(t,1)},m.prototype.addScreenElement=function(e){this.screenElements.push(e),e.scene=this},m.prototype.removeScreenElement=function(e){var t=this.screenElements.indexOf(e);t>-1&&this.screenElements.splice(t,1)},m.prototype._addChild=function(e){this._broadphase.track(e.body),e.scene=this,e instanceof f.Trigger?this.triggers.push(e):this.actors.push(e),this._sortedDrawingTree.add(e)},m.prototype.addTileMap=function(e){this.tileMaps.push(e)},m.prototype.removeTileMap=function(e){var t=this.tileMaps.indexOf(e);t>-1&&this.tileMaps.splice(t,1)},m.prototype._removeChild=function(e){u.contains(this.actors,e)&&(this._broadphase.untrack(e.body),e instanceof f.Trigger?this._triggerKillQueue.push(e):(e.isKilled()||e.kill(),this._killQueue.push(e)),e.parent=null)},m.prototype.addTimer=function(e){return this._timers.push(e),e.scene=this,e},m.prototype.removeTimer=function(e){var t=this._timers.indexOf(e);return-1!==t&&this._timers.splice(t,1),e},m.prototype.cancelTimer=function(e){return this._cancelQueue.push(e),e},m.prototype.isTimerActive=function(e){return this._timers.indexOf(e)>-1&&!e.complete},m.prototype.cleanupDrawTree=function(e){this._sortedDrawingTree.removeByComparable(e)},m.prototype.updateDrawTree=function(e){this._sortedDrawingTree.add(e)},m.prototype.isActorInDrawTree=function(e){return this._sortedDrawingTree.find(e)},m.prototype.isCurrentScene=function(){return!!this._engine&&this._engine.currentScene===this},m.prototype._collectActorStats=function(e){var t,r,i,n,o,s;try{for(var a=b(this.screenElements),c=a.next();!c.done;c=a.next()){c.value;e.stats.currFrame.actors.ui++}}catch(g){t={error:g}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}try{for(var l=b(this.actors),h=l.next();!h.done;h=l.next()){var p=h.value;e.stats.currFrame.actors.alive++;try{for(var u=(o=void 0,b(p.children)),f=u.next();!f.done;f=u.next()){var y=f.value;d.isScreenElement(y)?e.stats.currFrame.actors.ui++:e.stats.currFrame.actors.alive++}}catch(_){o={error:_}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}}}catch(m){i={error:m}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}},m}(p.Class);exports.Scene=D;
},{"./ScreenElement":"PDm1","./Physics":"uSEN","./Events":"XySq","./Util/Log":"p1Gn","./Timer":"y7ZJ","./Collision/DynamicTreeCollisionBroadphase":"O6gl","./Util/SortedList":"O7SY","./Engine":"CIaB","./TileMap":"QP5n","./Camera":"pAjs","./Actor":"vmFf","./Class":"yTUi","./Util/Util":"Kkda","./Util/Actors":"UUno","./Trigger":"NgAR","./Graphics/GraphicsSystem":"Jytr","./Entity":"EGNO","./Particles":"pJ6L"}],"haDW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PhysicsStats=exports.FrameStats=exports.Debug=void 0;var t=function(){return function(){this.stats={currFrame:new e,prevFrame:new e}}}();exports.Debug=t;var e=function(){function t(){this._id=0,this._delta=0,this._fps=0,this._actorStats={alive:0,killed:0,ui:0,get remaining(){return this.alive-this.killed},get total(){return this.remaining+this.ui}},this._durationStats={update:0,draw:0,get total(){return this.update+this.draw}},this._physicsStats=new s}return t.prototype.reset=function(t){t?(this.id=t.id,this.delta=t.delta,this.fps=t.fps,this.actors.alive=t.actors.alive,this.actors.killed=t.actors.killed,this.actors.ui=t.actors.ui,this.duration.update=t.duration.update,this.duration.draw=t.duration.draw,this._physicsStats.reset(t.physics)):(this.id=this.delta=this.fps=0,this.actors.alive=this.actors.killed=this.actors.ui=0,this.duration.update=this.duration.draw=0,this._physicsStats.reset())},t.prototype.clone=function(){var e=new t;return e.reset(this),e},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delta",{get:function(){return this._delta},set:function(t){this._delta=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fps",{get:function(){return this._fps},set:function(t){this._fps=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actors",{get:function(){return this._actorStats},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._durationStats},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"physics",{get:function(){return this._physicsStats},enumerable:!0,configurable:!0}),t}();exports.FrameStats=e;var s=function(){function t(){this._pairs=0,this._collisions=0,this._collidersHash={},this._fastBodies=0,this._fastBodyCollisions=0,this._broadphase=0,this._narrowphase=0}return t.prototype.reset=function(t){t?(this.pairs=t.pairs,this.collisions=t.collisions,this.collidersHash=t.collidersHash,this.fastBodies=t.fastBodies,this.fastBodyCollisions=t.fastBodyCollisions,this.broadphase=t.broadphase,this.narrowphase=t.narrowphase):(this.pairs=this.collisions=this.fastBodies=0,this.fastBodyCollisions=this.broadphase=this.narrowphase=0,this.collidersHash={})},t.prototype.clone=function(){var e=new t;return e.reset(this),e},Object.defineProperty(t.prototype,"pairs",{get:function(){return this._pairs},set:function(t){this._pairs=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collisions",{get:function(){return this._collisions},set:function(t){this._collisions=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collidersHash",{get:function(){return this._collidersHash},set:function(t){this._collidersHash=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fastBodies",{get:function(){return this._fastBodies},set:function(t){this._fastBodies=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fastBodyCollisions",{get:function(){return this._fastBodyCollisions},set:function(t){this._fastBodyCollisions=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"broadphase",{get:function(){return this._broadphase},set:function(t){this._broadphase=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"narrowphase",{get:function(){return this._narrowphase},set:function(t){this._narrowphase=t},enumerable:!0,configurable:!0}),t}();exports.PhysicsStats=s;
},{}],"LjC7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Axes=exports.Buttons=exports.Gamepad=exports.Gamepads=void 0;var t=require("./../Class"),e=require("../Events");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=function(t){function o(){var e=t.call(this)||this;return e.enabled=!1,e.supported=!!navigator.getGamepads,e._gamePadTimeStamps=[0,0,0,0],e._oldPads=[],e._pads=[],e._initSuccess=!1,e._navigator=navigator,e._minimumConfiguration=null,e}return i(o,t),o.prototype.init=function(){this.supported&&(this._initSuccess||(this._oldPads=this._clonePads(this._navigator.getGamepads()),this._oldPads.length&&this._oldPads[0]&&(this._initSuccess=!0)))},o.prototype.setMinimumGamepadConfiguration=function(t){this._enableAndUpdate(),this._minimumConfiguration=t},o.prototype._enableAndUpdate=function(){this.enabled||(this.enabled=!0,this.update())},o.prototype._isGamepadValid=function(t){if(!this._minimumConfiguration)return!0;if(!t)return!1;var e=t.axes.filter(function(t){return void 0!==n(t)}).length,i=t.buttons.filter(function(t){return void 0!==n(t)}).length;return e>=this._minimumConfiguration.axis&&i>=this._minimumConfiguration.buttons&&t.connected},o.prototype.on=function(e,n){this._enableAndUpdate(),t.prototype.on.call(this,e,n)},o.prototype.off=function(e,n){this._enableAndUpdate(),t.prototype.off.call(this,e,n)},o.prototype.update=function(){if(this.enabled&&this.supported){this.init();for(var t=this._navigator.getGamepads(),n=0;n<t.length;n++)if(t[n]){if(!this.at(n).connected&&this._isGamepadValid(t[n])&&this.eventDispatcher.emit("connect",new e.GamepadConnectEvent(n,this.at(n))),this.at(n).connected=!0,!t[n].timestamp||t[n].timestamp!==this._gamePadTimeStamps[n]){this._gamePadTimeStamps[n]=t[n].timestamp,this.at(n).navigatorGamepad=t[n];var i=void 0,o=void 0,r=void 0,p=void 0,u=void 0;for(i in a)"number"==typeof(o=a[i])&&t[n].buttons[o]&&(u=t[n].buttons[o].value)!==this._oldPads[n].getButton(o)&&(t[n].buttons[o].pressed?(this.at(n).updateButton(o,u),this.at(n).eventDispatcher.emit("button",new e.GamepadButtonEvent(o,u,this.at(n)))):this.at(n).updateButton(o,0));for(r in s)"number"==typeof(p=s[r])&&(u=t[n].axes[p])!==this._oldPads[n].getAxes(p)&&(this.at(n).updateAxes(p,u),this.at(n).eventDispatcher.emit("axis",new e.GamepadAxisEvent(p,u,this.at(n))));this._oldPads[n]=this._clonePad(t[n])}}else{var d=this.at(n);d.connected&&this.eventDispatcher.emit("disconnect",new e.GamepadDisconnectEvent(n,d)),d.connected=!1}}},o.prototype.at=function(t){if(this._enableAndUpdate(),t>=this._pads.length)for(var e=this._pads.length-1,n=t;e<n;e++)this._pads.push(new r),this._oldPads.push(new r);return this._pads[t]},o.prototype.getValidGamepads=function(){this._enableAndUpdate();for(var t=[],e=0;e<this._pads.length;e++)this._isGamepadValid(this.at(e).navigatorGamepad)&&this.at(e).connected&&t.push(this.at(e));return t},o.prototype.count=function(){return this._pads.filter(function(t){return t.connected}).length},o.prototype._clonePads=function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(this._clonePad(t[n]));return e},o.prototype._clonePad=function(t){var e,n,i=new r;if(!t)return i;for(e=0,n=t.buttons.length;e<n;e++)t.buttons[e]&&i.updateButton(e,t.buttons[e].value);for(e=0,n=t.axes.length;e<n;e++)i.updateAxes(e,t.axes[e]);return i},o.MinAxisMoveThreshold=.05,o}(t.Class);exports.Gamepads=o;var a,s,r=function(t){function e(){var e=t.call(this)||this;e.connected=!1,e._buttons=new Array(16),e._axes=new Array(4);for(var n=0;n<e._buttons.length;n++)e._buttons[n]=0;for(n=0;n<e._axes.length;n++)e._axes[n]=0;return e}return i(e,t),e.prototype.isButtonPressed=function(t,e){return void 0===e&&(e=1),this._buttons[t]>=e},e.prototype.getButton=function(t){return this._buttons[t]},e.prototype.getAxes=function(t){var e=this._axes[t];return Math.abs(e)<o.MinAxisMoveThreshold?0:e},e.prototype.updateButton=function(t,e){this._buttons[t]=e},e.prototype.updateAxes=function(t,e){this._axes[t]=e},e}(t.Class);exports.Gamepad=r,exports.Buttons=a,function(t){t[t.Face1=0]="Face1",t[t.Face2=1]="Face2",t[t.Face3=2]="Face3",t[t.Face4=3]="Face4",t[t.LeftBumper=4]="LeftBumper",t[t.RightBumper=5]="RightBumper",t[t.LeftTrigger=6]="LeftTrigger",t[t.RightTrigger=7]="RightTrigger",t[t.Select=8]="Select",t[t.Start=9]="Start",t[t.LeftStick=10]="LeftStick",t[t.RightStick=11]="RightStick",t[t.DpadUp=12]="DpadUp",t[t.DpadDown=13]="DpadDown",t[t.DpadLeft=14]="DpadLeft",t[t.DpadRight=15]="DpadRight"}(a||(exports.Buttons=a={})),exports.Axes=s,function(t){t[t.LeftStickX=0]="LeftStickX",t[t.LeftStickY=1]="LeftStickY",t[t.RightStickX=2]="RightStickX",t[t.RightStickY=3]="RightStickY"}(s||(exports.Axes=s={}));
},{"./../Class":"yTUi","../Events":"XySq"}],"MOJH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pointer=exports.PointerScope=exports.PointerType=void 0;var t=require("../Algebra"),o=require("../Class"),e=i(require("../Util/Actors")),r=require("../Util/Util");function n(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}function i(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var o=n();if(o&&o.has(t))return o.get(t);var e={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=r?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(e,i,s):e[i]=t[i]}return e.default=t,o&&o.set(t,e),e}var s,c,a=function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),u=function(t,o){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,n,i=e.call(t),s=[];try{for(;(void 0===o||o-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(c){n={error:c}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}return s},p=function(){for(var t=[],o=0;o<arguments.length;o++)t=t.concat(u(arguments[o]));return t};exports.PointerType=s,function(t){t.Touch="Touch",t.Mouse="Mouse",t.Pen="Pen",t.Unknown="Unknown"}(s||(exports.PointerType=s={})),exports.PointerScope=c,function(t){t.Canvas="Canvas",t.Document="Document"}(c||(exports.PointerScope=c={}));var l=function(o){function n(){var t=o.call(this)||this;return t.id=n._MAX_ID++,t._isDown=!1,t._wasDown=!1,t._actorsUnderPointer={length:0},t._actors=[],t._actorsLastFrame=[],t._actorsNoLongerUnderPointer=[],t.lastPagePos=null,t.lastScreenPos=null,t.lastWorldPos=null,t.dragTarget=null,t.on("move",t._onPointerMove),t.on("down",t._onPointerDown),t.on("up",t._onPointerUp),t}return a(n,o),Object.defineProperty(n.prototype,"isDragging",{get:function(){return this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDragStart",{get:function(){return!this._wasDown&&this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isDragEnd",{get:function(){return this._wasDown&&!this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasActorsUnderPointer",{get:function(){return!!this._actorsUnderPointer.length},enumerable:!0,configurable:!0}),n.prototype.on=function(t,e){o.prototype.on.call(this,t,e)},n.prototype.once=function(t,e){o.prototype.once.call(this,t,e)},n.prototype.off=function(t,e){o.prototype.off.call(this,t,e)},n.prototype.update=function(){this._wasDown&&!this._isDown?this._wasDown=!1:!this._wasDown&&this._isDown&&(this._wasDown=!0),this._actorsLastFrame=p(this._actors),this._actorsNoLongerUnderPointer=[]},n.prototype.addActorUnderPointer=function(t){this.isActorUnderPointer(t)||(this._actorsUnderPointer[t.id]=t,this._actorsUnderPointer.length+=1,this._actors.push(t)),this._actors.sort(function(t,o){return t.z===o.z?t.id-o.id:t.z-o.z})},n.prototype.removeActorUnderPointer=function(t){this.isActorUnderPointer(t)&&(delete this._actorsUnderPointer[t.id],this._actorsUnderPointer.length-=1,(0,r.removeItemFromArray)(t,this._actors),this._actorsNoLongerUnderPointer.push(t))},n.prototype.getActorsUnderPointer=function(){return this._actors},n.prototype.getActorsUnderPointerLastFrame=function(){return this._actorsLastFrame},n.prototype.getActorsForEvents=function(){return this._actors.concat(this._actorsLastFrame).filter(function(t,o,e){return e.indexOf(t)===o})},n.prototype.checkActorUnderPointer=function(t){return!!this.lastWorldPos&&t.contains(this.lastWorldPos.x,this.lastWorldPos.y,!e.isScreenElement(t))},n.prototype.wasActorUnderPointer=function(t){return this._actorsLastFrame.indexOf(t)>-1},n.prototype.isActorUnderPointer=function(t){return(!t.isKilled()||!!t.scene)&&this._actorsUnderPointer.hasOwnProperty(t.id.toString())},n.prototype._onPointerMove=function(o){this.lastPagePos=new t.Vector(o.pagePos.x,o.pagePos.y),this.lastScreenPos=new t.Vector(o.screenPos.x,o.screenPos.y),this.lastWorldPos=new t.Vector(o.worldPos.x,o.worldPos.y)},n.prototype._onPointerDown=function(o){this.lastPagePos=new t.Vector(o.pagePos.x,o.pagePos.y),this.lastScreenPos=new t.Vector(o.screenPos.x,o.screenPos.y),this.lastWorldPos=new t.Vector(o.worldPos.x,o.worldPos.y),this._isDown=!0},n.prototype._onPointerUp=function(t){this._isDown=!1,this.dragTarget=null},n._MAX_ID=0,n}(o.Class);exports.Pointer=l;
},{"../Algebra":"NGcQ","../Class":"yTUi","../Util/Actors":"UUno","../Util/Util":"Kkda"}],"LGsV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPointerEventByName=d,exports.WheelEvent=exports.PointerCancelEvent=exports.PointerLeaveEvent=exports.PointerEnterEvent=exports.PointerMoveEvent=exports.PointerDownEvent=exports.PointerUpEvent=exports.PointerDragEvent=exports.PointerEventFactory=exports.PointerEvent=exports.WheelDeltaMode=exports.PointerButton=exports.NativePointerButton=void 0;var t,e,n,r=require("../Events"),o=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();exports.NativePointerButton=t,function(t){t[t.NoButton=-1]="NoButton",t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Unknown=3]="Unknown"}(t||(exports.NativePointerButton=t={})),exports.PointerButton=e,function(t){t.Left="Left",t.Middle="Middle",t.Right="Right",t.Unknown="Unknown",t.NoButton="NoButton"}(e||(exports.PointerButton=e={})),exports.WheelDeltaMode=n,function(t){t.Pixel="Pixel",t.Line="Line",t.Page="Page"}(n||(exports.WheelDeltaMode=n={}));var i=function(t){function e(e,n,r,o,i,p){var a=t.call(this)||this;return a.coordinates=e,a.pointer=n,a.index=r,a.pointerType=o,a.button=i,a.ev=p,a}return o(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worldPos",{get:function(){return this.coordinates.worldPos.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagePos",{get:function(){return this.coordinates.pagePos.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"screenPos",{get:function(){return this.coordinates.screenPos.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pos",{get:function(){return this.coordinates.worldPos.clone()},enumerable:!0,configurable:!0}),e.prototype.propagate=function(t){this.doAction(t),this.bubbles&&t.parent&&this.propagate(t.parent)},e.prototype.doAction=function(t){t&&(this._onActionStart(t),t.emit(this._name,this),this._onActionEnd(t))},e.prototype._onActionStart=function(t){},e.prototype._onActionEnd=function(t){},e}(r.GameEvent);exports.PointerEvent=i;var p=function(){function t(t){this._pointerEventType=t}return t.prototype.create=function(t,e,n,r,o,i){return new this._pointerEventType(t,e,n,r,o,i)},t}();exports.PointerEventFactory=p;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i);exports.PointerDragEvent=a;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="pointerup",e}return o(e,t),e.prototype._onActionEnd=function(t){this.pointer.isDragEnd&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragend",this)},e}(i);exports.PointerUpEvent=c;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="pointerdown",e}return o(e,t),e.prototype._onActionEnd=function(t){this.pointer.isDragStart&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragstart",this)},e}(i);exports.PointerDownEvent=s;var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="pointermove",e}return o(e,t),e.prototype.propagate=function(t){this.pointer.isActorUnderPointer(t)&&(this.doAction(t),this.bubbles&&t.parent&&this.propagate(t.parent))},e.prototype._onActionStart=function(t){t.capturePointer.captureMoveEvents&&this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragmove",this)},e}(i);exports.PointerMoveEvent=u;var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="pointerenter",e}return o(e,t),e.prototype._onActionStart=function(t){t.capturePointer.captureMoveEvents},e.prototype._onActionEnd=function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragenter",this)},e}(i);exports.PointerEnterEvent=v;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="pointerleave",e}return o(e,t),e.prototype._onActionStart=function(t){t.capturePointer.captureMoveEvents},e.prototype._onActionEnd=function(t){this.pointer.isDragging&&t.capturePointer.captureDragEvents&&t.eventDispatcher.emit("pointerdragleave",this)},e}(i);exports.PointerLeaveEvent=l;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="pointercancel",e}return o(e,t),e}(i);exports.PointerCancelEvent=f;var h=function(t){function e(e,n,r,o,i,p,a,c,s,u,v,l){var f=t.call(this)||this;return f.x=e,f.y=n,f.pageX=r,f.pageY=o,f.screenX=i,f.screenY=p,f.index=a,f.deltaX=c,f.deltaY=s,f.deltaZ=u,f.deltaMode=v,f.ev=l,f}return o(e,t),e}(r.GameEvent);function d(t,e,n,r,o,i,a){var h;switch(t){case"up":h=new p(c);break;case"down":h=new p(s);break;case"move":h=new p(u);break;case"cancel":h=new p(f);break;case"enter":h=new p(v);break;case"leave":h=new p(l)}return h.create(e,n,r,o,i,a)}exports.WheelEvent=h;
},{"../Events":"XySq"}],"P0Od":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pointers=void 0;var e=require("../Class"),t=require("../Engine"),n=require("./Pointer"),r=require("./PointerEvents"),o=l(require("../Util/Util")),i=require("../Algebra"),a=require("../Traits/CapturePointer");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}var p=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=-.025,u=function(e){function s(t){var r=e.call(this)||this;return r._pointerDown=[],r._pointerUp=[],r._pointerMove=[],r._pointerCancel=[],r._wheel=[],r._pointers=[],r._activePointers=[],r._engine=t,r._pointers.push(new n.Pointer),r._activePointers=[-1],r.primary=r._pointers[0],r}return p(s,e),s.prototype.on=function(t,n){e.prototype.on.call(this,t,n)},s.prototype.init=function(e){(e=e||this._engine.canvas).addEventListener("touchstart",this._handleTouchEvent("down",this._pointerDown)),e.addEventListener("touchend",this._handleTouchEvent("up",this._pointerUp)),e.addEventListener("touchmove",this._handleTouchEvent("move",this._pointerMove)),e.addEventListener("touchcancel",this._handleTouchEvent("cancel",this._pointerCancel)),window.PointerEvent?(this._engine.canvas.style.touchAction="none",e.addEventListener("pointerdown",this._handlePointerEvent("down",this._pointerDown)),e.addEventListener("pointerup",this._handlePointerEvent("up",this._pointerUp)),e.addEventListener("pointermove",this._handlePointerEvent("move",this._pointerMove)),e.addEventListener("pointercancel",this._handlePointerEvent("cancel",this._pointerCancel))):window.MSPointerEvent?(this._engine.canvas.style.msTouchAction="none",e.addEventListener("MSPointerDown",this._handlePointerEvent("down",this._pointerDown)),e.addEventListener("MSPointerUp",this._handlePointerEvent("up",this._pointerUp)),e.addEventListener("MSPointerMove",this._handlePointerEvent("move",this._pointerMove)),e.addEventListener("MSPointerCancel",this._handlePointerEvent("cancel",this._pointerCancel))):(e.addEventListener("mousedown",this._handleMouseEvent("down",this._pointerDown)),e.addEventListener("mouseup",this._handleMouseEvent("up",this._pointerUp)),e.addEventListener("mousemove",this._handleMouseEvent("move",this._pointerMove)));var n={passive:!(this._engine.pageScrollPreventionMode===t.ScrollPreventionMode.All||this._engine.pageScrollPreventionMode===t.ScrollPreventionMode.Canvas)};"onwheel"in document.createElement("div")?e.addEventListener("wheel",this._handleWheelEvent("wheel",this._wheel),n):void 0!==document.onmousewheel?e.addEventListener("mousewheel",this._handleWheelEvent("wheel",this._wheel),n):e.addEventListener("MozMousePixelScroll",this._handleWheelEvent("wheel",this._wheel),n)},s.prototype.triggerEvent=function(e,t,n,o,s){var l,p;void 0===n&&(n=r.NativePointerButton.Left),void 0===o&&(o="mouse"),void 0===s&&(s=0);var c,u=0,v=0;t instanceof i.GlobalCoordinates?(u=t.pagePos.x,v=t.pagePos.y,c=t):(u=t.x,v=t.y,c=new i.GlobalCoordinates(t.clone(),t.clone(),t.clone()));var d={pageX:u,pageY:v,pointerId:s,pointerType:o,button:n,preventDefault:function(){}};switch(e){case"move":this._handlePointerEvent(e,this._pointerMove,c)(d);break;case"down":this._handlePointerEvent(e,this._pointerDown,c)(d);break;case"up":this._handlePointerEvent(e,this._pointerUp,c)(d);break;case"cancel":this._handlePointerEvent(e,this._pointerCancel,c)(d)}try{for(var _=h(this._engine.currentScene.actors),f=_.next();!f.done;f=_.next()){var P=f.value,y=P.traits.filter(function(e){return e instanceof a.CapturePointer})[0];y&&y.update(P,this._engine,1)}}catch(g){l={error:g}}finally{try{f&&!f.done&&(p=_.return)&&p.call(_)}finally{if(l)throw l.error}}this.dispatchPointerEvents(),this.update()},s.prototype.update=function(){this._pointerUp.length=0,this._pointerDown.length=0,this._pointerMove.length=0,this._pointerCancel.length=0,this._wheel.length=0;for(var e=0;e<this._pointers.length;e++)this._pointers[e].update()},s.prototype.at=function(e){if(e>=this._pointers.length)for(var t=this._pointers.length-1,r=e;t<r;t++)this._pointers.push(new n.Pointer),this._activePointers.push(-1);return this._pointers[e]},s.prototype.count=function(){return this._pointers.length},s.prototype.checkAndUpdateActorUnderPointer=function(e){var t,n;try{for(var r=h(this._pointers),o=r.next();!o.done;o=r.next()){var i=o.value;i.checkActorUnderPointer(e)?i.addActorUnderPointer(e):i.removeActorUnderPointer(e)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},s.prototype._dispatchWithBubble=function(e){var t,n,r,o;try{for(var i=h(e),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var l=(r=void 0,h(s.pointer.getActorsForEvents())),p=l.next();!p.done;p=l.next()){var c=p.value;if(s.propagate(c),!s.bubbles)break}}catch(u){r={error:u}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}}}catch(v){t={error:v}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},s.prototype._dispatchPointerLeaveEvents=function(){var e,t,n,o,a={},s=[];try{for(var l=h(this._pointerMove),p=l.next();!p.done;p=l.next()){var c=p.value;try{for(var u=(n=void 0,h(c.pointer.getActorsForEvents())),v=u.next();!v.done;v=u.next()){var d=v.value;if(!a[c.pointer.id+"+"+d.id]&&c.pointer.wasActorUnderPointer(d)&&!c.pointer.isActorUnderPointer(d)){a[c.pointer.id+"+"+d.id]=c;var _=(0,r.createPointerEventByName)("leave",new i.GlobalCoordinates(c.worldPos,c.pagePos,c.screenPos),c.pointer,c.index,c.pointerType,c.button,c.ev);_.propagate(d),s.push(_)}}}catch(f){n={error:f}}finally{try{v&&!v.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}}catch(P){e={error:P}}finally{try{p&&!p.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}return s},s.prototype._dispatchPointerEnterEvents=function(){var e,t,n,o,a={},s=[];try{for(var l=h(this._pointerMove),p=l.next();!p.done;p=l.next()){var c=p.value;try{for(var u=(n=void 0,h(c.pointer.getActorsForEvents())),v=u.next();!v.done;v=u.next()){var d=v.value;if(!a[c.pointer.id]&&!c.pointer.wasActorUnderPointer(d)&&c.pointer.isActorUnderPointer(d)){a[c.pointer.id]=c;var _=(0,r.createPointerEventByName)("enter",new i.GlobalCoordinates(c.worldPos,c.pagePos,c.screenPos),c.pointer,c.index,c.pointerType,c.button,c.ev);_.propagate(d),s.push(_),c.pointer.isDragging&&(c.pointer.dragTarget=d)}}}catch(f){n={error:f}}finally{try{v&&!v.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}}catch(P){e={error:P}}finally{try{p&&!p.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}return s},s.prototype.dispatchPointerEvents=function(){var e,t,n,r;this._dispatchWithBubble(this._pointerDown),this._dispatchWithBubble(this._pointerUp),this._dispatchWithBubble(this._pointerMove),this._dispatchPointerLeaveEvents(),this._dispatchPointerEnterEvents(),this._dispatchWithBubble(this._pointerCancel);try{for(var o=h(this._wheel),i=o.next();!i.done;i=o.next()){var a=i.value;try{for(var s=(n=void 0,h(this._pointers[a.index].getActorsUnderPointer())),l=s.next();!l.done;l=s.next()){var p=l.value;if(this._propagateWheelPointerEvent(p,a),!a.bubbles)break}}catch(c){n={error:c}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(u){e={error:u}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},s.prototype._propagateWheelPointerEvent=function(e,t){e.emit("pointerwheel",t),t.bubbles&&e.parent&&this._propagateWheelPointerEvent(e.parent,t)},s.prototype._handleMouseEvent=function(e,t){var o=this;return function(a){a.preventDefault();var s=o.at(0),l=i.GlobalCoordinates.fromPagePosition(a.pageX,a.pageY,o._engine),p=(0,r.createPointerEventByName)(e,l,s,0,n.PointerType.Mouse,o._nativeButtonToPointerButton(a.button),a);t.push(p),s.eventDispatcher.emit(e,p)}},s.prototype._handleTouchEvent=function(e,t){var o=this;return function(a){a.preventDefault();for(var s=0,l=a.changedTouches.length;s<l;s++){var p=o._pointers.length>1?o._getPointerIndex(a.changedTouches[s].identifier):0;if(-1!==p){var h=o.at(p),c=i.GlobalCoordinates.fromPagePosition(a.changedTouches[s].pageX,a.changedTouches[s].pageY,o._engine),u=(0,r.createPointerEventByName)(e,c,h,p,n.PointerType.Touch,r.PointerButton.Unknown,a);t.push(u),h.eventDispatcher.emit(e,u),o._pointers.length>1&&("up"===e?o._activePointers[p]=-1:"down"===e&&(o._activePointers[p]=a.changedTouches[s].identifier))}}}},s.prototype._handlePointerEvent=function(e,t,n){var o=this;return function(a){a.preventDefault();var s=o._pointers.length>1?o._getPointerIndex(a.pointerId):0;if(-1!==s){var l=o.at(s),p=n||i.GlobalCoordinates.fromPagePosition(a.pageX,a.pageY,o._engine),h=(0,r.createPointerEventByName)(e,p,l,s,o._stringToPointerType(a.pointerType),o._nativeButtonToPointerButton(a.button),a);t.push(h),l.eventDispatcher.emit(e,h),o._pointers.length>1&&("up"===e?o._activePointers[s]=-1:"down"===e&&(o._activePointers[s]=a.pointerId))}}},s.prototype._handleWheelEvent=function(e,n){var a=this;return function(s){(a._engine.pageScrollPreventionMode===t.ScrollPreventionMode.All||a._engine.pageScrollPreventionMode===t.ScrollPreventionMode.Canvas&&s.target===a._engine.canvas)&&s.preventDefault();var l=s.pageX-o.getPosition(a._engine.canvas).x,p=s.pageY-o.getPosition(a._engine.canvas).y,h=a._engine.screenToWorldCoordinates(new i.Vector(l,p)),u=s.deltaX||s.wheelDeltaX*c||0,v=s.deltaY||s.wheelDeltaY*c||s.wheelDelta*c||s.detail||0,d=s.deltaZ||0,_=r.WheelDeltaMode.Pixel;s.deltaMode&&(1===s.deltaMode?_=r.WheelDeltaMode.Line:2===s.deltaMode&&(_=r.WheelDeltaMode.Page));var f=new r.WheelEvent(h.x,h.y,s.pageX,s.pageY,l,p,0,u,v,d,_,s);n.push(f),a.at(0).eventDispatcher.emit(e,f)}},s.prototype._getPointerIndex=function(e){var t;if((t=this._activePointers.indexOf(e))>-1)return t;for(var n=0;n<this._activePointers.length;n++)if(-1===this._activePointers[n])return n;return-1},s.prototype._nativeButtonToPointerButton=function(e){switch(e){case r.NativePointerButton.NoButton:return r.PointerButton.NoButton;case r.NativePointerButton.Left:return r.PointerButton.Left;case r.NativePointerButton.Middle:return r.PointerButton.Middle;case r.NativePointerButton.Right:return r.PointerButton.Right;case r.NativePointerButton.Unknown:return r.PointerButton.Unknown;default:return o.fail(e)}},s.prototype._stringToPointerType=function(e){switch(e){case"touch":return n.PointerType.Touch;case"mouse":return n.PointerType.Mouse;case"pen":return n.PointerType.Pen;default:return n.PointerType.Unknown}},s}(e.Class);exports.Pointers=u;
},{"../Class":"yTUi","../Engine":"CIaB","./Pointer":"MOJH","./PointerEvents":"LGsV","../Util/Util":"Kkda","../Algebra":"NGcQ","../Traits/CapturePointer":"G2LY"}],"cTMu":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.Keyboard=exports.KeyEvent=exports.Keys=void 0;var t,n=require("./../Class"),o=require("../Events"),r=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();exports.Keys=t,function(e){e[e.Num1=97]="Num1",e[e.Num2=98]="Num2",e[e.Num3=99]="Num3",e[e.Num4=100]="Num4",e[e.Num5=101]="Num5",e[e.Num6=102]="Num6",e[e.Num7=103]="Num7",e[e.Num8=104]="Num8",e[e.Num9=105]="Num9",e[e.Num0=96]="Num0",e[e.Numlock=144]="Numlock",e[e.Semicolon=186]="Semicolon",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Shift=16]="Shift",e[e.Alt=18]="Alt",e[e.Up=38]="Up",e[e.Down=40]="Down",e[e.Left=37]="Left",e[e.Right=39]="Right",e[e.Space=32]="Space",e[e.Esc=27]="Esc"}(t||(exports.Keys=t={}));var s=function(e){function t(t){var n=e.call(this)||this;return n.key=t,n}return r(t,e),t}(o.GameEvent);exports.KeyEvent=s;var i=function(e){function n(){var t=e.call(this)||this;return t._keys=[],t._keysUp=[],t._keysDown=[],t}return r(n,e),n.prototype.on=function(t,n){e.prototype.on.call(this,t,n)},n.prototype.init=function(e){var t=this;(e=e||window.top||window).addEventListener("blur",function(){t._keys.length=0}),e.addEventListener("keyup",function(e){var n=t._normalizeKeyCode(e.keyCode),o=t._keys.indexOf(n);t._keys.splice(o,1),t._keysUp.push(n);var r=new s(n);t.eventDispatcher.emit("up",r),t.eventDispatcher.emit("release",r)}),e.addEventListener("keydown",function(e){var n=t._normalizeKeyCode(e.keyCode);if(-1===t._keys.indexOf(n)){t._keys.push(n),t._keysDown.push(n);var o=new s(n);t.eventDispatcher.emit("down",o),t.eventDispatcher.emit("press",o)}})},n.prototype.update=function(){this._keysDown.length=0,this._keysUp.length=0;for(var e=0;e<this._keys.length;e++)this.eventDispatcher.emit("hold",new s(this._keys[e]))},n.prototype.getKeys=function(){return this._keys},n.prototype.wasPressed=function(e){return this._keysDown.indexOf(e)>-1},n.prototype.isHeld=function(e){return this._keys.indexOf(e)>-1},n.prototype.wasReleased=function(e){return this._keysUp.indexOf(e)>-1},n.prototype._normalizeKeyCode=function(e){switch(e){case 59:return t.Semicolon;default:return e}},n}(n.Class);exports.Keyboard=i;
},{"./../Class":"yTUi","../Events":"XySq"}],"aiZ2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Gamepad");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./Pointer");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./Pointers");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var n=require("./PointerEvents");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return n[e]}})});var u=require("./Keyboard");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});
},{"./Gamepad":"LjC7","./Pointer":"MOJH","./Pointers":"P0Od","./PointerEvents":"LGsV","./Keyboard":"cTMu"}],"ids7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserEvents=exports.BrowserComponent=void 0;var t=function(){function t(t){this.nativeComponent=t,this._paused=!1,this._nativeHandlers={}}return t.prototype.on=function(t,e){this._nativeHandlers[t]&&this.off(t,this._nativeHandlers[t]),this._nativeHandlers[t]=this._decorate(e),this.nativeComponent.addEventListener(t,this._nativeHandlers[t])},t.prototype.off=function(t,e){e||(e=this._nativeHandlers[t]),this.nativeComponent.removeEventListener(t,e),this._nativeHandlers[t]=null},t.prototype._decorate=function(t){var e=this;return function(n){e._paused||t(n)}},t.prototype.pause=function(){this._paused=!0},t.prototype.resume=function(){this._paused=!1},t.prototype.clear=function(){for(var t in this._nativeHandlers)this.off(t)},t}();exports.BrowserComponent=t;var e=function(){function e(e,n){this._windowGlobal=e,this._documentGlobal=n,this._windowComponent=new t(this._windowGlobal),this._documentComponent=new t(this._documentGlobal)}return Object.defineProperty(e.prototype,"window",{get:function(){return this._windowComponent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this._documentComponent},enumerable:!0,configurable:!0}),e.prototype.pause=function(){this.window.pause(),this.document.pause()},e.prototype.resume=function(){this.window.resume(),this.document.resume()},e.prototype.clear=function(){this.window.clear(),this.document.clear()},e}();exports.BrowserEvents=e;
},{}],"CIaB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Engine=exports.ScrollPreventionMode=exports.DisplayMode=void 0;var e=require("./"),t=require("./Polyfill"),i=require("./Algebra"),n=require("./ScreenElement"),r=require("./Actor"),o=require("./Timer"),s=require("./TileMap"),a=require("./Loader"),c=require("./Util/Detector"),h=require("./Events"),l=require("./Util/Log"),p=require("./Drawing/Color"),u=require("./Scene"),d=require("./Debug"),g=require("./Class"),f=_(require("./Input/Index")),m=require("./Collision/BoundingBox"),v=require("./Util/Browser"),y=require("./Graphics/Context/ExcaliburGraphicsContextWebGL"),b=require("./Graphics/Context/ExcaliburGraphicsContext2DCanvas");function w(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return w=function(){return e},e}function _(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=w();if(t&&t.has(e))return t.get(e);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=n?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=e[r]}return i.default=e,t&&t.set(e,i),i}var S,x,P=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),E=function(){return(E=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},C=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};(0,t.polyfill)(),exports.DisplayMode=S,function(e){e[e.FullScreen=0]="FullScreen",e[e.Container=1]="Container",e[e.Fixed=2]="Fixed",e[e.Position=3]="Position"}(S||(exports.DisplayMode=S={})),exports.ScrollPreventionMode=x,function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas",e[e.All=2]="All"}(x||(exports.ScrollPreventionMode=x={}));var D=function(t){function g(i){var n=t.call(this)||this;n._hasStarted=!1,n.debug=new d.Debug,n.postProcessors=[],n.scenes={},n._animations=[],n.isFullscreen=!1,n.displayMode=S.FullScreen,n._suppressHiDPIScaling=!1,n._suppressPlayButton=!1,n.pauseAudioWhenHidden=!0,n.isDebug=!1,n.debugColor=new p.Color(255,255,255),n.enableCanvasTransparency=!0,n.onFatalException=function(e){l.Logger.getInstance().fatal(e)},n._isSmoothingEnabled=!0,n._timescale=1,n._isLoading=!1,n._isInitialized=!1,i=E(E({},g._DefaultEngineOptions),i),n.browser=new v.BrowserEvents(window,document);var r=new c.Detector;if(!i.suppressMinimumBrowserFeatureDetection&&!(n._compatible=r.test())){var o=document.createElement("div");if(o.innerText="Sorry, your browser does not support all the features needed for Excalibur",document.body.appendChild(o),r.failedTests.forEach(function(e){var t=document.createElement("div");t.innerText="Browser feature missing "+e,document.body.appendChild(t)}),i.canvasElementId){var s=document.getElementById(i.canvasElementId);s&&s.parentElement.removeChild(s)}return n}return n._compatible=!0,console.log&&!i.suppressConsoleBootMessage&&(console.log("%cPowered by Excalibur.js (v"+e.EX_VERSION+")","background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;"),console.log("\n      /| ________________\nO|===|* >________________>\n      \\|"),console.log("Visit","http://excaliburjs.com","for more information")),i.suppressPlayButton&&(n._suppressPlayButton=!0),n._logger=l.Logger.getInstance(),n._logger.defaultLevel===l.LogLevel.Debug&&r.logBrowserFeatures(),n._logger.debug("Building engine..."),n.canvasElementId=i.canvasElementId,i.canvasElementId?(n._logger.debug("Using Canvas element specified: "+i.canvasElementId),n.canvas=document.getElementById(i.canvasElementId)):i.canvasElement?(n._logger.debug("Using Canvas element specified:",i.canvasElement),n.canvas=i.canvasElement):(n._logger.debug("Using generated canvas element"),n.canvas=document.createElement("canvas")),i.width&&i.height?(void 0===i.displayMode&&(n.displayMode=S.Fixed),n._logger.debug("Engine viewport is size "+i.width+" x "+i.height),n.canvas.width=i.width,n.canvas.height=i.height):i.displayMode||(n._logger.debug("Engine viewport is fullscreen"),n.displayMode=S.FullScreen),i.backgroundColor&&(n.backgroundColor=i.backgroundColor.clone()),n.enableCanvasTransparency=i.enableCanvasTransparency,n._loader=new a.Loader,n._initialize(i),n.rootScene=n.currentScene=new u.Scene(n),n.addScene("root",n.rootScene),n.goToScene("root"),n}return P(g,t),Object.defineProperty(g.prototype,"canvasWidth",{get:function(){return this.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"halfCanvasWidth",{get:function(){return this.canvas.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"canvasHeight",{get:function(){return this.canvas.height},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"halfCanvasHeight",{get:function(){return this.canvas.height/2},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"drawWidth",{get:function(){return this.currentScene&&this.currentScene.camera?this.canvasWidth/this.currentScene.camera.getZoom()/this.pixelRatio:this.canvasWidth/this.pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"halfDrawWidth",{get:function(){return this.drawWidth/2},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"drawHeight",{get:function(){return this.currentScene&&this.currentScene.camera?this.canvasHeight/this.currentScene.camera.getZoom()/this.pixelRatio:this.canvasHeight/this.pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"halfDrawHeight",{get:function(){return this.drawHeight/2},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"isHiDpi",{get:function(){return 1!==this.pixelRatio},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"stats",{get:function(){return this.debug.stats},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"pixelRatio",{get:function(){return this._suppressHiDPIScaling?1:window.devicePixelRatio<1?1:window.devicePixelRatio||1},enumerable:!0,configurable:!0}),g.prototype.on=function(e,i){t.prototype.on.call(this,e,i)},g.prototype.once=function(e,i){t.prototype.once.call(this,e,i)},g.prototype.off=function(e,i){t.prototype.off.call(this,e,i)},g.prototype.getWorldBounds=function(){var e=this.screenToWorldCoordinates(i.Vector.Zero).x,t=this.screenToWorldCoordinates(i.Vector.Zero).y,n=e+this.drawWidth,r=t+this.drawHeight;return new m.BoundingBox(e,t,n,r)},Object.defineProperty(g.prototype,"timescale",{get:function(){return this._timescale},set:function(e){e<=0?l.Logger.getInstance().error("Cannot set engine.timescale to a value of 0 or less than 0."):this._timescale=e},enumerable:!0,configurable:!0}),g.prototype.playAnimation=function(e,t,i){this._animations.push(new M(e,t,i))},g.prototype.addTileMap=function(e){this.currentScene.addTileMap(e)},g.prototype.removeTileMap=function(e){this.currentScene.removeTileMap(e)},g.prototype.addTimer=function(e){return this.currentScene.addTimer(e)},g.prototype.removeTimer=function(e){return this.currentScene.removeTimer(e)},g.prototype.addScene=function(e,t){this.scenes[e]&&this._logger.warn("Scene",e,"already exists overwriting"),this.scenes[e]=t},g.prototype.removeScene=function(e){if(e instanceof u.Scene)for(var t in this.scenes)this.scenes.hasOwnProperty(t)&&this.scenes[t]===e&&delete this.scenes[t];"string"==typeof e&&delete this.scenes[e]},g.prototype.add=function(e){if(e instanceof n.ScreenElement)return this.currentScene.addScreenElement(e),void this.currentScene.addEntity(e);e instanceof r.Actor&&(this._addChild(e),this.currentScene.addEntity(e)),e instanceof o.Timer&&this.addTimer(e),e instanceof s.TileMap&&this.addTileMap(e),2===arguments.length&&this.addScene(arguments[0],arguments[1])},g.prototype.remove=function(e){if(e instanceof n.ScreenElement)return this.currentScene.removeScreenElement(e),void this.currentScene.removeEntity(e);e instanceof r.Actor&&(this._removeChild(e),this.currentScene.removeEntity(e)),e instanceof o.Timer&&this.removeTimer(e),e instanceof s.TileMap&&this.removeTileMap(e),e instanceof u.Scene&&this.removeScene(e),"string"==typeof e&&this.removeScene(e)},g.prototype._addChild=function(e){this.currentScene.add(e)},g.prototype._removeChild=function(e){this.currentScene.remove(e)},g.prototype.goToScene=function(e){if(this.scenes[e]){var t=this.currentScene,i=this.scenes[e];this._logger.debug("Going to scene:",e),this.currentScene.isInitialized&&(this.currentScene._deactivate.call(this.currentScene,[t,i]),this.currentScene.eventDispatcher.emit("deactivate",new h.DeactivateEvent(i,this.currentScene))),this.currentScene=i,this.currentScene._initialize(this),this.currentScene._activate.call(this.currentScene,[t,i]),this.currentScene.eventDispatcher.emit("activate",new h.ActivateEvent(t,this.currentScene))}else this._logger.error("Scene",e,"does not exist!")},g.prototype.screenToWorldCoordinates=function(e){var t=e.x,n=e.y;if(t=t/this.canvas.clientWidth*this.drawWidth,n=n/this.canvas.clientHeight*this.drawHeight,t-=this.halfDrawWidth,n-=this.halfDrawHeight,this.currentScene&&this.currentScene.camera){var r=this.currentScene.camera.getFocus();t+=r.x,n+=r.y}return new i.Vector(Math.floor(t),Math.floor(n))},g.prototype.worldToScreenCoordinates=function(e){var t=e.x,n=e.y;if(this.currentScene&&this.currentScene.camera){var r=this.currentScene.camera.getFocus();t-=r.x,n-=r.y}return t+=this.halfDrawWidth,n+=this.halfDrawHeight,t=t*this.canvas.clientWidth/this.drawWidth,n=n*this.canvas.clientHeight/this.drawHeight,new i.Vector(Math.floor(t),Math.floor(n))},g.prototype._setHeightByDisplayMode=function(e){this.displayMode===S.Container&&(this.canvas.width=e.clientWidth,this.canvas.height=e.clientHeight),this.displayMode===S.FullScreen&&(document.body.style.margin="0px",document.body.style.overflow="hidden",this.canvas.width=e.innerWidth,this.canvas.height=e.innerHeight)},g.prototype._initialize=function(e){var t,i,n=this;if(e.displayMode&&(this.displayMode=e.displayMode),this.displayMode===S.FullScreen||this.displayMode===S.Container){var r=this.displayMode===S.Container?this.canvas.parentElement||document.body:window;this._setHeightByDisplayMode(r),this.browser.window.on("resize",function(){n._logger.debug("View port resized"),n._setHeightByDisplayMode(r),n._logger.info("parent.clientHeight "+r.clientHeight),n.setAntialiasing(n._isSmoothingEnabled)})}else this.displayMode===S.Position&&this._initializeDisplayModePosition(e);if(this.pageScrollPreventionMode=e.scrollPreventionMode,this.input={keyboard:new f.Keyboard,pointers:new f.Pointers(this),gamepads:new f.Gamepads},this.input.keyboard.init(),this.input.pointers.init(e&&e.pointerScope===f.PointerScope.Document?document:this.canvas),this.input.gamepads.init(),void 0!==document.hidden?(t="hidden",i="visibilitychange"):"msHidden"in document?(t="msHidden",i="msvisibilitychange"):"webkitHidden"in document&&(t="webkitHidden",i="webkitvisibilitychange"),this.browser.document.on(i,function(){document[t]?(n.eventDispatcher.emit("hidden",new h.HiddenEvent(n)),n._logger.debug("Window hidden")):(n.eventDispatcher.emit("visible",new h.VisibleEvent(n)),n._logger.debug("Window visible"))}),this._suppressHiDPIScaling=!!e.suppressHiDPIScaling,e.suppressHiDPIScaling||this._initializeHiDpi(),g._useWebGL){var o=document.createElement("canvas");this.ctx=o.getContext("2d",{alpha:this.enableCanvasTransparency});var s=this.canvas.getContext("webgl",{antialias:!1,premultipliedAlpha:!1,alpha:this.enableCanvasTransparency,depth:!1,powerPreference:"high-performance"});this.graphicsContext=new y.ExcaliburGraphicsContextWebGL(s)}else this.ctx=this.canvas.getContext("2d",{alpha:this.enableCanvasTransparency}),this.graphicsContext=new b.ExcaliburGraphicsContext2DCanvas(this.ctx);this.isHiDpi&&this.graphicsContext.scale(this.pixelRatio,this.pixelRatio),this.canvasElementId||e.canvasElement||document.body.appendChild(this.canvas)},g.prototype.onInitialize=function(e){},g.prototype._initializeDisplayModePosition=function(e){if(!e.position)throw new Error("DisplayMode of Position was selected but no position option was given");if(this.canvas.style.display="block",this.canvas.style.position="absolute","string"==typeof e.position){var t=e.position.split(" ");switch(t[0]){case"top":this.canvas.style.top="0px";break;case"bottom":this.canvas.style.bottom="0px";break;case"middle":this.canvas.style.top="50%";var i=-this.halfDrawHeight;this.canvas.style.marginTop=i.toString();break;default:throw new Error("Invalid Position Given")}if(t[1])switch(t[1]){case"left":this.canvas.style.left="0px";break;case"right":this.canvas.style.right="0px";break;case"center":this.canvas.style.left="50%";var n=-this.halfDrawWidth;this.canvas.style.marginLeft=n.toString();break;default:throw new Error("Invalid Position Given")}}else e.position.top&&("number"==typeof e.position.top?this.canvas.style.top=e.position.top.toString()+"px":this.canvas.style.top=e.position.top),e.position.right&&("number"==typeof e.position.right?this.canvas.style.right=e.position.right.toString()+"px":this.canvas.style.right=e.position.right),e.position.bottom&&("number"==typeof e.position.bottom?this.canvas.style.bottom=e.position.bottom.toString()+"px":this.canvas.style.bottom=e.position.bottom),e.position.left&&("number"==typeof e.position.left?this.canvas.style.left=e.position.left.toString()+"px":this.canvas.style.left=e.position.left)},g.prototype._initializeHiDpi=function(){if(this.isHiDpi){var e=this.canvas.width,t=this.canvas.height;this.canvas.width=e*this.pixelRatio,this.canvas.height=t*this.pixelRatio,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this._logger.warn("Hi DPI screen detected, resetting canvas resolution from \n                           "+e+"x"+t+" to "+this.canvas.width+"x"+this.canvas.height+" \n                           css size will remain "+e+"x"+t),this._logger.warn("Canvas drawing context was scaled by "+this.pixelRatio)}},g.prototype.setAntialiasing=function(e){var t,i;this._isSmoothingEnabled=e;var n=this.ctx;n.imageSmoothingEnabled=e;try{for(var r=C(["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"]),o=r.next();!o.done;o=r.next()){var s=o.value;s in n&&(n[s]=e)}}catch(a){t={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},g.prototype.getAntialiasing=function(){return this.ctx.imageSmoothingEnabled||this.ctx.webkitImageSmoothingEnabled||this.ctx.mozImageSmoothingEnabled||this.ctx.msImageSmoothingEnabled},Object.defineProperty(g.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0}),g.prototype._overrideInitialize=function(e){this.isInitialized||(this.onInitialize(e),t.prototype.emit.call(this,"initialize",new h.InitializeEvent(e,this)),this._isInitialized=!0)},g.prototype._update=function(e){if(this._isLoading)return this._loader.update(this,e),this.input.keyboard.update(),this.input.pointers.update(),void this.input.gamepads.update();this._overrideInitialize(this),this._preupdate(e),this.currentScene.update(this,e),this._animations=this._animations.filter(function(e){return!e.animation.isDone()}),this.input.keyboard.update(),this.input.pointers.update(),this.input.gamepads.update(),this._postupdate(e)},g.prototype._preupdate=function(e){this.emit("preupdate",new h.PreUpdateEvent(this,e,this)),this.onPreUpdate(this,e)},g.prototype.onPreUpdate=function(e,t){},g.prototype._postupdate=function(e){this.emit("postupdate",new h.PostUpdateEvent(this,e,this)),this.onPostUpdate(this,e)},g.prototype.onPostUpdate=function(e,t){},g.prototype._draw=function(e){var t=this.ctx;if(this._predraw(t,e),this._isLoading)return this._loader.canvas.draw(this.graphicsContext,0,0),void this.graphicsContext.flush();this.graphicsContext.backgroundColor=this.backgroundColor,this.currentScene.draw(this.ctx,e);for(var i=0,n=this._animations.length;i<n;i++)this._animations[i].animation.draw(t,this._animations[i].x,this._animations[i].y);if(this.isDebug){this.ctx.font="Consolas",this.ctx.fillStyle=this.debugColor.toString();for(var r=this.input.keyboard.getKeys(),o=0;o<r.length;o++)this.ctx.fillText(r[o].toString()+" : "+(f.Keys[r[o]]?f.Keys[r[o]]:"Not Mapped"),100,10*o+10);this.ctx.fillText("FPS:"+this.stats.currFrame.fps.toFixed(2).toString(),10,10)}for(var s=0;s<this.postProcessors.length;s++)this.postProcessors[s].process(this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.ctx);this._postdraw(t,e)},g.prototype._predraw=function(e,t){this.emit("predraw",new h.PreDrawEvent(e,t,this)),this.onPreDraw(e,t)},g.prototype.onPreDraw=function(e,t){},g.prototype._postdraw=function(e,t){this.emit("postdraw",new h.PostDrawEvent(e,t,this)),this.onPostDraw(e,t)},g.prototype.onPostDraw=function(e,t){},g.prototype.start=function(e){var t,i=this;return this._compatible?(e?(this._loader=e,this._loader.suppressPlayButton=this._suppressPlayButton||this._loader.suppressPlayButton,this._loader.wireEngine(this),t=this.load(this._loader)):t=Promise.resolve(),t.then(function(){i.emit("start",new h.GameStartEvent(i))}),this._hasStarted||(this._hasStarted=!0,this._logger.debug("Starting game..."),this.browser.resume(),g.createMainLoop(this,window.requestAnimationFrame,Date.now)(),this._logger.debug("Game started")),t):Promise.reject("Excalibur is incompatible with your browser")},g.createMainLoop=function(e,t,i){var n=i();return function r(){if(e._hasStarted)try{e._requestId=t(r),e.emit("preframe",new h.PreFrameEvent(e,e.stats.prevFrame));var o=i(),s=Math.floor(o-n)||1;s>200&&(s=1);var a=s*e.timescale,c=e.stats.prevFrame.id+1;e.stats.prevFrame.reset(e.stats.currFrame),e.stats.currFrame.reset(),e.stats.currFrame.id=c,e.stats.currFrame.delta=a,e.stats.currFrame.fps=1/(a/1e3);var l=i();e._update(a);var p=i();e._draw(a);var u=i();e.stats.currFrame.duration.update=p-l,e.stats.currFrame.duration.draw=u-p,n=o,e.emit("postframe",new h.PostFrameEvent(e,e.stats.currFrame))}catch(d){window.cancelAnimationFrame(e._requestId),e.stop(),e.onFatalException(d)}}},g.prototype.stop=function(){this._hasStarted&&(this.emit("stop",new h.GameStopEvent(this)),this.browser.pause(),this._hasStarted=!1,this._logger.debug("Game stopped"))},g.prototype.isPaused=function(){return!this._hasStarted},g.prototype.screenshot=function(){var e=new Image,t=this.canvas.toDataURL("image/png");return e.src=t,e},g.prototype.load=function(e){var t=this;return new Promise(function(i){t._isLoading=!0,e.load().then(function(){t._suppressPlayButton?setTimeout(function(){t._isLoading=!1,i()},500):(t._isLoading=!1,i())})})},g._useWebGL=!1,g._useLegacyDrawing=!1,g._DefaultEngineOptions={width:0,height:0,enableCanvasTransparency:!0,canvasElementId:"",canvasElement:void 0,pointerScope:f.PointerScope.Document,suppressConsoleBootMessage:null,suppressMinimumBrowserFeatureDetection:null,suppressHiDPIScaling:null,suppressPlayButton:null,scrollPreventionMode:x.Canvas,backgroundColor:p.Color.fromHex("#2185d0")},g}(g.Class);exports.Engine=D;var M=function(){return function(e,t,i){this.animation=e,this.x=t,this.y=i}}();
},{"./":"A6Lr","./Polyfill":"oh18","./Algebra":"NGcQ","./ScreenElement":"PDm1","./Actor":"vmFf","./Timer":"y7ZJ","./TileMap":"QP5n","./Loader":"jUb1","./Util/Detector":"OWe5","./Events":"XySq","./Util/Log":"p1Gn","./Drawing/Color":"p7Gh","./Scene":"xS6v","./Debug":"haDW","./Class":"yTUi","./Input/Index":"aiZ2","./Collision/BoundingBox":"oyna","./Util/Browser":"ids7","./Graphics/Context/ExcaliburGraphicsContextWebGL":"xRtj","./Graphics/Context/ExcaliburGraphicsContext2DCanvas":"bjvb"}],"QGKl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NativeSoundProcessedEvent=exports.NativeSoundEvent=exports.MediaEvent=void 0;var t=require("../Events"),e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),n=function(t){function n(e,n){void 0===n&&(n="MediaEvent");var o=t.call(this)||this;return o.target=e,o._name=n,o}return e(n,t),Object.defineProperty(n.prototype,"bubbles",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_path",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),n.prototype.stopPropagation=function(){},n.prototype.action=function(){},n.prototype.propagate=function(){},n.prototype.layPath=function(t){},n}(t.GameEvent);exports.MediaEvent=n;var o=function(t){function n(e,n){var o=t.call(this,e,"NativeSoundEvent")||this;return o.track=n,o}return e(n,t),n}(n);exports.NativeSoundEvent=o;var r=function(t){function n(e,n){var o=t.call(this,e,"NativeSoundProcessedEvent")||this;return o.processedData=n,o.data=o.processedData,o}return e(n,t),n}(n);exports.NativeSoundProcessedEvent=r;
},{"../Events":"XySq"}],"oDmR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={Internal:!0,Actions:!0};exports.Actions=exports.Internal=void 0;var t=require("./ActionContext");Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});var r=require("./RotationType");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return r[t]}}))});var n=c(require("./Action"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var u=n?Object.getOwnPropertyDescriptor(e,c):null;u&&(u.get||u.set)?Object.defineProperty(r,c,u):r[c]=e[c]}return r.default=e,t&&t.set(e,r),r}exports.Actions=n;var u={Actions:n};exports.Internal=u;
},{"./ActionContext":"vA04","./RotationType":"DrJU","./Action":"gDdL"}],"qSfQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Animation=exports.AnimationImpl=void 0;var t=s(require("./SpriteEffects")),e=require("../Algebra"),i=require("../Engine"),r=s(require("../Util/Util")),n=require("../Configurable");function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=r?Object.getOwnPropertyDescriptor(t,n):null;s&&(s.get||s.set)?Object.defineProperty(i,n,s):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}var a=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),h=function(){function n(t,r,n,o){this.sprites=[],this.currentFrame=0,this._oldTime=Date.now(),this.anchor=e.Vector.Zero,this.rotation=0,this.scale=e.Vector.One,this.loop=!0,this.freezeFrame=-1,this.flipVertical=!1,this.flipHorizontal=!1,this.drawWidth=0,this.drawHeight=0,this.width=0,this.height=0;var s=t;if(t&&!(t instanceof i.Engine)){var a=t;s=a.engine,r=a.sprites,n=a.speed,o=a.loop}this.sprites=r,this.speed=n,this._engine=s,null!=o&&(this.loop=o),r&&r[0]&&(this.drawHeight=r[0]?r[0].drawHeight:0,this.drawWidth=r[0]?r[0].drawWidth:0,this.width=r[0]?r[0].width:0,this.height=r[0]?r[0].height:0,this.freezeFrame=r.length-1)}return n.prototype.opacity=function(e){this.addEffect(new t.Opacity(e))},n.prototype.grayscale=function(){this.addEffect(new t.Grayscale)},n.prototype.invert=function(){this.addEffect(new t.Invert)},n.prototype.fill=function(e){this.addEffect(new t.Fill(e))},n.prototype.colorize=function(e){this.addEffect(new t.Colorize(e))},n.prototype.lighten=function(e){void 0===e&&(e=.1),this.addEffect(new t.Lighten(e))},n.prototype.darken=function(e){void 0===e&&(e=.1),this.addEffect(new t.Darken(e))},n.prototype.saturate=function(e){void 0===e&&(e=.1),this.addEffect(new t.Saturate(e))},n.prototype.desaturate=function(e){void 0===e&&(e=.1),this.addEffect(new t.Desaturate(e))},n.prototype.addEffect=function(t){for(var e in this.sprites)this.sprites[e].addEffect(t)},n.prototype.removeEffect=function(t){for(var e in this.sprites)this.sprites[e].removeEffect(t)},n.prototype.clearEffects=function(){for(var t in this.sprites)this.sprites[t].clearEffects()},n.prototype._setAnchor=function(t){for(var e in this.sprites)this.sprites[e].anchor.setTo(t.x,t.y)},n.prototype._setRotation=function(t){for(var e in this.sprites)this.sprites[e].rotation=t},n.prototype._setScale=function(t){for(var e in this.sprites)this.sprites[e].scale=t},n.prototype.reset=function(){this.currentFrame=0},n.prototype.isDone=function(){return!this.loop&&this.currentFrame>=this.sprites.length},n.prototype.tick=function(){var t=Date.now();t-this._oldTime>this.speed&&(this.currentFrame=this.loop?(this.currentFrame+1)%this.sprites.length:this.currentFrame+1,this._oldTime=t)},n.prototype._updateValues=function(){this._setAnchor(this.anchor),this._setRotation(this.rotation),this._setScale(this.scale)},n.prototype.skip=function(t){this.currentFrame=(this.currentFrame+t)%this.sprites.length},n.prototype.draw=function(t,e,i){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:e,y:i,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}):this._drawWithOptions(t)},n.prototype._drawWithOptions=function(t){var e;this.tick(),this._updateValues(),this.currentFrame<this.sprites.length&&(e=this.sprites[this.currentFrame]).draw(t),-1!==this.freezeFrame&&this.currentFrame>=this.sprites.length&&(e=this.sprites[r.clamp(this.freezeFrame,0,this.sprites.length-1)]).draw(t),e&&(this.drawWidth=e.drawWidth,this.drawHeight=e.drawHeight)},n.prototype.play=function(t,e){this.reset(),this._engine.playAnimation(this,t,e)},n}();exports.AnimationImpl=h;var p=function(t){function e(e,i,r,n){return t.call(this,e,i,r,n)||this}return a(e,t),e}((0,n.Configurable)(h));exports.Animation=p;
},{"./SpriteEffects":"OEQf","../Algebra":"NGcQ","../Engine":"CIaB","../Util/Util":"Kkda","../Configurable":"A4Kj"}],"yps7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Polygon=void 0;var t=require("../Algebra"),i=require("../Util/Util"),o=function(){return(o=Object.assign||function(t){for(var i,o=1,e=arguments.length;o<e;o++)for(var r in i=arguments[o])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},e=function(){function e(i){this.lineWidth=5,this.filled=!1,this._points=[],this.anchor=t.Vector.Zero,this.offset=t.Vector.Zero,this.rotation=0,this.scale=t.Vector.One,this.opacity=1,this._points=i;var o=this._points.reduce(function(t,i){return Math.min(t,i.x)},0),e=this._points.reduce(function(t,i){return Math.max(t,i.x)},0);this.drawWidth=e-o;var r=this._points.reduce(function(t,i){return Math.min(t,i.y)},0),n=this._points.reduce(function(t,i){return Math.max(t,i.y)},0);this.drawHeight=n-r,this.height=this.drawHeight,this.width=this.drawWidth}return e.prototype.addEffect=function(){},e.prototype.removeEffect=function(){},e.prototype.clearEffects=function(){},e.prototype.reset=function(){},e.prototype.draw=function(t,i,o){t instanceof CanvasRenderingContext2D?this._drawWithOptions({ctx:t,x:i,y:o}):this._drawWithOptions(t)},e.prototype._drawWithOptions=function(t){var e=o(o({},t),{rotation:(0,i.nullish)(t.rotation,this.rotation),drawWidth:(0,i.nullish)(t.drawWidth,this.drawWidth),drawHeight:(0,i.nullish)(t.drawHeight,this.drawHeight),flipHorizontal:(0,i.nullish)(t.flipHorizontal,this.flipHorizontal),flipVertical:(0,i.nullish)(t.flipVertical,this.flipVertical),anchor:(0,i.nullish)(t.anchor,this.anchor),offset:(0,i.nullish)(t.offset,this.offset),opacity:(0,i.nullish)(t.opacity,this.opacity)}),r=e.ctx,n=e.x,s=e.y,a=e.rotation,h=e.drawWidth,l=e.drawHeight,c=e.anchor,p=e.offset,f=e.opacity,u=e.flipHorizontal,d=e.flipVertical,y=h*c.x+p.x+n,g=l*c.y+p.y+s;r.save(),r.translate(y,g),r.scale(this.scale.x,this.scale.y),r.rotate(a),r.beginPath(),r.lineWidth=this.lineWidth;var w=this._points[0];r.moveTo(w.x,w.y);for(var x=0,v=this._points.length;x<v;x++)r.lineTo(this._points[x].x,this._points[x].y);r.lineTo(w.x,w.y),r.closePath(),this.filled&&(r.fillStyle=this.fillColor.toString(),r.fill()),r.strokeStyle=this.lineColor.toString(),u&&(r.translate(h,0),r.scale(-1,1)),d&&(r.translate(0,l),r.scale(1,-1));var _=r.globalAlpha;r.globalAlpha=(0,i.nullish)(f,1),r.stroke(),r.globalAlpha=_,r.restore()},e}();exports.Polygon=e;
},{"../Algebra":"NGcQ","../Util/Util":"Kkda"}],"ikZV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpriteFont=exports.SpriteFontImpl=exports.SpriteSheet=exports.SpriteSheetImpl=void 0;var t=require("./Sprite"),e=require("./Animation"),i=require("./Color"),r=p(require("./SpriteEffects")),s=require("../Resources/Texture"),n=require("../Util/Log"),o=require("../Label"),a=require("../Configurable");function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function p(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var n=r?Object.getOwnPropertyDescriptor(t,s):null;n&&(n.get||n.set)?Object.defineProperty(i,s,n):i[s]=t[s]}return i.default=t,e&&e.set(t,i),i}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(){function i(e,i,r,n,o,a){this.sprites=[],this.image=null,this.columns=0,this.rows=0,this.spWidth=0,this.spHeight=0,this.spacing=0;var h=!1;if(e instanceof Array?this.sprites=e:(!e||e instanceof s.Texture?(this.image=e,this.columns=i,this.rows=r,this.spWidth=n,this.spHeight=o,this.spacing=a||0):(this.columns=e.columns,this.rows=e.rows,this.spWidth=e.spWidth,this.spHeight=e.spHeight,this.image=e.image,this.spacing=e.spacing||0),this.sprites=new Array(this.columns*this.rows),h=!0),this.image instanceof s.Texture){var p=!1,l=!1;if(this.image.isLoaded()&&(p=this.spWidth*this.columns>this.image.image.naturalWidth,l=this.spHeight*this.rows>this.image.image.naturalHeight),p)throw new RangeError("SpriteSheet specified is wider, "+this.columns+" cols x "+this.spWidth+" pixels > "+this.image.image.naturalWidth+" pixels than image width");if(l)throw new RangeError("SpriteSheet specified is taller, "+this.rows+" rows x "+this.spHeight+" pixels > "+this.image.image.naturalHeight+" pixels than image height")}if(h)for(var c=0;c<this.rows;c++)for(var u=0;u<this.columns;u++)this.sprites[u+c*this.columns]=new t.Sprite(this.image,u*this.spWidth+this.spacing*u+this.spacing,c*this.spHeight+this.spacing*c+this.spacing,this.spWidth,this.spHeight)}return i.prototype.getAnimationByIndices=function(t,i,r){var s=this,n=i.map(function(t){return s.sprites[t]});return n=n.map(function(t){return t.clone()}),new e.Animation(t,n,r)},i.prototype.getAnimationBetween=function(t,i,r,s){var n=this.sprites.slice(i,r);return n=n.map(function(t){return t.clone()}),new e.Animation(t,n,s)},i.prototype.getAnimationForAll=function(t,i){var r=this.sprites.map(function(t){return t.clone()});return new e.Animation(t,r,i)},i.prototype.getSprite=function(t){if(t>=0&&t<this.sprites.length)return this.sprites[t];throw new Error("Invalid index: "+t)},i.prototype.getAnimationByCoords=function(i,r,s){for(var n=0,o=0,a=new Array(r.length),h=0;h<r.length;h++){var p=r[h];p.image=p.image||this.image,n=Math.max(n,p.drawWidth),o=Math.max(o,p.drawHeight),a[h]=new t.Sprite(p)}var l=new e.Animation(i,a,s);return l.drawWidth=n,l.drawHeight=o,l},i}();exports.SpriteSheetImpl=u;var g=function(t){function e(e,i,r,s,n,o){return t.call(this,e,i,r,s,n,o)||this}return c(e,t),e}((0,a.Configurable)(u));exports.SpriteSheet=g;var f=function(t){function e(e,r,n,o,a,h,p,l){var c=t.call(this,e instanceof s.Texture?{image:e,spWidth:h,spHeight:p,rows:a,columns:o,spacing:l||0}:e)||this;return c._currentColor=i.Color.Black,c._currentOpacity=1,c._sprites={},c._textShadowOn=!1,c._textShadowDirty=!0,c._textShadowColor=i.Color.Black,c._textShadowSprites={},c._shadowOffsetX=5,c._shadowOffsetY=5,!e||e instanceof s.Texture||(r=e.alphabet,n=e.caseInsensitive),c._alphabet=r,c._caseInsensitive=n,c._sprites=c.getTextSprites(),c}return c(e,t),e.prototype.getTextSprites=function(){for(var t={},e=0;e<this._alphabet.length;e++){var i=this._alphabet[e];this._caseInsensitive&&(i=i.toLowerCase()),t[i]=this.sprites[e].clone()}return t},e.prototype.setTextShadow=function(t,e,i){for(var r in this._textShadowOn=!0,this._shadowOffsetX=t,this._shadowOffsetY=e,this._textShadowColor=i.clone(),this._textShadowDirty=!0,this._sprites)this._textShadowSprites[r]=this._sprites[r].clone()},e.prototype.useTextShadow=function(t){this._textShadowOn=t,t&&this.setTextShadow(5,5,this._textShadowColor)},e.prototype.draw=function(t,e,i,s,a){if(a=this._parseOptions(a),this._currentColor.toString()!==a.color.toString()||this._currentOpacity!==a.opacity)for(var h in this._currentOpacity=a.opacity,this._currentColor=a.color,this._sprites)this._sprites[h].clearEffects(),this._sprites[h].fill(a.color),this._sprites[h].opacity(a.opacity);if(this._textShadowOn&&this._textShadowDirty&&this._textShadowColor){for(var p in this._textShadowSprites)this._textShadowSprites[p].clearEffects(),this._textShadowSprites[p].addEffect(new r.Fill(this._textShadowColor.clone()));this._textShadowDirty=!1}var l=this.sprites[0],c=l.drawHeight,u=a.fontSize/c,g=e.length*l.drawWidth*u+e.length*a.letterSpacing,f=i;a.textAlign===o.TextAlign.Left||a.textAlign===o.TextAlign.Start?f=i:a.textAlign===o.TextAlign.Right||a.textAlign===o.TextAlign.End?f=i-g:a.textAlign===o.TextAlign.Center&&(f=i-g/2);var d=s-c*u;a.baseAlign===o.BaseAlign.Top||a.baseAlign===o.BaseAlign.Hanging?d=s:a.baseAlign===o.BaseAlign.Ideographic||a.baseAlign===o.BaseAlign.Bottom||a.baseAlign===o.BaseAlign.Alphabetic?d=s-c*u:a.baseAlign===o.BaseAlign.Middle&&(d=s-c*u/2);for(var w=0;w<e.length;w++){var S=e[w];this._caseInsensitive&&(S=S.toLowerCase());try{this._textShadowOn&&(this._textShadowSprites[S].scale.x=u,this._textShadowSprites[S].scale.y=u,this._textShadowSprites[S].draw(t,f+this._shadowOffsetX,d+this._shadowOffsetY));var x=this._sprites[S];x.scale.x=u,x.scale.y=u,x.draw(t,f,d),f+=x.drawWidth+a.letterSpacing}catch(_){n.Logger.getInstance().error("SpriteFont Error drawing char "+S)}}},e.prototype._parseOptions=function(t){return{fontSize:t.fontSize||10,letterSpacing:t.letterSpacing||0,color:t.color||i.Color.Black,textAlign:void 0===l(t.textAlign)?o.TextAlign.Left:t.textAlign,baseAlign:void 0===l(t.baseAlign)?o.BaseAlign.Bottom:t.baseAlign,maxWidth:t.maxWidth||-1,opacity:t.opacity||0}},e}(g);exports.SpriteFontImpl=f;var d=function(t){function e(e,i,r,s,n,o,a,h){return t.call(this,e,i,r,s,n,o,a,h)||this}return c(e,t),e}((0,a.Configurable)(f));exports.SpriteFont=d;
},{"./Sprite":"PpGD","./Animation":"qSfQ","./Color":"p7Gh","./SpriteEffects":"OEQf","../Resources/Texture":"HrNa","../Util/Log":"p1Gn","../Label":"rRqb","../Configurable":"A4Kj"}],"vS88":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={Animation:!0,Sprite:!0,SpriteSheet:!0,SpriteFont:!0,Effects:!0};Object.defineProperty(exports,"Animation",{enumerable:!0,get:function(){return t.Animation}}),Object.defineProperty(exports,"Sprite",{enumerable:!0,get:function(){return o.Sprite}}),Object.defineProperty(exports,"SpriteSheet",{enumerable:!0,get:function(){return i.SpriteSheet}}),Object.defineProperty(exports,"SpriteFont",{enumerable:!0,get:function(){return i.SpriteFont}}),exports.Effects=void 0;var t=require("./Animation"),r=require("./Color");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return r[t]}}))});var n=require("./Polygon");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return n[t]}}))});var o=require("./Sprite"),i=require("./SpriteSheet"),u=f(require("./SpriteEffects"));function p(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return p=function(){return e},e}function f(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=p();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}exports.Effects=u;
},{"./Animation":"qSfQ","./Color":"p7Gh","./Polygon":"yps7","./Sprite":"PpGD","./SpriteSheet":"ikZV","./SpriteEffects":"OEQf"}],"TThz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExResponse=void 0;var e=function(){function e(){}return e.type={any:"",blob:"blob",json:"json",text:"text",document:"document",arraybuffer:"arraybuffer"},e}();exports.ExResponse=e;
},{}],"scJm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./AudioImplementation");Object.keys(e).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(exports,t,{enumerable:!0,get:function(){return e[t]}})});
},{"./AudioImplementation":"TThz"}],"iCJC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PerlinDrawer2D=exports.PerlinGenerator=void 0;var t=require("./Random"),r=require("../Drawing/Color"),e=n(require("../Util/Util"));function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=i();if(r&&r.has(t))return r.get(t);var e={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=n?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(e,o,a):e[o]=t[o]}return e.default=t,r&&r.set(t,e),e}function o(t,r,e){return r+t*(e-r)}function a(t){return t*t*t*(t*(6*t-15)+10)}var s=function(){function r(r){this._perm=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this._p=new Uint8Array(512),this._defaultPerlinOptions={octaves:1,frequency:1,amplitude:1,persistance:.5},r=e.extend({},this._defaultPerlinOptions,r),this.persistance=r.persistance,this.amplitude=r.amplitude,this.frequency=r.frequency,this.octaves=r.octaves,r.seed?this._random=new t.Random(r.seed):this._random=new t.Random,this._perm=this._random.shuffle(this._perm);for(var i=0;i<512;i++)this._p[i]=255&this._perm[i%256]}return r.prototype.noise=function(){for(var t=this.amplitude,r=this.frequency,e=0,i=0,n=0;n<this.octaves;n++){switch(arguments.length){case 1:e+=this._noise1d(arguments[0]*r)*t;break;case 2:e+=this._noise2d(arguments[0]*r,arguments[1]*r)*t;break;case 3:e+=this._noise3d(arguments[0]*r,arguments[1]*r,arguments[2]*r)*t;break;default:throw new Error("Invalid arguments for perlin noise")}i+=t,t*=this.persistance,r*=2}return e/i},r.prototype.sequence=function(t,r){r||(r=1/t);for(var e=new Array(t),i=0;i<t;i++)e[i]=this.noise(i*r);return e},r.prototype.grid=function(t,r,e){e||(e=1/Math.min(t,r));for(var i=new Array(t*r),n=0;n<r;n++)for(var o=0;o<t;o++)i[o+n*t]=this.noise(o*e,n*e);return i},r.prototype._gradient3d=function(t,r,e,i){var n=15&t,o=n<8?r:e,a=n<4?e:12===n||14===n?r:i;return(0==(1&n)?o:-o)+(0==(2&n)?a:-a)},r.prototype._gradient2d=function(t,r,e){var i=0==(1&t)?r:e;return 0==(2&t)?-i:i},r.prototype._gradient1d=function(t,r){return 0==(1&t)?-r:r},r.prototype._noise1d=function(t){var r=255&Math.floor(t);return(o(a(t-=Math.floor(t)),this._gradient1d(this._p[r],t),this._gradient1d(this._p[r+1],t-1))+1)/2},r.prototype._noise2d=function(t,r){var e=255&Math.floor(t),i=255&Math.floor(r);t-=Math.floor(t),r-=Math.floor(r);var n=a(t),s=a(r),h=this._p[e]+i,p=this._p[e+1]+i;return(o(s,o(n,this._gradient2d(this._p[h],t,r),this._gradient2d(this._p[p],t-1,r)),o(n,this._gradient2d(this._p[h+1],t,r-1),this._gradient2d(this._p[p+1],t-1,r-1)))+1)/2},r.prototype._noise3d=function(t,r,e){var i=255&Math.floor(t),n=255&Math.floor(r),s=255&Math.floor(e);t-=Math.floor(t),r-=Math.floor(r),e-=Math.floor(e);var h=a(t),p=a(r),d=a(e),u=this._p[i]+n,f=this._p[i+1]+n,c=this._p[u]+s,_=this._p[f]+s,l=this._p[u+1]+s,g=this._p[f+1]+s;return(o(d,o(p,o(h,this._gradient3d(this._p[c],t,r,e),this._gradient3d(this._p[_],t-1,r,e)),o(h,this._gradient3d(this._p[l],t,r-1,e),this._gradient3d(this._p[g],t-1,r-1,e))),o(p,o(h,this._gradient3d(this._p[c+1],t,r,e-1),this._gradient3d(this._p[_+1],t-1,r,e-1)),o(h,this._gradient3d(this._p[l+1],t,r-1,e-1),this._gradient3d(this._p[g+1],t-1,r-1,e-1))))+1)/2},r}();exports.PerlinGenerator=s;var h=function(){function t(t,e){this.generator=t,this.colorFcn=e,e||(this.colorFcn=function(t){return t<125?r.Color.Black:r.Color.White})}return t.prototype.image=function(t,r){var e=document.createElement("img"),i=document.createElement("canvas");i.width=t,i.height=r;var n=i.getContext("2d");return this.draw(n,0,0,t,r),e.src=i.toDataURL(),e},t.prototype.draw=function(t,r,e,i,n){for(var o=this.generator.grid(i,n),a=t.getImageData(r,e,i,n),s=0;s<n;s++)for(var h=0;h<i;h++){var p=o[h+i*s],d=255&Math.floor(255*p),u=4*(h+s*a.width),f=this.colorFcn(d);a.data[u]=f.r,a.data[u+1]=f.g,a.data[u+2]=f.b,a.data[u+3]=Math.floor(255*f.a)}t.putImageData(a,r,e)},t}();exports.PerlinDrawer2D=h;
},{"./Random":"yYMg","../Drawing/Color":"p7Gh","../Util/Util":"Kkda"}],"HAdL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./PerlinNoise");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./Random");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});
},{"./PerlinNoise":"iCJC","./Random":"yYMg"}],"cjjJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorBlindCorrector=exports.ColorBlindness=void 0;var t,r=require("./../Util/Log");exports.ColorBlindness=t,function(t){t[t.Protanope=0]="Protanope",t[t.Deuteranope=1]="Deuteranope",t[t.Tritanope=2]="Tritanope"}(t||(exports.ColorBlindness=t={}));var e=function(){function e(e,i,o){void 0===i&&(i=!1),void 0===o&&(o=t.Protanope),this.engine=e,this.simulate=i,this.colorMode=o,this._vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}",this._fragmentShader="precision mediump float;uniform sampler2D u_image;varying vec2 v_texCoord;void main() {vec4 o =  texture2D(u_image, v_texCoord);float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);//MODE CODE//vec4 error;error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);error.a = 1.0;vec4 diff = o - error;vec4 correction;correction.r = 0.0;correction.g =  (diff.r * 0.7) + (diff.g * 1.0);correction.b =  (diff.r * 0.7) + (diff.b * 1.0);correction = o + correction;correction.a = o.a;//SIMULATE//}",this._internalCanvas=document.createElement("canvas"),this._internalCanvas.width=e.drawWidth,this._internalCanvas.height=e.drawHeight,this._gl=this._internalCanvas.getContext("webgl",{preserveDrawingBuffer:!0}),this._program=this._gl.createProgram();var a=this._getShader("Fragment",this._getFragmentShaderByMode(o)),s=this._getShader("Vertex",this._vertexShader);this._gl.attachShader(this._program,s),this._gl.attachShader(this._program,a),this._gl.linkProgram(this._program),this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)||r.Logger.getInstance().error("Unable to link shader program!"),this._gl.useProgram(this._program)}return e.prototype._getFragmentShaderByMode=function(r){var e="";return r===t.Protanope?e="float l = 0.0 * L + 2.02344 * M + -2.52581 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":r===t.Deuteranope?e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.494207 * L + 0.0 * M + 1.24827 * S;float s = 0.0 * L + 0.0 * M + 1.0 * S;":r===t.Tritanope&&(e="float l = 1.0 * L + 0.0 * M + 0.0 * S;float m = 0.0 * L + 1.0 * M + 0.0 * S;float s = -0.395913 * L + 0.801109 * M + 0.0 * S;"),this.simulate?this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = error.rgba;"):this._fragmentShader=this._fragmentShader.replace("//SIMULATE//","gl_FragColor = correction.rgba;"),this._fragmentShader.replace("//MODE CODE//",e)},e.prototype._setRectangle=function(t,r,e,i){var o=t,a=t+e,s=r,_=r+i;this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([o,s,a,s,o,_,o,_,a,s,a,_]),this._gl.STATIC_DRAW)},e.prototype._getShader=function(t,e){var i;return"Fragment"===t?i=this._gl.createShader(this._gl.FRAGMENT_SHADER):"Vertex"===t?i=this._gl.createShader(this._gl.VERTEX_SHADER):r.Logger.getInstance().error("Error unknown shader type",t),this._gl.shaderSource(i,e),this._gl.compileShader(i),this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS)?i:(r.Logger.getInstance().error("Unable to compile shader!",this._gl.getShaderInfoLog(i)),null)},e.prototype.process=function(t,r){var e=this._gl.getAttribLocation(this._program,"a_position"),i=this._gl.getAttribLocation(this._program,"a_texCoord"),o=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,o),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this._gl.STATIC_DRAW),this._gl.enableVertexAttribArray(i),this._gl.vertexAttribPointer(i,2,this._gl.FLOAT,!1,0,0);var a=this._gl.createTexture();this._gl.bindTexture(this._gl.TEXTURE_2D,a),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,1),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,t);var s=this._gl.getUniformLocation(this._program,"u_resolution");this._gl.uniform2f(s,this._internalCanvas.width,this._internalCanvas.height);var _=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,_),this._gl.enableVertexAttribArray(e),this._gl.vertexAttribPointer(e,2,this._gl.FLOAT,!1,0,0),this._setRectangle(0,0,t.width,t.height),this._gl.drawArrays(this._gl.TRIANGLES,0,6);var g=new Uint8Array(t.width*t.height*4);this._gl.readPixels(0,0,t.width,t.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,g),t.data.set(g),r.putImageData(t,0,0)},e}();exports.ColorBlindCorrector=e;
},{"./../Util/Log":"p1Gn"}],"mhi9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./ColorBlindCorrector");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});
},{"./ColorBlindCorrector":"cjjJ"}],"oBMS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebAudioInstance=exports.AudioTagInstance=exports.AudioInstance=exports.AudioInstanceFactory=void 0;var t=i(require("../../Util/Util")),e=require("./AudioContext");function n(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}function i(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n();if(e&&e.has(t))return e.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var r=o?Object.getOwnPropertyDescriptor(t,s):null;r&&(r.get||r.set)?Object.defineProperty(i,s,r):i[s]=t[s]}return i.default=t,e&&e.set(t,i),i}var o=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),s=function(){function t(){}return t.create=function(t){return"string"==typeof t?new a(t):t instanceof AudioBuffer?new u(t):new r(t)},t}();exports.AudioInstanceFactory=s;var r=function(){function e(t){this._src=t,this._volume=1,this._duration=void 0,this._loop=!1,this._isPlaying=!1,this._isPaused=!1}return Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._instance&&(this._instance.loop=t,this._wireUpOnEnded())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=t.clamp(e,0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},set:function(t){this._duration=t},enumerable:!0,configurable:!0}),e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.pause=function(){this._isPlaying&&(this._isPaused=!0,this._isPlaying=!1)},e.prototype.stop=function(){this._isPlaying&&(this._isPlaying=!1,this._isPaused=!1)},e.prototype.play=function(){return this._isPaused&&this._resumePlayBack(),this._isPlaying||this._startPlayBack(),this._playingPromise},e.prototype._startPlayBack=function(){var t=this;this._isPlaying=!0,this._isPaused=!1,this._playingPromise=new Promise(function(e){t._playingResolve,t._playingResolve=e})},e.prototype._resumePlayBack=function(){this._isPaused&&(this._isPaused=!1,this._isPlaying=!0)},e.prototype._wireUpOnEnded=function(){var t=this;this.loop||(this._instance.onended=function(){return t._handleOnEnded()})},e.prototype._handleOnEnded=function(){this._playingResolve(!0)},e}();exports.AudioInstance=r;var a=function(e){function n(t){var n=e.call(this,t)||this;return n._instance=new Audio(t),n}return o(n,e),Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(e){e=t.clamp(e,0,1),this._volume=e,this._instance.volume=e},enumerable:!0,configurable:!0}),n.prototype.pause=function(){this._isPlaying&&(this._instance.pause(),this._isPaused=!0,this._isPlaying=!1)},n.prototype.stop=function(){e.prototype.stop.call(this),this._instance.pause(),this._instance.currentTime=0,this._handleOnEnded()},n.prototype._startPlayBack=function(){e.prototype._startPlayBack.call(this),this._instance.load(),this._instance.loop=this.loop,this._instance.play(),this._wireUpOnEnded()},n.prototype._resumePlayBack=function(){e.prototype._resumePlayBack.call(this),this._instance.play(),this._wireUpOnEnded()},n.prototype._handleOnEnded=function(){this._isPlaying=!1,this._isPaused=!1,e.prototype._handleOnEnded.call(this)},n}(r);exports.AudioTagInstance=a;var u=function(n){function i(t){var i=n.call(this,t)||this;return i._audioContext=e.AudioContextFactory.create(),i._volumeNode=i._audioContext.createGain(),i._currentOffset=0,i._createNewBufferSource(),i}return o(i,n),Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){e=t.clamp(e,0,1),this._volume=e,this._isPlaying&&this._volumeNode.gain.setTargetAtTime?this._volumeNode.gain.setTargetAtTime(e,this._audioContext.currentTime,.1):this._volumeNode.gain.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_playbackRate",{get:function(){return this._instance?1/(this._instance.playbackRate.value||1):null},enumerable:!0,configurable:!0}),i.prototype.pause=function(){n.prototype.pause.call(this),this._instance.stop(0),this._setPauseOffset()},i.prototype.stop=function(){n.prototype.stop.call(this),this._currentOffset=0,this._instance.stop(0),this._instance.onended||this._handleOnEnded()},i.prototype._startPlayBack=function(){n.prototype._startPlayBack.call(this),this._instance||this._createNewBufferSource(),this._rememberStartTime(),this._volumeNode.connect(this._audioContext.destination),this._instance.start(0,0),this._currentOffset=0,this._wireUpOnEnded()},i.prototype._resumePlayBack=function(){n.prototype._resumePlayBack.call(this),this._instance.onended=null,this._createNewBufferSource();var t=this._playbackRate*this._src.duration,e=this._currentOffset%t;this._rememberStartTime(-1e3*e),this._instance.start(0,e),this._wireUpOnEnded()},i.prototype._handleOnEnded=function(){this._isPaused||(this._isPlaying=!1,n.prototype._handleOnEnded.call(this))},i.prototype._rememberStartTime=function(t){this._startTime=(new Date).getTime()+(0|t)},i.prototype._setPauseOffset=function(){this._currentOffset=((new Date).getTime()-this._startTime)*this._playbackRate/1e3},i.prototype._createNewBufferSource=function(){this._instance=this._audioContext.createBufferSource(),this._instance.buffer=this._src,this._instance.loop=this.loop,this._instance.playbackRate.setValueAtTime(1,0),this._instance.connect(this._volumeNode)},i}(r);exports.WebAudioInstance=u;
},{"../../Util/Util":"Kkda","./AudioContext":"hSwP"}],"Gbl6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canPlayFile=r;var e=require("./Log");function r(r){try{var t=new Audio,a=r.match(/.*\.([A-Za-z0-9]+)$/)[1];return!!t.canPlayType("audio/"+a)}catch(n){return e.Logger.getInstance().warn("Cannot determine audio support, assuming no support for the Audio Tag",n),!1}}
},{"./Log":"p1Gn"}],"cD70":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sound=void 0;var t=require("../../Interfaces/AudioImplementation"),e=require("../Resource"),o=require("./AudioInstance"),n=require("./AudioContext"),r=require("../../Events/MediaEvents"),i=require("../../Util/Sound");function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,o=e&&t[e],n=0;if(o)return o.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(e){function c(){for(var t,o,r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];var a=e.call(this,"","")||this;a._loop=!1,a._volume=1,a._duration=void 0,a._isStopped=!1,a._isPaused=!1,a._tracks=[],a._wasPlayingOnHidden=!1,a._processedData=new Promise(function(t){a._processedDataResolve=t}),a._audioContext=n.AudioContextFactory.create(),a._detectResponseType();try{for(var c=u(r),l=c.next();!l.done;l=c.next()){var p=l.value;if((0,i.canPlayFile)(p)){a.path=p;break}}}catch(f){t={error:f}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(t)throw t.error}}return a.path||(a.logger.warn("This browser does not support any of the audio files specified:",r.join(", ")),a.logger.warn("Attempting to use",r[0]),a.path=r[0]),a}return a(c,e),Object.defineProperty(c.prototype,"loop",{get:function(){return this._loop},set:function(t){var e,o;this._loop=t;try{for(var n=u(this._tracks),r=n.next();!r.done;r=n.next()){r.value.loop=this._loop}}catch(i){e={error:i}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(e)throw e.error}}this.logger.debug("Set loop for all instances of sound",this.path,"to",this._loop)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"volume",{get:function(){return this._volume},set:function(t){var e,o;this._volume=t;try{for(var n=u(this._tracks),i=n.next();!i.done;i=n.next()){i.value.volume=this._volume}}catch(s){e={error:s}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(e)throw e.error}}this.emit("volumechange",new r.NativeSoundEvent(this)),this.logger.debug("Set loop for all instances of sound",this.path,"to",this._volume)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"instances",{get:function(){return this._tracks},enumerable:!0,configurable:!0}),c.prototype.wireEngine=function(t){var e=this;t&&(this._engine=t,this._engine.on("hidden",function(){t.pauseAudioWhenHidden&&e.isPlaying()&&(e._wasPlayingOnHidden=!0,e.pause())}),this._engine.on("visible",function(){t.pauseAudioWhenHidden&&e._wasPlayingOnHidden&&(e.play(),e._wasPlayingOnHidden=!1)}),this._engine.on("start",function(){e._isStopped=!1}),this._engine.on("stop",function(){e.stop(),e._isStopped=!0}))},c.prototype.instanceCount=function(){return this._tracks.length},c.prototype.isPlaying=function(){return this._tracks.some(function(t){return t.isPlaying()})},c.prototype.play=function(t){return this.isLoaded()?this._isStopped?(this.logger.warn("Cannot start playing. Engine is in a stopped state."),Promise.resolve(!1)):(this.volume=t||this.volume,this._isPaused?this._resumePlayback():this._startPlayback()):(this.logger.warn("Cannot start playing. Resource",this.path,"is not loaded yet"),Promise.resolve(!0))},c.prototype.pause=function(){var t,e;if(this.isPlaying()){try{for(var o=u(this._tracks),n=o.next();!n.done;n=o.next()){n.value.pause()}}catch(i){t={error:i}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this._isPaused=!0,this.emit("pause",new r.NativeSoundEvent(this)),this.logger.debug("Paused all instances of sound",this.path)}},c.prototype.stop=function(){var t,e;try{for(var o=u(this._tracks),n=o.next();!n.done;n=o.next()){n.value.stop()}}catch(i){t={error:i}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.emit("stop",new r.NativeSoundEvent(this)),this._isPaused=!1,this._tracks.length=0,this.logger.debug("Stopped all instances of sound",this.path)},c.prototype.setData=function(t){this.emit("emptied",new r.NativeSoundEvent(this)),this.data=t},c.prototype.processData=function(t){var e=this;return(t instanceof ArrayBuffer?this._processArrayBufferData(t):this._processBlobData(t)).then(function(t){return e._setProcessedData(t),t})},c.prototype.getTrackId=function(t){return this._tracks.indexOf(t)},c.prototype._resumePlayback=function(){var t,e;if(this._isPaused){var o=[];try{for(var n=u(this._tracks),i=n.next();!i.done;i=n.next()){var s=i.value;o.push(s.play())}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return this._isPaused=!1,this.emit("resume",new r.NativeSoundEvent(this)),this.logger.debug("Resuming paused instances for sound",this.path,this._tracks),Promise.all(o).then(function(){return!0})}return Promise.resolve(!0)},c.prototype._startPlayback=function(){var t,e=this,o=this._createNewTrack(),n=new Promise(function(e){t=e});return o.then(function(o){o.play().then(function(n){return e.emit("playbackend",new r.NativeSoundEvent(e,o)),e._tracks.splice(e.getTrackId(o),1),t(n),n}),e.emit("playbackstart",new r.NativeSoundEvent(e,o)),e.logger.debug("Playing new instance for sound",e.path)}),n},c.prototype._processArrayBufferData=function(t){var e=this;return new Promise(function(o){e._audioContext.decodeAudioData(t,function(t){o(t)},function(){e.logger.error("Unable to decode  this browser may not fully support this format, or the file may be corrupt, if this is an mp3 try removing id3 tags and album art from the file."),o(void 0)})})},c.prototype._processBlobData=function(t){return Promise.resolve(e.prototype.processData.call(this,t))},c.prototype._setProcessedData=function(t){this._processedDataResolve(t),this._duration="object"===s(t)?t.duration:void 0,this.emit("processed",new r.NativeSoundProcessedEvent(this,t))},c.prototype._createNewTrack=function(){var t=this;return this.processData(this.data),new Promise(function(e){t._processedData.then(function(o){return e(t._getTrackInstance(o)),o},function(e){t.logger.error(e,"Cannot create AudioInstance due to wrong processed data.")})})},c.prototype._getTrackInstance=function(t){var e=o.AudioInstanceFactory.create(t);return e.loop=this.loop,e.volume=this.volume,e.duration=this.duration,this._tracks.push(e),e},c.prototype._detectResponseType=function(){window.AudioContext?this.responseType=t.ExResponse.type.arraybuffer:this.responseType=t.ExResponse.type.blob},c}(e.Resource);exports.Sound=c;
},{"../../Interfaces/AudioImplementation":"TThz","../Resource":"lN80","./AudioInstance":"oBMS","./AudioContext":"hSwP","../../Events/MediaEvents":"QGKl","../../Util/Sound":"Gbl6"}],"ANin":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Sound");Object.keys(e).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(exports,t,{enumerable:!0,get:function(){return e[t]}})});var t=require("./AudioContext");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var r=require("./AudioInstance");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});
},{"./Sound":"cD70","./AudioContext":"hSwP","./AudioInstance":"oBMS"}],"A4zr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParseGif=exports.Stream=exports.Gif=void 0;var e=require("./Resource"),t=require("./Texture"),r=require("../Drawing/Color"),n=require("../Drawing/SpriteSheet"),a=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=function(e){function o(t,n,a){void 0===n&&(n=r.Color.Magenta),void 0===a&&(a=!0);var o=e.call(this,t,"arraybuffer",a)||this;return o.path=t,o.color=n,o.bustCache=a,o.loaded=new Promise(function(e){o._loadedResolve=e}),o._isLoaded=!1,o._stream=null,o._gif=null,o._textures=[],o._animation=null,o._transparentColor=null,o._transparentColor=n,o}return a(o,e),o.prototype.isLoaded=function(){return this._isLoaded},o.prototype.load=function(){var r=this;return new Promise(function(n,a){e.prototype.load.call(r).then(function(){r._stream=new l(r.getData()),r._gif=new d(r._stream,r._transparentColor);for(var e=[],a=0;a<r._gif.images.length;a++){var o=new t.Texture(r._gif.images[a].src,!1);r._textures.push(o),e.push(o.load())}Promise.all(e).then(function(){r._isLoaded=!0,r._loadedResolve(r._textures),n(r._textures)})},function(){a("Error loading texture.")})})},o.prototype.asSprite=function(e){return void 0===e&&(e=0),this._textures[e].asSprite()},o.prototype.asSpriteSheet=function(){var e=this._textures.map(function(e){return e.asSprite()});return new n.SpriteSheet(e)},o.prototype.asAnimation=function(e,t){var r=this.asSpriteSheet();return this._animation=r.getAnimationForAll(e,t),this._animation},Object.defineProperty(o.prototype,"readCheckBytes",{get:function(){return this._gif.checkBytes},enumerable:!0,configurable:!0}),o}(e.Resource);exports.Gif=o;var i=function(e){return e.reduce(function(e,t){return 2*e+t},0)},s=function(e){for(var t=[],r=7;r>=0;r--)t.push(!!(e&1<<r));return t},l=function(){return function(e){var t=this;if(this.data=null,this.len=0,this.position=0,this.readByte=function(){if(t.position>=t.data.byteLength)throw new Error("Attempted to read past end of stream.");return t.data[t.position++]},this.readBytes=function(e){for(var r=[],n=0;n<e;n++)r.push(t.readByte());return r},this.read=function(e){for(var r="",n=0;n<e;n++)r+=String.fromCharCode(t.readByte());return r},this.readUnsigned=function(){var e=t.readBytes(2);return(e[1]<<8)+e[0]},this.data=new Uint8Array(e),this.len=this.data.byteLength,0===this.len)throw new Error("No data loaded from file")}}();exports.Stream=l;var h=function(e,t){for(var r,n,a=0,o=function(e){for(var r=0,n=0;n<e;n++)t.charCodeAt(a>>3)&1<<(7&a)&&(r|=1<<n),a++;return r},i=[],s=1<<e,l=s+1,h=e+1,d=[],c=function(){d=[],h=e+1;for(var t=0;t<s;t++)d[t]=[t];d[s]=[],d[l]=null};;)if(n=r,(r=o(h))!==s){if(r===l)break;if(r<d.length)n!==s&&d.push(d[n].concat(d[r][0]));else{if(r!==d.length)throw new Error("Invalid LZW code.");d.push(d[n].concat(d[n][0]))}i.push.apply(i,d[r]),d.length===1<<h&&h<12&&h++}else c();return i},d=function(){return function(e,t){var n=this;void 0===t&&(t=r.Color.Magenta),this._st=null,this._handler={},this._transparentColor=null,this.frames=[],this.images=[],this.globalColorTable=[],this.checkBytes=[],this.parseColorTable=function(e){for(var t=[],r=0;r<e;r++){var a="#"+n._st.readBytes(3).map(function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}).join("");t.push(a)}return t},this.readSubBlocks=function(){var e,t;t="";do{e=n._st.readByte(),t+=n._st.read(e)}while(0!==e);return t},this.parseHeader=function(){var e={sig:null,ver:null,width:null,height:null,colorRes:null,globalColorTableSize:null,gctFlag:null,sorted:null,globalColorTable:[],bgColor:null,pixelAspectRatio:null};if(e.sig=n._st.read(3),e.ver=n._st.read(3),"GIF"!==e.sig)throw new Error("Not a GIF file.");e.width=n._st.readUnsigned(),e.height=n._st.readUnsigned();var t=s(n._st.readByte());e.gctFlag=t.shift(),e.colorRes=i(t.splice(0,3)),e.sorted=t.shift(),e.globalColorTableSize=i(t.splice(0,3)),e.bgColor=n._st.readByte(),e.pixelAspectRatio=n._st.readByte(),e.gctFlag&&(e.globalColorTable=n.parseColorTable(1<<e.globalColorTableSize+1),n.globalColorTable=e.globalColorTable),n._handler.hdr&&n._handler.hdr(e)&&n.checkBytes.push(n._handler.hdr)},this.parseExt=function(e){switch(e.label=n._st.readByte(),e.label){case 249:e.extType="gce",function(e){n.checkBytes.push(n._st.readByte());var t=s(n._st.readByte());e.reserved=t.splice(0,3),e.disposalMethod=i(t.splice(0,3)),e.userInput=t.shift(),e.transparencyGiven=t.shift(),e.delayTime=n._st.readUnsigned(),e.transparencyIndex=n._st.readByte(),e.terminator=n._st.readByte(),n._handler.gce&&n._handler.gce(e)&&n.checkBytes.push(n._handler.gce)}(e);break;case 254:e.extType="com",function(e){e.comment=n.readSubBlocks(),n._handler.com&&n._handler.com(e)&&n.checkBytes.push(n._handler.com)}(e);break;case 1:e.extType="pte",function(e){n.checkBytes.push(n._st.readByte()),e.ptHeader=n._st.readBytes(12),e.ptData=n.readSubBlocks(),n._handler.pte&&n._handler.pte(e)&&n.checkBytes.push(n._handler.pte)}(e);break;case 255:e.extType="app",function(e){switch(n.checkBytes.push(n._st.readByte()),e.identifier=n._st.read(8),e.authCode=n._st.read(3),e.identifier){case"NETSCAPE":!function(e){n.checkBytes.push(n._st.readByte()),e.unknown=n._st.readByte(),e.iterations=n._st.readUnsigned(),e.terminator=n._st.readByte(),n._handler.app&&n._handler.app.NETSCAPE&&n._handler.app.NETSCAPE(e)&&n.checkBytes.push(n._handler.app)}(e);break;default:!function(e){e.appData=n.readSubBlocks(),n._handler.app&&n._handler.app[e.identifier]&&n._handler.app[e.identifier](e)&&n.checkBytes.push(n._handler.app[e.identifier])}(e)}}(e);break;default:e.extType="unknown",function(e){e.data=n.readSubBlocks(),n._handler.unknown&&n._handler.unknown(e)&&n.checkBytes.push(n._handler.unknown)}(e)}},this.parseImg=function(e){e.leftPos=n._st.readUnsigned(),e.topPos=n._st.readUnsigned(),e.width=n._st.readUnsigned(),e.height=n._st.readUnsigned();var t=s(n._st.readByte());e.lctFlag=t.shift(),e.interlaced=t.shift(),e.sorted=t.shift(),e.reserved=t.splice(0,2),e.lctSize=i(t.splice(0,3)),e.lctFlag&&(e.lct=n.parseColorTable(1<<e.lctSize+1)),e.lzwMinCodeSize=n._st.readByte();var r=n.readSubBlocks();e.pixels=h(e.lzwMinCodeSize,r),e.interlaced&&(e.pixels=function(e,t){for(var r=new Array(e.length),n=e.length/t,a=function(n,a){var o=e.slice(a*t,(a+1)*t);r.splice.apply(r,[n*t,t].concat(o))},o=[0,4,2,1],i=[8,8,4,2],s=0,l=0;l<4;l++)for(var h=o[l];h<n;h+=i[l])a(h,s),s++;return r}(e.pixels,e.width)),n.frames.push(e),n.arrayToImage(e),n._handler.img&&n._handler.img(e)&&n.checkBytes.push(n._handler)},this.parseBlock=function(){var e={sentinel:n._st.readByte(),type:""};switch(String.fromCharCode(e.sentinel)){case"!":e.type="ext",n.parseExt(e);break;case",":e.type="img",n.parseImg(e);break;case";":e.type="eof",n._handler.eof&&n._handler.eof(e)&&n.checkBytes.push(n._handler.eof);break;default:throw new Error("Unknown block: 0x"+e.sentinel.toString(16))}"eof"!==e.type&&n.parseBlock()},this.arrayToImage=function(e){var t=0,r=document.createElement("canvas");r.id=t.toString(),r.width=e.width,r.height=e.height,t++;for(var a=r.getContext("2d"),o=0,i=0,s=0;s<e.pixels.length;s++)i%e.width==0&&(o++,i=0),n.globalColorTable[e.pixels[s]]===n._transparentColor.toHex()?a.fillStyle="rgba(0, 0, 0, 0)":a.fillStyle=n.globalColorTable[e.pixels[s]],a.fillRect(i,o,1,1),i++;var l=new Image;l.src=r.toDataURL(),n.images.push(l)},this._st=e,this._handler={},this._transparentColor=t,this.parseHeader(),this.parseBlock()}}();exports.ParseGif=d;
},{"./Resource":"lN80","./Texture":"HrNa","../Drawing/Color":"p7Gh","../Drawing/SpriteSheet":"ikZV"}],"R9kC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Resource");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}})});var r=require("./Sound/Index");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return r[e]}})});var t=require("./Texture");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return t[e]}})});var u=require("./Gif");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return u[e]}})});
},{"./Resource":"lN80","./Sound/Index":"ANin","./Texture":"HrNa","./Gif":"A4zr"}],"SM3q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={DrawUtil:!0};exports.DrawUtil=void 0;var t=require("./Util");Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});var r=o(require("./DrawUtil"));function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var i=o?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(r,u,i):r[u]=e[u]}return r.default=e,t&&t.set(e,r),r}exports.DrawUtil=r;
},{"./Util":"Kkda","./DrawUtil":"UgQh"}],"A6Lr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={EX_VERSION:!0,Actor:!0,CollisionType:!0,Events:!0,Label:!0,FontStyle:!0,FontUnit:!0,TextAlign:!0,BaseAlign:!0,Particle:!0,ParticleEmitter:!0,EmitterType:!0,TileMap:!0,Cell:!0,TileSprite:!0,Input:!0,Traits:!0,Util:!0,Graphics:!0};Object.defineProperty(exports,"Actor",{enumerable:!0,get:function(){return n.Actor}}),Object.defineProperty(exports,"CollisionType",{enumerable:!0,get:function(){return o.CollisionType}}),Object.defineProperty(exports,"Label",{enumerable:!0,get:function(){return b.Label}}),Object.defineProperty(exports,"FontStyle",{enumerable:!0,get:function(){return b.FontStyle}}),Object.defineProperty(exports,"FontUnit",{enumerable:!0,get:function(){return b.FontUnit}}),Object.defineProperty(exports,"TextAlign",{enumerable:!0,get:function(){return b.TextAlign}}),Object.defineProperty(exports,"BaseAlign",{enumerable:!0,get:function(){return b.BaseAlign}}),Object.defineProperty(exports,"Particle",{enumerable:!0,get:function(){return O.Particle}}),Object.defineProperty(exports,"ParticleEmitter",{enumerable:!0,get:function(){return O.ParticleEmitter}}),Object.defineProperty(exports,"EmitterType",{enumerable:!0,get:function(){return O.EmitterType}}),Object.defineProperty(exports,"TileMap",{enumerable:!0,get:function(){return x.TileMap}}),Object.defineProperty(exports,"Cell",{enumerable:!0,get:function(){return x.Cell}}),Object.defineProperty(exports,"TileSprite",{enumerable:!0,get:function(){return x.TileSprite}}),exports.Graphics=exports.Util=exports.Traits=exports.Input=exports.Events=exports.EX_VERSION=void 0;var t=require("./Polyfill"),r=require("./Engine");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return r[t]}}))});var n=require("./Actor"),o=require("./Collision/CollisionType"),u=require("./Algebra");Object.keys(u).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return u[t]}}))});var c=require("./Camera");Object.keys(c).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return c[t]}}))});var i=require("./Class");Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return i[t]}}))});var a=require("./Configurable");Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return a[t]}}))});var l=require("./Debug");Object.keys(l).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return l[t]}}))});var p=require("./EventDispatcher");Object.keys(p).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return p[t]}}))});var f=require("./Events/MediaEvents");Object.keys(f).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return f[t]}}))});var s=N(require("./Events"));exports.Events=s,Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return s[t]}}))});var b=require("./Label"),y=require("./Loader");Object.keys(y).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return y[t]}}))});var O=require("./Particles"),d=require("./Physics");Object.keys(d).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return d[t]}}))});var j=require("./Promises");Object.keys(j).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return j[t]}}))});var P=require("./Scene");Object.keys(P).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return P[t]}}))});var x=require("./TileMap"),h=require("./Timer");Object.keys(h).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return h[t]}}))});var _=require("./Trigger");Object.keys(_).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return _[t]}}))});var g=require("./ScreenElement");Object.keys(g).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return g[t]}}))});var m=require("./Actions/Index");Object.keys(m).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return m[t]}}))});var E=require("./Collision/Index");Object.keys(E).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return E[t]}}))});var v=require("./Drawing/Index");Object.keys(v).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return v[t]}}))});var q=require("./Interfaces/Index");Object.keys(q).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return q[t]}}))});var M=require("./Math/Index");Object.keys(M).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return M[t]}}))});var w=require("./PostProcessing/Index");Object.keys(w).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return w[t]}}))});var k=require("./Resources/Index");Object.keys(k).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return k[t]}}))});var T=N(require("./Input/Index"));exports.Input=T;var I=N(require("./Traits/Index"));exports.Traits=I;var U=N(require("./Util/Index"));exports.Util=U;var C=N(require("./Graphics/index"));exports.Graphics=C;var A=require("./Util/Browser");Object.keys(A).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return A[t]}}))});var S=require("./Util/Decorators");Object.keys(S).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return S[t]}}))});var D=require("./Util/Detector");Object.keys(D).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return D[t]}}))});var F=require("./Util/CullingBox");Object.keys(F).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return F[t]}}))});var L=require("./Util/EasingFunctions");Object.keys(L).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return L[t]}}))});var B=require("./Util/Log");Object.keys(B).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return B[t]}}))});var G=require("./Util/SortedList");function R(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return R=function(){return e},e}function N(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=R();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var u=n?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(r,o,u):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}Object.keys(G).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return G[t]}}))});var V=void 0;exports.EX_VERSION=V,(0,t.polyfill)();
},{"./Polyfill":"oh18","./Engine":"CIaB","./Actor":"vmFf","./Collision/CollisionType":"liCD","./Algebra":"NGcQ","./Camera":"pAjs","./Class":"yTUi","./Configurable":"A4Kj","./Debug":"haDW","./EventDispatcher":"c7EN","./Events/MediaEvents":"QGKl","./Events":"XySq","./Label":"rRqb","./Loader":"jUb1","./Particles":"pJ6L","./Physics":"uSEN","./Promises":"PqN8","./Scene":"xS6v","./TileMap":"QP5n","./Timer":"y7ZJ","./Trigger":"NgAR","./ScreenElement":"PDm1","./Actions/Index":"oDmR","./Collision/Index":"kKHB","./Drawing/Index":"vS88","./Interfaces/Index":"scJm","./Math/Index":"HAdL","./PostProcessing/Index":"mhi9","./Resources/Index":"R9kC","./Input/Index":"aiZ2","./Traits/Index":"CPmg","./Util/Index":"SM3q","./Graphics/index":"qIYM","./Util/Browser":"ids7","./Util/Decorators":"kQDE","./Util/Detector":"OWe5","./Util/CullingBox":"nIlm","./Util/EasingFunctions":"LpjS","./Util/Log":"p1Gn","./Util/SortedList":"O7SY"}],"uUt3":[function(require,module,exports) {
module.exports="/ludum-46/sword.3217e75f.png";
},{}],"Irga":[function(require,module,exports) {
module.exports="/ludum-46/icons.517a0bc7.png";
},{}],"KdKA":[function(require,module,exports) {
module.exports="/ludum-46/player-1.1e3f2ddf.png";
},{}],"jB9D":[function(require,module,exports) {
module.exports="/ludum-46/player-2.4b0a332a.png";
},{}],"AAAw":[function(require,module,exports) {
module.exports="/ludum-46/player-3.117138c9.png";
},{}],"jVAI":[function(require,module,exports) {
module.exports="/ludum-46/player-4.214cb382.png";
},{}],"SCPp":[function(require,module,exports) {
module.exports="/ludum-46/player-5.59f1315a.png";
},{}],"TNue":[function(require,module,exports) {
module.exports="/ludum-46/player-1-long.a557a5be.png";
},{}],"eIuB":[function(require,module,exports) {
module.exports="/ludum-46/player-2-long.143a00e7.png";
},{}],"FbJC":[function(require,module,exports) {
module.exports="/ludum-46/player-3-long.3c6b8c9c.png";
},{}],"DyzN":[function(require,module,exports) {
module.exports="/ludum-46/player-4-long.41954819.png";
},{}],"mC8e":[function(require,module,exports) {
module.exports="/ludum-46/player-5-long.d9b21e98.png";
},{}],"BxMk":[function(require,module,exports) {
module.exports="/ludum-46/cuecard-base.25f119dc.png";
},{}],"V2ej":[function(require,module,exports) {
module.exports="/ludum-46/cuecard-timer.56181d9c.png";
},{}],"Uq7F":[function(require,module,exports) {
module.exports="/ludum-46/meter.72c4128a.png";
},{}],"AReb":[function(require,module,exports) {
module.exports="/ludum-46/background.d6e849cc.png";
},{}],"Uhel":[function(require,module,exports) {
module.exports="/ludum-46/silent-card-template.89223b98.png";
},{}],"k7cQ":[function(require,module,exports) {
module.exports="/ludum-46/play-again-button.36edb330.png";
},{}],"czUR":[function(require,module,exports) {
"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function t(r,t){return Object.prototype.hasOwnProperty.call(r,t)}exports.assign=function(r){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var a in n)t(n,a)&&(r[a]=n[a])}}return r},exports.shrinkBuf=function(r,t){return r.length===t?r:r.subarray?r.subarray(0,t):(r.length=t,r)};var e={arraySet:function(r,t,e,n,a){if(t.subarray&&r.subarray)r.set(t.subarray(e,e+n),a);else for(var o=0;o<n;o++)r[a+o]=t[e+o]},flattenChunks:function(r){var t,e,n,a,o,s;for(n=0,t=0,e=r.length;t<e;t++)n+=r[t].length;for(s=new Uint8Array(n),a=0,t=0,e=r.length;t<e;t++)o=r[t],s.set(o,a),a+=o.length;return s}},n={arraySet:function(r,t,e,n,a){for(var o=0;o<n;o++)r[a+o]=t[e+o]},flattenChunks:function(r){return[].concat.apply([],r)}};exports.setTyped=function(r){r?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,e)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,n))},exports.setTyped(r);
},{}],"t6RP":[function(require,module,exports) {
"use strict";var e=require("../utils/common"),t=4,n=0,_=1,r=2;function a(e){for(var t=e.length;--t>=0;)e[t]=0}var i=0,l=1,d=2,f=3,o=258,b=29,s=256,u=s+1+b,c=30,p=19,h=2*u+1,v=15,y=16,x=7,g=256,m=16,w=17,A=18,k=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=512,B=new Array(2*(u+2));a(B);var C=new Array(2*c);a(C);var D=new Array(j);a(D);var E=new Array(o-f+1);a(E);var F=new Array(b);a(F);var G,H,I,J=new Array(c);function K(e,t,n,_,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=_,this.max_length=r,this.has_stree=e&&e.length}function L(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function M(e){return e<256?D[e]:D[256+(e>>>7)]}function N(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function O(e,t,n){e.bi_valid>y-n?(e.bi_buf|=t<<e.bi_valid&65535,N(e,e.bi_buf),e.bi_buf=t>>y-e.bi_valid,e.bi_valid+=n-y):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function P(e,t,n){O(e,n[2*t],n[2*t+1])}function Q(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function R(e){16===e.bi_valid?(N(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function T(e,t){var n,_,r,a,i,l,d=t.dyn_tree,f=t.max_code,o=t.stat_desc.static_tree,b=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,u=t.stat_desc.extra_base,c=t.stat_desc.max_length,p=0;for(a=0;a<=v;a++)e.bl_count[a]=0;for(d[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<h;n++)(a=d[2*d[2*(_=e.heap[n])+1]+1]+1)>c&&(a=c,p++),d[2*_+1]=a,_>f||(e.bl_count[a]++,i=0,_>=u&&(i=s[_-u]),l=d[2*_],e.opt_len+=l*(a+i),b&&(e.static_len+=l*(o[2*_+1]+i)));if(0!==p){do{for(a=c-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[c]--,p-=2}while(p>0);for(a=c;0!==a;a--)for(_=e.bl_count[a];0!==_;)(r=e.heap[--n])>f||(d[2*r+1]!==a&&(e.opt_len+=(a-d[2*r+1])*d[2*r],d[2*r+1]=a),_--)}}function U(e,t,n){var _,r,a=new Array(v+1),i=0;for(_=1;_<=v;_++)a[_]=i=i+n[_-1]<<1;for(r=0;r<=t;r++){var l=e[2*r+1];0!==l&&(e[2*r]=Q(a[l]++,l))}}function V(){var e,t,n,_,r,a=new Array(v+1);for(n=0,_=0;_<b-1;_++)for(F[_]=n,e=0;e<1<<k[_];e++)E[n++]=_;for(E[n-1]=_,r=0,_=0;_<16;_++)for(J[_]=r,e=0;e<1<<q[_];e++)D[r++]=_;for(r>>=7;_<c;_++)for(J[_]=r<<7,e=0;e<1<<q[_]-7;e++)D[256+r++]=_;for(t=0;t<=v;t++)a[t]=0;for(e=0;e<=143;)B[2*e+1]=8,e++,a[8]++;for(;e<=255;)B[2*e+1]=9,e++,a[9]++;for(;e<=279;)B[2*e+1]=7,e++,a[7]++;for(;e<=287;)B[2*e+1]=8,e++,a[8]++;for(U(B,u+1,a),e=0;e<c;e++)C[2*e+1]=5,C[2*e]=Q(e,5);G=new K(B,k,s+1,u,v),H=new K(C,q,0,c,v),I=new K(new Array(0),z,0,p,x)}function W(e){var t;for(t=0;t<u;t++)e.dyn_ltree[2*t]=0;for(t=0;t<c;t++)e.dyn_dtree[2*t]=0;for(t=0;t<p;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*g]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function X(e){e.bi_valid>8?N(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Y(t,n,_,r){X(t),r&&(N(t,_),N(t,~_)),e.arraySet(t.pending_buf,t.window,n,_,t.pending),t.pending+=_}function Z(e,t,n,_){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&_[t]<=_[n]}function $(e,t,n){for(var _=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&Z(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Z(t,_,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=_}function ee(e,t,n){var _,r,a,i,l=0;if(0!==e.last_lit)do{_=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],r=e.pending_buf[e.l_buf+l],l++,0===_?P(e,r,t):(P(e,(a=E[r])+s+1,t),0!==(i=k[a])&&O(e,r-=F[a],i),P(e,a=M(--_),n),0!==(i=q[a])&&O(e,_-=J[a],i))}while(l<e.last_lit);P(e,g,t)}function te(e,t){var n,_,r,a=t.dyn_tree,i=t.stat_desc.static_tree,l=t.stat_desc.has_stree,d=t.stat_desc.elems,f=-1;for(e.heap_len=0,e.heap_max=h,n=0;n<d;n++)0!==a[2*n]?(e.heap[++e.heap_len]=f=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=f<2?++f:0)]=1,e.depth[r]=0,e.opt_len--,l&&(e.static_len-=i[2*r+1]);for(t.max_code=f,n=e.heap_len>>1;n>=1;n--)$(e,a,n);r=d;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$(e,a,1),_=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=_,a[2*r]=a[2*n]+a[2*_],e.depth[r]=(e.depth[n]>=e.depth[_]?e.depth[n]:e.depth[_])+1,a[2*n+1]=a[2*_+1]=r,e.heap[1]=r++,$(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],T(e,t),U(a,f,e.bl_count)}function ne(e,t,n){var _,r,a=-1,i=t[1],l=0,d=7,f=4;for(0===i&&(d=138,f=3),t[2*(n+1)+1]=65535,_=0;_<=n;_++)r=i,i=t[2*(_+1)+1],++l<d&&r===i||(l<f?e.bl_tree[2*r]+=l:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[2*m]++):l<=10?e.bl_tree[2*w]++:e.bl_tree[2*A]++,l=0,a=r,0===i?(d=138,f=3):r===i?(d=6,f=3):(d=7,f=4))}function _e(e,t,n){var _,r,a=-1,i=t[1],l=0,d=7,f=4;for(0===i&&(d=138,f=3),_=0;_<=n;_++)if(r=i,i=t[2*(_+1)+1],!(++l<d&&r===i)){if(l<f)do{P(e,r,e.bl_tree)}while(0!=--l);else 0!==r?(r!==a&&(P(e,r,e.bl_tree),l--),P(e,m,e.bl_tree),O(e,l-3,2)):l<=10?(P(e,w,e.bl_tree),O(e,l-3,3)):(P(e,A,e.bl_tree),O(e,l-11,7));l=0,a=r,0===i?(d=138,f=3):r===i?(d=6,f=3):(d=7,f=4)}}function re(e){var t;for(ne(e,e.dyn_ltree,e.l_desc.max_code),ne(e,e.dyn_dtree,e.d_desc.max_code),te(e,e.bl_desc),t=p-1;t>=3&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function ae(e,t,n,_){var r;for(O(e,t-257,5),O(e,n-1,5),O(e,_-4,4),r=0;r<_;r++)O(e,e.bl_tree[2*S[r]+1],3);_e(e,e.dyn_ltree,t-1),_e(e,e.dyn_dtree,n-1)}function ie(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return n;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return _;for(t=32;t<s;t++)if(0!==e.dyn_ltree[2*t])return _;return n}a(J);var le=!1;function de(e){le||(V(),le=!0),e.l_desc=new L(e.dyn_ltree,G),e.d_desc=new L(e.dyn_dtree,H),e.bl_desc=new L(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,W(e)}function fe(e,t,n,_){O(e,(i<<1)+(_?1:0),3),Y(e,t,n,!0)}function oe(e){O(e,l<<1,3),P(e,g,B),R(e)}function be(e,n,_,a){var i,f,o=0;e.level>0?(e.strm.data_type===r&&(e.strm.data_type=ie(e)),te(e,e.l_desc),te(e,e.d_desc),o=re(e),i=e.opt_len+3+7>>>3,(f=e.static_len+3+7>>>3)<=i&&(i=f)):i=f=_+5,_+4<=i&&-1!==n?fe(e,n,_,a):e.strategy===t||f===i?(O(e,(l<<1)+(a?1:0),3),ee(e,B,C)):(O(e,(d<<1)+(a?1:0),3),ae(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),ee(e,e.dyn_ltree,e.dyn_dtree)),W(e),a&&X(e)}function se(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(E[n]+s+1)]++,e.dyn_dtree[2*M(t)]++),e.last_lit===e.lit_bufsize-1}exports._tr_init=de,exports._tr_stored_block=fe,exports._tr_flush_block=be,exports._tr_tally=se,exports._tr_align=oe;
},{"../utils/common":"czUR"}],"CRrX":[function(require,module,exports) {
"use strict";function e(e,r,o,t){for(var u=65535&e|0,i=e>>>16&65535|0,n=0;0!==o;){o-=n=o>2e3?2e3:o;do{i=i+(u=u+r[t++]|0)|0}while(--n);u%=65521,i%=65521}return u|i<<16|0}module.exports=e;
},{}],"CwDA":[function(require,module,exports) {
"use strict";function r(){for(var r,o=[],t=0;t<256;t++){r=t;for(var n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;o[t]=r}return o}var o=r();function t(r,t,n,u){var a=o,e=u+n;r^=-1;for(var f=u;f<e;f++)r=r>>>8^a[255&(r^t[f])];return-1^r}module.exports=t;
},{}],"gN2D":[function(require,module,exports) {
"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};
},{}],"ytoJ":[function(require,module,exports) {
"use strict";var t,a=require("../utils/common"),e=require("./trees"),s=require("./adler32"),i=require("./crc32"),r=require("./messages"),n=0,h=1,l=3,_=4,d=5,o=0,u=1,g=-2,f=-3,c=-5,p=-1,m=1,w=2,v=3,k=4,z=0,b=2,x=8,y=9,B=15,S=8,q=29,I=256,A=I+1+q,C=30,R=19,j=2*A+1,D=15,E=3,H=258,K=H+E+1,N=32,F=42,G=69,J=73,L=91,M=103,O=113,P=666,Q=1,T=2,U=3,V=4,W=3;function X(t,a){return t.msg=r[a],a}function Y(t){return(t<<1)-(t>4?9:0)}function Z(t){for(var a=t.length;--a>=0;)t[a]=0}function $(t){var e=t.state,s=e.pending;s>t.avail_out&&(s=t.avail_out),0!==s&&(a.arraySet(t.output,e.pending_buf,e.pending_out,s,t.next_out),t.next_out+=s,e.pending_out+=s,t.total_out+=s,t.avail_out-=s,e.pending-=s,0===e.pending&&(e.pending_out=0))}function tt(t,a){e._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,a),t.block_start=t.strstart,$(t.strm)}function at(t,a){t.pending_buf[t.pending++]=a}function et(t,a){t.pending_buf[t.pending++]=a>>>8&255,t.pending_buf[t.pending++]=255&a}function st(t,e,r,n){var h=t.avail_in;return h>n&&(h=n),0===h?0:(t.avail_in-=h,a.arraySet(e,t.input,t.next_in,h,r),1===t.state.wrap?t.adler=s(t.adler,e,h,r):2===t.state.wrap&&(t.adler=i(t.adler,e,h,r)),t.next_in+=h,t.total_in+=h,h)}function it(t,a){var e,s,i=t.max_chain_length,r=t.strstart,n=t.prev_length,h=t.nice_match,l=t.strstart>t.w_size-K?t.strstart-(t.w_size-K):0,_=t.window,d=t.w_mask,o=t.prev,u=t.strstart+H,g=_[r+n-1],f=_[r+n];t.prev_length>=t.good_match&&(i>>=2),h>t.lookahead&&(h=t.lookahead);do{if(_[(e=a)+n]===f&&_[e+n-1]===g&&_[e]===_[r]&&_[++e]===_[r+1]){r+=2,e++;do{}while(_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&_[++r]===_[++e]&&r<u);if(s=H-(u-r),r=u-H,s>n){if(t.match_start=a,n=s,s>=h)break;g=_[r+n-1],f=_[r+n]}}}while((a=o[a&d])>l&&0!=--i);return n<=t.lookahead?n:t.lookahead}function rt(t){var e,s,i,r,n,h=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=h+(h-K)){a.arraySet(t.window,t.window,h,h,0),t.match_start-=h,t.strstart-=h,t.block_start-=h,e=s=t.hash_size;do{i=t.head[--e],t.head[e]=i>=h?i-h:0}while(--s);e=s=h;do{i=t.prev[--e],t.prev[e]=i>=h?i-h:0}while(--s);r+=h}if(0===t.strm.avail_in)break;if(s=st(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=s,t.lookahead+t.insert>=E)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+E-1])&t.hash_mask,t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<E)););}while(t.lookahead<K&&0!==t.strm.avail_in)}function nt(t,a){var e=65535;for(e>t.pending_buf_size-5&&(e=t.pending_buf_size-5);;){if(t.lookahead<=1){if(rt(t),0===t.lookahead&&a===n)return Q;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var s=t.block_start+e;if((0===t.strstart||t.strstart>=s)&&(t.lookahead=t.strstart-s,t.strstart=s,tt(t,!1),0===t.strm.avail_out))return Q;if(t.strstart-t.block_start>=t.w_size-K&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=0,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):(t.strstart>t.block_start&&(tt(t,!1),t.strm.avail_out),Q)}function ht(t,a){for(var s,i;;){if(t.lookahead<K){if(rt(t),t.lookahead<K&&a===n)return Q;if(0===t.lookahead)break}if(s=0,t.lookahead>=E&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==s&&t.strstart-s<=t.w_size-K&&(t.match_length=it(t,s)),t.match_length>=E)if(i=e._tr_tally(t,t.strstart-t.match_start,t.match_length-E),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=E){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=t.strstart<E-1?t.strstart:E-1,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function lt(t,a){for(var s,i,r;;){if(t.lookahead<K){if(rt(t),t.lookahead<K&&a===n)return Q;if(0===t.lookahead)break}if(s=0,t.lookahead>=E&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=E-1,0!==s&&t.prev_length<t.max_lazy_match&&t.strstart-s<=t.w_size-K&&(t.match_length=it(t,s),t.match_length<=5&&(t.strategy===m||t.match_length===E&&t.strstart-t.match_start>4096)&&(t.match_length=E-1)),t.prev_length>=E&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-E,i=e._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-E),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+E-1])&t.hash_mask,s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=E-1,t.strstart++,i&&(tt(t,!1),0===t.strm.avail_out))return Q}else if(t.match_available){if((i=e._tr_tally(t,0,t.window[t.strstart-1]))&&tt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Q}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=e._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<E-1?t.strstart:E-1,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function _t(t,a){for(var s,i,r,h,l=t.window;;){if(t.lookahead<=H){if(rt(t),t.lookahead<=H&&a===n)return Q;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=E&&t.strstart>0&&(i=l[r=t.strstart-1])===l[++r]&&i===l[++r]&&i===l[++r]){h=t.strstart+H;do{}while(i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&i===l[++r]&&r<h);t.match_length=H-(h-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=E?(s=e._tr_tally(t,1,t.match_length-E),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(s=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),s&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=0,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function dt(t,a){for(var s;;){if(0===t.lookahead&&(rt(t),0===t.lookahead)){if(a===n)return Q;break}if(t.match_length=0,s=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,s&&(tt(t,!1),0===t.strm.avail_out))return Q}return t.insert=0,a===_?(tt(t,!0),0===t.strm.avail_out?U:V):t.last_lit&&(tt(t,!1),0===t.strm.avail_out)?Q:T}function ot(t,a,e,s,i){this.good_length=t,this.max_lazy=a,this.nice_length=e,this.max_chain=s,this.func=i}function ut(a){a.window_size=2*a.w_size,Z(a.head),a.max_lazy_match=t[a.level].max_lazy,a.good_match=t[a.level].good_length,a.nice_match=t[a.level].nice_length,a.max_chain_length=t[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=E-1,a.match_available=0,a.ins_h=0}function gt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*j),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*R+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(D+1),this.heap=new a.Buf16(2*A+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*A+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ft(t){var a;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=b,(a=t.state).pending=0,a.pending_out=0,a.wrap<0&&(a.wrap=-a.wrap),a.status=a.wrap?F:O,t.adler=2===a.wrap?0:1,a.last_flush=n,e._tr_init(a),o):X(t,g)}function ct(t){var a=ft(t);return a===o&&ut(t.state),a}function pt(t,a){return t&&t.state?2!==t.state.wrap?g:(t.state.gzhead=a,o):g}function mt(t,e,s,i,r,n){if(!t)return g;var h=1;if(e===p&&(e=6),i<0?(h=0,i=-i):i>15&&(h=2,i-=16),r<1||r>y||s!==x||i<8||i>15||e<0||e>9||n<0||n>k)return X(t,g);8===i&&(i=9);var l=new gt;return t.state=l,l.strm=t,l.wrap=h,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+E-1)/E),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=n,l.method=s,ct(t)}function wt(t,a){return mt(t,a,x,B,S,z)}function vt(a,s){var r,f,p,m;if(!a||!a.state||s>d||s<0)return a?X(a,g):g;if(f=a.state,!a.output||!a.input&&0!==a.avail_in||f.status===P&&s!==_)return X(a,0===a.avail_out?c:g);if(f.strm=a,r=f.last_flush,f.last_flush=s,f.status===F)if(2===f.wrap)a.adler=0,at(f,31),at(f,139),at(f,8),f.gzhead?(at(f,(f.gzhead.text?1:0)+(f.gzhead.hcrc?2:0)+(f.gzhead.extra?4:0)+(f.gzhead.name?8:0)+(f.gzhead.comment?16:0)),at(f,255&f.gzhead.time),at(f,f.gzhead.time>>8&255),at(f,f.gzhead.time>>16&255),at(f,f.gzhead.time>>24&255),at(f,9===f.level?2:f.strategy>=w||f.level<2?4:0),at(f,255&f.gzhead.os),f.gzhead.extra&&f.gzhead.extra.length&&(at(f,255&f.gzhead.extra.length),at(f,f.gzhead.extra.length>>8&255)),f.gzhead.hcrc&&(a.adler=i(a.adler,f.pending_buf,f.pending,0)),f.gzindex=0,f.status=G):(at(f,0),at(f,0),at(f,0),at(f,0),at(f,0),at(f,9===f.level?2:f.strategy>=w||f.level<2?4:0),at(f,W),f.status=O);else{var k=x+(f.w_bits-8<<4)<<8;k|=(f.strategy>=w||f.level<2?0:f.level<6?1:6===f.level?2:3)<<6,0!==f.strstart&&(k|=N),k+=31-k%31,f.status=O,et(f,k),0!==f.strstart&&(et(f,a.adler>>>16),et(f,65535&a.adler)),a.adler=1}if(f.status===G)if(f.gzhead.extra){for(p=f.pending;f.gzindex<(65535&f.gzhead.extra.length)&&(f.pending!==f.pending_buf_size||(f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),$(a),p=f.pending,f.pending!==f.pending_buf_size));)at(f,255&f.gzhead.extra[f.gzindex]),f.gzindex++;f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),f.gzindex===f.gzhead.extra.length&&(f.gzindex=0,f.status=J)}else f.status=J;if(f.status===J)if(f.gzhead.name){p=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),$(a),p=f.pending,f.pending===f.pending_buf_size)){m=1;break}m=f.gzindex<f.gzhead.name.length?255&f.gzhead.name.charCodeAt(f.gzindex++):0,at(f,m)}while(0!==m);f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),0===m&&(f.gzindex=0,f.status=L)}else f.status=L;if(f.status===L)if(f.gzhead.comment){p=f.pending;do{if(f.pending===f.pending_buf_size&&(f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),$(a),p=f.pending,f.pending===f.pending_buf_size)){m=1;break}m=f.gzindex<f.gzhead.comment.length?255&f.gzhead.comment.charCodeAt(f.gzindex++):0,at(f,m)}while(0!==m);f.gzhead.hcrc&&f.pending>p&&(a.adler=i(a.adler,f.pending_buf,f.pending-p,p)),0===m&&(f.status=M)}else f.status=M;if(f.status===M&&(f.gzhead.hcrc?(f.pending+2>f.pending_buf_size&&$(a),f.pending+2<=f.pending_buf_size&&(at(f,255&a.adler),at(f,a.adler>>8&255),a.adler=0,f.status=O)):f.status=O),0!==f.pending){if($(a),0===a.avail_out)return f.last_flush=-1,o}else if(0===a.avail_in&&Y(s)<=Y(r)&&s!==_)return X(a,c);if(f.status===P&&0!==a.avail_in)return X(a,c);if(0!==a.avail_in||0!==f.lookahead||s!==n&&f.status!==P){var z=f.strategy===w?dt(f,s):f.strategy===v?_t(f,s):t[f.level].func(f,s);if(z!==U&&z!==V||(f.status=P),z===Q||z===U)return 0===a.avail_out&&(f.last_flush=-1),o;if(z===T&&(s===h?e._tr_align(f):s!==d&&(e._tr_stored_block(f,0,0,!1),s===l&&(Z(f.head),0===f.lookahead&&(f.strstart=0,f.block_start=0,f.insert=0))),$(a),0===a.avail_out))return f.last_flush=-1,o}return s!==_?o:f.wrap<=0?u:(2===f.wrap?(at(f,255&a.adler),at(f,a.adler>>8&255),at(f,a.adler>>16&255),at(f,a.adler>>24&255),at(f,255&a.total_in),at(f,a.total_in>>8&255),at(f,a.total_in>>16&255),at(f,a.total_in>>24&255)):(et(f,a.adler>>>16),et(f,65535&a.adler)),$(a),f.wrap>0&&(f.wrap=-f.wrap),0!==f.pending?o:u)}function kt(t){var a;return t&&t.state?(a=t.state.status)!==F&&a!==G&&a!==J&&a!==L&&a!==M&&a!==O&&a!==P?X(t,g):(t.state=null,a===O?X(t,f):o):g}function zt(t,e){var i,r,n,h,l,_,d,u,f=e.length;if(!t||!t.state)return g;if(2===(h=(i=t.state).wrap)||1===h&&i.status!==F||i.lookahead)return g;for(1===h&&(t.adler=s(t.adler,e,f,0)),i.wrap=0,f>=i.w_size&&(0===h&&(Z(i.head),i.strstart=0,i.block_start=0,i.insert=0),u=new a.Buf8(i.w_size),a.arraySet(u,e,f-i.w_size,i.w_size,0),e=u,f=i.w_size),l=t.avail_in,_=t.next_in,d=t.input,t.avail_in=f,t.next_in=0,t.input=e,rt(i);i.lookahead>=E;){r=i.strstart,n=i.lookahead-(E-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+E-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++}while(--n);i.strstart=r,i.lookahead=E-1,rt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=E-1,i.match_available=0,t.next_in=_,t.input=d,t.avail_in=l,i.wrap=h,o}t=[new ot(0,0,0,0,nt),new ot(4,4,8,4,ht),new ot(4,5,16,8,ht),new ot(4,6,32,32,ht),new ot(4,4,16,16,lt),new ot(8,16,32,32,lt),new ot(8,16,128,128,lt),new ot(8,32,128,256,lt),new ot(32,128,258,1024,lt),new ot(32,258,258,4096,lt)],exports.deflateInit=wt,exports.deflateInit2=mt,exports.deflateReset=ct,exports.deflateResetKeep=ft,exports.deflateSetHeader=pt,exports.deflate=vt,exports.deflateEnd=kt,exports.deflateSetDictionary=zt,exports.deflateInfo="pako deflate (from Nodeca project)";
},{"../utils/common":"czUR","./trees":"t6RP","./adler32":"CRrX","./crc32":"CwDA","./messages":"gN2D"}],"UO2g":[function(require,module,exports) {
"use strict";var r=require("./common"),n=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch(u){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){t=!1}for(var e=new r.Buf8(256),o=0;o<256;o++)e[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function f(e,o){if(o<65534&&(e.subarray&&t||!e.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(e,o));for(var f="",u=0;u<o;u++)f+=String.fromCharCode(e[u]);return f}e[254]=e[254]=1,exports.string2buf=function(n){var t,e,o,f,u,a=n.length,i=0;for(f=0;f<a;f++)55296==(64512&(e=n.charCodeAt(f)))&&f+1<a&&56320==(64512&(o=n.charCodeAt(f+1)))&&(e=65536+(e-55296<<10)+(o-56320),f++),i+=e<128?1:e<2048?2:e<65536?3:4;for(t=new r.Buf8(i),u=0,f=0;u<i;f++)55296==(64512&(e=n.charCodeAt(f)))&&f+1<a&&56320==(64512&(o=n.charCodeAt(f+1)))&&(e=65536+(e-55296<<10)+(o-56320),f++),e<128?t[u++]=e:e<2048?(t[u++]=192|e>>>6,t[u++]=128|63&e):e<65536?(t[u++]=224|e>>>12,t[u++]=128|e>>>6&63,t[u++]=128|63&e):(t[u++]=240|e>>>18,t[u++]=128|e>>>12&63,t[u++]=128|e>>>6&63,t[u++]=128|63&e);return t},exports.buf2binstring=function(r){return f(r,r.length)},exports.binstring2buf=function(n){for(var t=new r.Buf8(n.length),e=0,o=t.length;e<o;e++)t[e]=n.charCodeAt(e);return t},exports.buf2string=function(r,n){var t,o,u,a,i=n||r.length,h=new Array(2*i);for(o=0,t=0;t<i;)if((u=r[t++])<128)h[o++]=u;else if((a=e[u])>4)h[o++]=65533,t+=a-1;else{for(u&=2===a?31:3===a?15:7;a>1&&t<i;)u=u<<6|63&r[t++],a--;a>1?h[o++]=65533:u<65536?h[o++]=u:(u-=65536,h[o++]=55296|u>>10&1023,h[o++]=56320|1023&u)}return f(h,o)},exports.utf8border=function(r,n){var t;for((n=n||r.length)>r.length&&(n=r.length),t=n-1;t>=0&&128==(192&r[t]);)t--;return t<0?n:0===t?n:t+e[r[t]]>n?t:n};
},{"./common":"czUR"}],"XKOj":[function(require,module,exports) {
"use strict";function t(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}module.exports=t;
},{}],"LwLr":[function(require,module,exports) {
"use strict";var t=require("./zlib/deflate"),i=require("./utils/common"),e=require("./utils/strings"),n=require("./zlib/messages"),r=require("./zlib/zstream"),s=Object.prototype.toString,o=0,a=4,u=0,h=1,d=2,l=-1,f=0,p=8;function w(o){if(!(this instanceof w))return new w(o);this.options=i.assign({level:l,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},o||{});var a=this.options;a.raw&&a.windowBits>0?a.windowBits=-a.windowBits:a.gzip&&a.windowBits>0&&a.windowBits<16&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var h=t.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(h!==u)throw new Error(n[h]);if(a.header&&t.deflateSetHeader(this.strm,a.header),a.dictionary){var d;if(d="string"==typeof a.dictionary?e.string2buf(a.dictionary):"[object ArrayBuffer]"===s.call(a.dictionary)?new Uint8Array(a.dictionary):a.dictionary,(h=t.deflateSetDictionary(this.strm,d))!==u)throw new Error(n[h]);this._dict_set=!0}}function c(t,i){var e=new w(i);if(e.push(t,!0),e.err)throw e.msg||n[e.err];return e.result}function m(t,i){return(i=i||{}).raw=!0,c(t,i)}function g(t,i){return(i=i||{}).gzip=!0,c(t,i)}w.prototype.push=function(n,r){var l,f,p=this.strm,w=this.options.chunkSize;if(this.ended)return!1;f=r===~~r?r:!0===r?a:o,"string"==typeof n?p.input=e.string2buf(n):"[object ArrayBuffer]"===s.call(n)?p.input=new Uint8Array(n):p.input=n,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(w),p.next_out=0,p.avail_out=w),(l=t.deflate(p,f))!==h&&l!==u)return this.onEnd(l),this.ended=!0,!1;0!==p.avail_out&&(0!==p.avail_in||f!==a&&f!==d)||("string"===this.options.to?this.onData(e.buf2binstring(i.shrinkBuf(p.output,p.next_out))):this.onData(i.shrinkBuf(p.output,p.next_out)))}while((p.avail_in>0||0===p.avail_out)&&l!==h);return f===a?(l=t.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===u):f!==d||(this.onEnd(u),p.avail_out=0,!0)},w.prototype.onData=function(t){this.chunks.push(t)},w.prototype.onEnd=function(t){t===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},exports.Deflate=w,exports.deflate=c,exports.deflateRaw=m,exports.gzip=g;
},{"./zlib/deflate":"ytoJ","./utils/common":"czUR","./utils/strings":"UO2g","./zlib/messages":"gN2D","./zlib/zstream":"XKOj"}],"Hbr3":[function(require,module,exports) {
"use strict";var i=30,e=12;module.exports=function(o,a){var t,d,n,l,s,f,r,b,c,u,v,m,w,h,k,_,x,g,p,z,j,q,y,A,B;t=o.state,d=o.next_in,A=o.input,n=d+(o.avail_in-5),l=o.next_out,B=o.output,s=l-(a-o.avail_out),f=l+(o.avail_out-257),r=t.dmax,b=t.wsize,c=t.whave,u=t.wnext,v=t.window,m=t.hold,w=t.bits,h=t.lencode,k=t.distcode,_=(1<<t.lenbits)-1,x=(1<<t.distbits)-1;i:do{w<15&&(m+=A[d++]<<w,w+=8,m+=A[d++]<<w,w+=8),g=h[m&_];e:for(;;){if(m>>>=p=g>>>24,w-=p,0===(p=g>>>16&255))B[l++]=65535&g;else{if(!(16&p)){if(0==(64&p)){g=h[(65535&g)+(m&(1<<p)-1)];continue e}if(32&p){t.mode=e;break i}o.msg="invalid literal/length code",t.mode=i;break i}z=65535&g,(p&=15)&&(w<p&&(m+=A[d++]<<w,w+=8),z+=m&(1<<p)-1,m>>>=p,w-=p),w<15&&(m+=A[d++]<<w,w+=8,m+=A[d++]<<w,w+=8),g=k[m&x];o:for(;;){if(m>>>=p=g>>>24,w-=p,!(16&(p=g>>>16&255))){if(0==(64&p)){g=k[(65535&g)+(m&(1<<p)-1)];continue o}o.msg="invalid distance code",t.mode=i;break i}if(j=65535&g,w<(p&=15)&&(m+=A[d++]<<w,(w+=8)<p&&(m+=A[d++]<<w,w+=8)),(j+=m&(1<<p)-1)>r){o.msg="invalid distance too far back",t.mode=i;break i}if(m>>>=p,w-=p,j>(p=l-s)){if((p=j-p)>c&&t.sane){o.msg="invalid distance too far back",t.mode=i;break i}if(q=0,y=v,0===u){if(q+=b-p,p<z){z-=p;do{B[l++]=v[q++]}while(--p);q=l-j,y=B}}else if(u<p){if(q+=b+u-p,(p-=u)<z){z-=p;do{B[l++]=v[q++]}while(--p);if(q=0,u<z){z-=p=u;do{B[l++]=v[q++]}while(--p);q=l-j,y=B}}}else if(q+=u-p,p<z){z-=p;do{B[l++]=v[q++]}while(--p);q=l-j,y=B}for(;z>2;)B[l++]=y[q++],B[l++]=y[q++],B[l++]=y[q++],z-=3;z&&(B[l++]=y[q++],z>1&&(B[l++]=y[q++]))}else{q=l-j;do{B[l++]=B[q++],B[l++]=B[q++],B[l++]=B[q++],z-=3}while(z>2);z&&(B[l++]=B[q++],z>1&&(B[l++]=B[q++]))}break}}break}}while(d<n&&l<f);d-=z=w>>3,m&=(1<<(w-=z<<3))-1,o.next_in=d,o.next_out=l,o.avail_in=d<n?n-d+5:5-(d-n),o.avail_out=l<f?f-l+257:257-(l-f),t.hold=m,t.bits=w};
},{}],"jhci":[function(require,module,exports) {
"use strict";var r=require("../utils/common"),f=15,i=852,o=592,e=0,u=1,t=2,n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(a,c,m,w,d,v,B,h){var k,p,q,x,g,j,y,z,A,C=h.bits,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=null,O=0,P=new r.Buf16(f+1),Q=new r.Buf16(f+1),R=null,S=0;for(D=0;D<=f;D++)P[D]=0;for(E=0;E<w;E++)P[c[m+E]]++;for(H=C,G=f;G>=1&&0===P[G];G--);if(H>G&&(H=G),0===G)return d[v++]=20971520,d[v++]=20971520,h.bits=1,0;for(F=1;F<G&&0===P[F];F++);for(H<F&&(H=F),K=1,D=1;D<=f;D++)if(K<<=1,(K-=P[D])<0)return-1;if(K>0&&(a===e||1!==G))return-1;for(Q[1]=0,D=1;D<f;D++)Q[D+1]=Q[D]+P[D];for(E=0;E<w;E++)0!==c[m+E]&&(B[Q[c[m+E]]++]=E);if(a===e?(N=R=B,j=19):a===u?(N=n,O-=257,R=l,S-=257,j=256):(N=s,R=b,j=-1),M=0,E=0,D=F,g=v,I=H,J=0,q=-1,x=(L=1<<H)-1,a===u&&L>i||a===t&&L>o)return 1;for(;;){y=D-J,B[E]<j?(z=0,A=B[E]):B[E]>j?(z=R[S+B[E]],A=N[O+B[E]]):(z=96,A=0),k=1<<D-J,F=p=1<<I;do{d[g+(M>>J)+(p-=k)]=y<<24|z<<16|A|0}while(0!==p);for(k=1<<D-1;M&k;)k>>=1;if(0!==k?(M&=k-1,M+=k):M=0,E++,0==--P[D]){if(D===G)break;D=c[m+B[E]]}if(D>H&&(M&x)!==q){for(0===J&&(J=H),g+=F,K=1<<(I=D-J);I+J<G&&!((K-=P[I+J])<=0);)I++,K<<=1;if(L+=1<<I,a===u&&L>i||a===t&&L>o)return 1;d[q=M&x]=H<<24|I<<16|g-v|0}}return 0!==M&&(d[g+M]=D-J<<24|64<<16|0),h.bits=H,0};
},{"../utils/common":"czUR"}],"NU6N":[function(require,module,exports) {
"use strict";var e=require("../utils/common"),a=require("./adler32"),t=require("./crc32"),i=require("./inffast"),s=require("./inftrees"),n=0,r=1,o=2,d=4,l=5,f=6,c=0,h=1,k=2,b=-2,m=-3,w=-4,u=-5,g=8,v=1,x=2,p=3,_=4,y=5,z=6,B=7,S=8,q=9,C=10,I=11,R=12,j=13,A=14,D=15,E=16,G=17,H=18,K=19,N=20,F=21,J=22,L=23,M=24,O=25,P=26,Q=27,T=28,U=29,V=30,W=31,X=32,Y=852,Z=592,$=15,ee=$;function ae(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ie(a){var t;return a&&a.state?(t=a.state,a.total_in=a.total_out=t.total=0,a.msg="",t.wrap&&(a.adler=1&t.wrap),t.mode=v,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new e.Buf32(Y),t.distcode=t.distdyn=new e.Buf32(Z),t.sane=1,t.back=-1,c):b}function se(e){var a;return e&&e.state?((a=e.state).wsize=0,a.whave=0,a.wnext=0,ie(e)):b}function ne(e,a){var t,i;return e&&e.state?(i=e.state,a<0?(t=0,a=-a):(t=1+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?b:(null!==i.window&&i.wbits!==a&&(i.window=null),i.wrap=t,i.wbits=a,se(e))):b}function re(e,a){var t,i;return e?(i=new te,e.state=i,i.window=null,(t=ne(e,a))!==c&&(e.state=null),t):b}function oe(e){return re(e,ee)}var de,le,fe=!0;function ce(a){if(fe){var t;for(de=new e.Buf32(512),le=new e.Buf32(32),t=0;t<144;)a.lens[t++]=8;for(;t<256;)a.lens[t++]=9;for(;t<280;)a.lens[t++]=7;for(;t<288;)a.lens[t++]=8;for(s(r,a.lens,0,288,de,0,a.work,{bits:9}),t=0;t<32;)a.lens[t++]=5;s(o,a.lens,0,32,le,0,a.work,{bits:5}),fe=!1}a.lencode=de,a.lenbits=9,a.distcode=le,a.distbits=5}function he(a,t,i,s){var n,r=a.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new e.Buf8(r.wsize)),s>=r.wsize?(e.arraySet(r.window,t,i-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):((n=r.wsize-r.wnext)>s&&(n=s),e.arraySet(r.window,t,i-s,n,r.wnext),(s-=n)?(e.arraySet(r.window,t,i-s,s,0),r.wnext=s,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0}function ke(Y,Z){var $,ee,te,ie,se,ne,re,oe,de,le,fe,ke,be,me,we,ue,ge,ve,xe,pe,_e,ye,ze,Be,Se=0,qe=new e.Buf8(4),Ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Y||!Y.state||!Y.output||!Y.input&&0!==Y.avail_in)return b;($=Y.state).mode===R&&($.mode=j),se=Y.next_out,te=Y.output,re=Y.avail_out,ie=Y.next_in,ee=Y.input,ne=Y.avail_in,oe=$.hold,de=$.bits,le=ne,fe=re,ye=c;e:for(;;)switch($.mode){case v:if(0===$.wrap){$.mode=j;break}for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(2&$.wrap&&35615===oe){$.check=0,qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0),oe=0,de=0,$.mode=x;break}if($.flags=0,$.head&&($.head.done=!1),!(1&$.wrap)||(((255&oe)<<8)+(oe>>8))%31){Y.msg="incorrect header check",$.mode=V;break}if((15&oe)!==g){Y.msg="unknown compression method",$.mode=V;break}if(de-=4,_e=8+(15&(oe>>>=4)),0===$.wbits)$.wbits=_e;else if(_e>$.wbits){Y.msg="invalid window size",$.mode=V;break}$.dmax=1<<_e,Y.adler=$.check=1,$.mode=512&oe?C:R,oe=0,de=0;break;case x:for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if($.flags=oe,(255&$.flags)!==g){Y.msg="unknown compression method",$.mode=V;break}if(57344&$.flags){Y.msg="unknown header flags set",$.mode=V;break}$.head&&($.head.text=oe>>8&1),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0)),oe=0,de=0,$.mode=p;case p:for(;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.head&&($.head.time=oe),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,qe[2]=oe>>>16&255,qe[3]=oe>>>24&255,$.check=t($.check,qe,4,0)),oe=0,de=0,$.mode=_;case _:for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.head&&($.head.xflags=255&oe,$.head.os=oe>>8),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0)),oe=0,de=0,$.mode=y;case y:if(1024&$.flags){for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.length=oe,$.head&&($.head.extra_len=oe),512&$.flags&&(qe[0]=255&oe,qe[1]=oe>>>8&255,$.check=t($.check,qe,2,0)),oe=0,de=0}else $.head&&($.head.extra=null);$.mode=z;case z:if(1024&$.flags&&((ke=$.length)>ne&&(ke=ne),ke&&($.head&&(_e=$.head.extra_len-$.length,$.head.extra||($.head.extra=new Array($.head.extra_len)),e.arraySet($.head.extra,ee,ie,ke,_e)),512&$.flags&&($.check=t($.check,ee,ke,ie)),ne-=ke,ie+=ke,$.length-=ke),$.length))break e;$.length=0,$.mode=B;case B:if(2048&$.flags){if(0===ne)break e;ke=0;do{_e=ee[ie+ke++],$.head&&_e&&$.length<65536&&($.head.name+=String.fromCharCode(_e))}while(_e&&ke<ne);if(512&$.flags&&($.check=t($.check,ee,ke,ie)),ne-=ke,ie+=ke,_e)break e}else $.head&&($.head.name=null);$.length=0,$.mode=S;case S:if(4096&$.flags){if(0===ne)break e;ke=0;do{_e=ee[ie+ke++],$.head&&_e&&$.length<65536&&($.head.comment+=String.fromCharCode(_e))}while(_e&&ke<ne);if(512&$.flags&&($.check=t($.check,ee,ke,ie)),ne-=ke,ie+=ke,_e)break e}else $.head&&($.head.comment=null);$.mode=q;case q:if(512&$.flags){for(;de<16;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(oe!==(65535&$.check)){Y.msg="header crc mismatch",$.mode=V;break}oe=0,de=0}$.head&&($.head.hcrc=$.flags>>9&1,$.head.done=!0),Y.adler=$.check=0,$.mode=R;break;case C:for(;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}Y.adler=$.check=ae(oe),oe=0,de=0,$.mode=I;case I:if(0===$.havedict)return Y.next_out=se,Y.avail_out=re,Y.next_in=ie,Y.avail_in=ne,$.hold=oe,$.bits=de,k;Y.adler=$.check=1,$.mode=R;case R:if(Z===l||Z===f)break e;case j:if($.last){oe>>>=7&de,de-=7&de,$.mode=Q;break}for(;de<3;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}switch($.last=1&oe,de-=1,3&(oe>>>=1)){case 0:$.mode=A;break;case 1:if(ce($),$.mode=N,Z===f){oe>>>=2,de-=2;break e}break;case 2:$.mode=G;break;case 3:Y.msg="invalid block type",$.mode=V}oe>>>=2,de-=2;break;case A:for(oe>>>=7&de,de-=7&de;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if((65535&oe)!=(oe>>>16^65535)){Y.msg="invalid stored block lengths",$.mode=V;break}if($.length=65535&oe,oe=0,de=0,$.mode=D,Z===f)break e;case D:$.mode=E;case E:if(ke=$.length){if(ke>ne&&(ke=ne),ke>re&&(ke=re),0===ke)break e;e.arraySet(te,ee,ie,ke,se),ne-=ke,ie+=ke,re-=ke,se+=ke,$.length-=ke;break}$.mode=R;break;case G:for(;de<14;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if($.nlen=257+(31&oe),oe>>>=5,de-=5,$.ndist=1+(31&oe),oe>>>=5,de-=5,$.ncode=4+(15&oe),oe>>>=4,de-=4,$.nlen>286||$.ndist>30){Y.msg="too many length or distance symbols",$.mode=V;break}$.have=0,$.mode=H;case H:for(;$.have<$.ncode;){for(;de<3;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.lens[Ce[$.have++]]=7&oe,oe>>>=3,de-=3}for(;$.have<19;)$.lens[Ce[$.have++]]=0;if($.lencode=$.lendyn,$.lenbits=7,ze={bits:$.lenbits},ye=s(n,$.lens,0,19,$.lencode,0,$.work,ze),$.lenbits=ze.bits,ye){Y.msg="invalid code lengths set",$.mode=V;break}$.have=0,$.mode=K;case K:for(;$.have<$.nlen+$.ndist;){for(;ue=(Se=$.lencode[oe&(1<<$.lenbits)-1])>>>16&255,ge=65535&Se,!((we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(ge<16)oe>>>=we,de-=we,$.lens[$.have++]=ge;else{if(16===ge){for(Be=we+2;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(oe>>>=we,de-=we,0===$.have){Y.msg="invalid bit length repeat",$.mode=V;break}_e=$.lens[$.have-1],ke=3+(3&oe),oe>>>=2,de-=2}else if(17===ge){for(Be=we+3;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}de-=we,_e=0,ke=3+(7&(oe>>>=we)),oe>>>=3,de-=3}else{for(Be=we+7;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}de-=we,_e=0,ke=11+(127&(oe>>>=we)),oe>>>=7,de-=7}if($.have+ke>$.nlen+$.ndist){Y.msg="invalid bit length repeat",$.mode=V;break}for(;ke--;)$.lens[$.have++]=_e}}if($.mode===V)break;if(0===$.lens[256]){Y.msg="invalid code -- missing end-of-block",$.mode=V;break}if($.lenbits=9,ze={bits:$.lenbits},ye=s(r,$.lens,0,$.nlen,$.lencode,0,$.work,ze),$.lenbits=ze.bits,ye){Y.msg="invalid literal/lengths set",$.mode=V;break}if($.distbits=6,$.distcode=$.distdyn,ze={bits:$.distbits},ye=s(o,$.lens,$.nlen,$.ndist,$.distcode,0,$.work,ze),$.distbits=ze.bits,ye){Y.msg="invalid distances set",$.mode=V;break}if($.mode=N,Z===f)break e;case N:$.mode=F;case F:if(ne>=6&&re>=258){Y.next_out=se,Y.avail_out=re,Y.next_in=ie,Y.avail_in=ne,$.hold=oe,$.bits=de,i(Y,fe),se=Y.next_out,te=Y.output,re=Y.avail_out,ie=Y.next_in,ee=Y.input,ne=Y.avail_in,oe=$.hold,de=$.bits,$.mode===R&&($.back=-1);break}for($.back=0;ue=(Se=$.lencode[oe&(1<<$.lenbits)-1])>>>16&255,ge=65535&Se,!((we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(ue&&0==(240&ue)){for(ve=we,xe=ue,pe=ge;ue=(Se=$.lencode[pe+((oe&(1<<ve+xe)-1)>>ve)])>>>16&255,ge=65535&Se,!(ve+(we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}oe>>>=ve,de-=ve,$.back+=ve}if(oe>>>=we,de-=we,$.back+=we,$.length=ge,0===ue){$.mode=P;break}if(32&ue){$.back=-1,$.mode=R;break}if(64&ue){Y.msg="invalid literal/length code",$.mode=V;break}$.extra=15&ue,$.mode=J;case J:if($.extra){for(Be=$.extra;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.length+=oe&(1<<$.extra)-1,oe>>>=$.extra,de-=$.extra,$.back+=$.extra}$.was=$.length,$.mode=L;case L:for(;ue=(Se=$.distcode[oe&(1<<$.distbits)-1])>>>16&255,ge=65535&Se,!((we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(0==(240&ue)){for(ve=we,xe=ue,pe=ge;ue=(Se=$.distcode[pe+((oe&(1<<ve+xe)-1)>>ve)])>>>16&255,ge=65535&Se,!(ve+(we=Se>>>24)<=de);){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}oe>>>=ve,de-=ve,$.back+=ve}if(oe>>>=we,de-=we,$.back+=we,64&ue){Y.msg="invalid distance code",$.mode=V;break}$.offset=ge,$.extra=15&ue,$.mode=M;case M:if($.extra){for(Be=$.extra;de<Be;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}$.offset+=oe&(1<<$.extra)-1,oe>>>=$.extra,de-=$.extra,$.back+=$.extra}if($.offset>$.dmax){Y.msg="invalid distance too far back",$.mode=V;break}$.mode=O;case O:if(0===re)break e;if(ke=fe-re,$.offset>ke){if((ke=$.offset-ke)>$.whave&&$.sane){Y.msg="invalid distance too far back",$.mode=V;break}ke>$.wnext?(ke-=$.wnext,be=$.wsize-ke):be=$.wnext-ke,ke>$.length&&(ke=$.length),me=$.window}else me=te,be=se-$.offset,ke=$.length;ke>re&&(ke=re),re-=ke,$.length-=ke;do{te[se++]=me[be++]}while(--ke);0===$.length&&($.mode=F);break;case P:if(0===re)break e;te[se++]=$.length,re--,$.mode=F;break;case Q:if($.wrap){for(;de<32;){if(0===ne)break e;ne--,oe|=ee[ie++]<<de,de+=8}if(fe-=re,Y.total_out+=fe,$.total+=fe,fe&&(Y.adler=$.check=$.flags?t($.check,te,fe,se-fe):a($.check,te,fe,se-fe)),fe=re,($.flags?oe:ae(oe))!==$.check){Y.msg="incorrect data check",$.mode=V;break}oe=0,de=0}$.mode=T;case T:if($.wrap&&$.flags){for(;de<32;){if(0===ne)break e;ne--,oe+=ee[ie++]<<de,de+=8}if(oe!==(4294967295&$.total)){Y.msg="incorrect length check",$.mode=V;break}oe=0,de=0}$.mode=U;case U:ye=h;break e;case V:ye=m;break e;case W:return w;case X:default:return b}return Y.next_out=se,Y.avail_out=re,Y.next_in=ie,Y.avail_in=ne,$.hold=oe,$.bits=de,($.wsize||fe!==Y.avail_out&&$.mode<V&&($.mode<Q||Z!==d))&&he(Y,Y.output,Y.next_out,fe-Y.avail_out)?($.mode=W,w):(le-=Y.avail_in,fe-=Y.avail_out,Y.total_in+=le,Y.total_out+=fe,$.total+=fe,$.wrap&&fe&&(Y.adler=$.check=$.flags?t($.check,te,fe,Y.next_out-fe):a($.check,te,fe,Y.next_out-fe)),Y.data_type=$.bits+($.last?64:0)+($.mode===R?128:0)+($.mode===N||$.mode===D?256:0),(0===le&&0===fe||Z===d)&&ye===c&&(ye=u),ye)}function be(e){if(!e||!e.state)return b;var a=e.state;return a.window&&(a.window=null),e.state=null,c}function me(e,a){var t;return e&&e.state?0==(2&(t=e.state).wrap)?b:(t.head=a,a.done=!1,c):b}function we(e,t){var i,s=t.length;return e&&e.state?0!==(i=e.state).wrap&&i.mode!==I?b:i.mode===I&&a(1,t,s,0)!==i.check?m:he(e,t,s,s)?(i.mode=W,w):(i.havedict=1,c):b}exports.inflateReset=se,exports.inflateReset2=ne,exports.inflateResetKeep=ie,exports.inflateInit=oe,exports.inflateInit2=re,exports.inflate=ke,exports.inflateEnd=be,exports.inflateGetHeader=me,exports.inflateSetDictionary=we,exports.inflateInfo="pako inflate (from Nodeca project)";
},{"../utils/common":"czUR","./adler32":"CRrX","./crc32":"CwDA","./inffast":"Hbr3","./inftrees":"jhci"}],"w4f7":[function(require,module,exports) {
"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};
},{}],"pJu6":[function(require,module,exports) {
"use strict";function t(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}module.exports=t;
},{}],"SX0I":[function(require,module,exports) {
"use strict";var t=require("./zlib/inflate"),i=require("./utils/common"),n=require("./utils/strings"),r=require("./zlib/constants"),s=require("./zlib/messages"),o=require("./zlib/zstream"),e=require("./zlib/gzheader"),a=Object.prototype.toString;function u(h){if(!(this instanceof u))return new u(h);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},h||{});var _=this.options;_.raw&&_.windowBits>=0&&_.windowBits<16&&(_.windowBits=-_.windowBits,0===_.windowBits&&(_.windowBits=-15)),!(_.windowBits>=0&&_.windowBits<16)||h&&h.windowBits||(_.windowBits+=32),_.windowBits>15&&_.windowBits<48&&0==(15&_.windowBits)&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var w=t.inflateInit2(this.strm,_.windowBits);if(w!==r.Z_OK)throw new Error(s[w]);if(this.header=new e,t.inflateGetHeader(this.strm,this.header),_.dictionary&&("string"==typeof _.dictionary?_.dictionary=n.string2buf(_.dictionary):"[object ArrayBuffer]"===a.call(_.dictionary)&&(_.dictionary=new Uint8Array(_.dictionary)),_.raw&&(w=t.inflateSetDictionary(this.strm,_.dictionary))!==r.Z_OK))throw new Error(s[w])}function h(t,i){var n=new u(i);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}function _(t,i){return(i=i||{}).raw=!0,h(t,i)}u.prototype.push=function(s,o){var e,u,h,_,w,d=this.strm,l=this.options.chunkSize,f=this.options.dictionary,p=!1;if(this.ended)return!1;u=o===~~o?o:!0===o?r.Z_FINISH:r.Z_NO_FLUSH,"string"==typeof s?d.input=n.binstring2buf(s):"[object ArrayBuffer]"===a.call(s)?d.input=new Uint8Array(s):d.input=s,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(l),d.next_out=0,d.avail_out=l),(e=t.inflate(d,r.Z_NO_FLUSH))===r.Z_NEED_DICT&&f&&(e=t.inflateSetDictionary(this.strm,f)),e===r.Z_BUF_ERROR&&!0===p&&(e=r.Z_OK,p=!1),e!==r.Z_STREAM_END&&e!==r.Z_OK)return this.onEnd(e),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&e!==r.Z_STREAM_END&&(0!==d.avail_in||u!==r.Z_FINISH&&u!==r.Z_SYNC_FLUSH)||("string"===this.options.to?(h=n.utf8border(d.output,d.next_out),_=d.next_out-h,w=n.buf2string(d.output,h),d.next_out=_,d.avail_out=l-_,_&&i.arraySet(d.output,d.output,h,_,0),this.onData(w)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(p=!0)}while((d.avail_in>0||0===d.avail_out)&&e!==r.Z_STREAM_END);return e===r.Z_STREAM_END&&(u=r.Z_FINISH),u===r.Z_FINISH?(e=t.inflateEnd(this.strm),this.onEnd(e),this.ended=!0,e===r.Z_OK):u!==r.Z_SYNC_FLUSH||(this.onEnd(r.Z_OK),d.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===r.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},exports.Inflate=u,exports.inflate=h,exports.inflateRaw=_,exports.ungzip=h;
},{"./zlib/inflate":"NU6N","./utils/common":"czUR","./utils/strings":"UO2g","./zlib/constants":"w4f7","./zlib/messages":"gN2D","./zlib/zstream":"XKOj","./zlib/gzheader":"pJu6"}],"VwsR":[function(require,module,exports) {
"use strict";var e=require("./lib/utils/common").assign,i=require("./lib/deflate"),r=require("./lib/inflate"),l=require("./lib/zlib/constants"),s={};e(s,i,r,l),module.exports=s;
},{"./lib/utils/common":"czUR","./lib/deflate":"LwLr","./lib/inflate":"SX0I","./lib/zlib/constants":"w4f7"}],"xbxH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={TiledMapFormat:!0,TiledResource:!0};exports.TiledResource=exports.TiledMapFormat=void 0;var e=require("excalibur"),r=a(require("pako")),i=require("../excalibur/build/dist/Graphics"),o=require("./ITiledMap");function a(t){return t&&t.__esModule?t:{default:t}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}}))});var s,c=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();exports.TiledMapFormat=s,function(t){t[t.TMX=0]="TMX",t[t.JSON=1]="JSON"}(s||(exports.TiledMapFormat=s={}));var h=function(t){function r(e,r){void 0===r&&(r=s.JSON);var i=this;switch(r){case s.JSON:i=t.call(this,e,"json")||this;break;default:throw"The format "+r+" is not currently supported. Please export Tiled map as JSON."}return i.mapFormat=r,i.imagePathAccessor=i.externalTilesetPathAccessor=function(t,r){if(0===t.indexOf("/"))return t;var i=e.split("/"),o=i.concat([]);return i.length>0&&o.splice(-1),o.push(t),o.join("/")},i}return c(r,t),r.prototype.load=function(){var r=this;return new Promise(function(i,o){t.prototype.load.call(r).then(function(t){var a=[];r.data.tilesets.forEach(function(t){if(t.source){var i=new e.Resource(r.externalTilesetPathAccessor(t.source,t),"json");a.push(i.load().then(function(e){Object.assign(t,e)}))}}),Promise.all(a).then(function(){a=[],r.data.tilesets.forEach(function(t){var i=new e.Texture(r.imagePathAccessor(t.image,t));t.imageTexture=i,a.push(i.load()),e.Logger.getInstance().debug("[Tiled] Loading associated tileset: "+t.image)}),Promise.all(a).then(function(){i(t)},function(t){o(t)})},function(t){o(t)})})})},r.prototype.processData=function(t){if("object"!==n(t))throw"Tiled map resource "+this.path+" is not the correct content type";if(void 0===t)throw"Tiled map resource "+this.path+" is empty";switch(this.mapFormat){case s.JSON:return l(t)}},r.prototype.getTilesetForTile=function(t){for(var e=this.data.tilesets.length-1;e>=0;e--){var r=this.data.tilesets[e];if(r.firstgid<=t)return r}return null},r.prototype.getTileMap=function(t,r){for(var o=new e.TileMap(t,r,this.data.tilewidth,this.data.tileheight,this.data.height,this.data.width),a={},n=0,s=this.data.tilesets;n<s.length;n++){var c=s[n],h=Math.floor(c.imagewidth/c.tilewidth),l=Math.floor(c.imageheight/c.tileheight),u=e.Graphics.SpriteSheet.fromGrid({image:i.RawImage.fromLegacyTexture(c.imageTexture),grid:{rows:l,columns:h,spriteWidth:c.tilewidth,spriteHeight:c.tileheight}}),f=new e.SpriteSheet(c.imageTexture,h,l,c.tilewidth,c.tileheight);o.registerSpriteSheet(c.firstgid.toString(),f),a[c.firstgid.toString()]=u}for(var d=0,p=this.data.layers;d<p.length;d++){var g=p[d];if("tilelayer"===g.type)for(var m=0;m<g.data.length;m++){var y=g.data[m];if(0!==y){c=this.getTilesetForTile(y);o.data[m].sprites.push(new e.TileSprite(c.firstgid.toString(),y-c.firstgid)),o.data[m].graphics.show(a[c.firstgid.toString()].sprites[y-c.firstgid])}}}return o},r}(e.Resource);exports.TiledResource=h;var l=function(t){if(t.layers)for(var e=0,r=t.layers;e<r.length;e++){var i=r[e];"string"==typeof i.data?"base64"===i.encoding&&(i.data=u.decompressBase64(i.data,i.encoding,i.compression||"")):i.data=u.decompressCsv(i.data)}return t},u={decompressCsv:function(t){return t},decompressBase64:function(t,e,i){var o,a,n,s,c,h;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l="undefined"!=typeof Uint8Array?Uint8Array:Array,u="+".charCodeAt(0),f="/".charCodeAt(0),d="0".charCodeAt(0),p="a".charCodeAt(0),g="A".charCodeAt(0),m="-".charCodeAt(0),y="_".charCodeAt(0);function v(t){var e=t.charCodeAt(0);return e===u||e===m?62:e===f||e===y?63:e<d?-1:e<d+10?e-d+26+26:e<g+26?e-g:e<p+26?e-p+26:-1}var A=t.length;c="="===t.charAt(A-2)?2:"="===t.charAt(A-1)?1:0,h=new l(3*t.length/4-c),n=c>0?t.length-4:t.length;var T=0;function w(t){h[T++]=t}for(o=0,a=0;o<n;o+=4,a+=3)w((16711680&(s=v(t.charAt(o))<<18|v(t.charAt(o+1))<<12|v(t.charAt(o+2))<<6|v(t.charAt(o+3))))>>16),w((65280&s)>>8),w(255&s);2===c?w(255&(s=v(t.charAt(o))<<2|v(t.charAt(o+1))>>4)):1===c&&(w((s=v(t.charAt(o))<<10|v(t.charAt(o+1))<<4|v(t.charAt(o+2))>>2)>>8&255),w(255&s)),"zlib"!==i&&"gzip"!==i||(h=r.default.inflate(h));var b=function(t){for(var e=0,r=t.length-1;r>=0;r--)e=256*e+1*t[r];return e},S=h.length/4,x=new Array(S);for(o=0;o<S;o++)x[o]=b(h.slice(4*o,4*o+3));return x}};
},{"excalibur":"A6Lr","pako":"VwsR","../excalibur/build/dist/Graphics":"qIYM","./ITiledMap":"R3Xd"}],"x5mp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Resources=void 0;var e=R(require("../img/sword.png")),a=R(require("../img/icons.png")),r=R(require("../img/char-sprites/player-1.png")),i=R(require("../img/char-sprites/player-2.png")),p=R(require("../img/char-sprites/player-3.png")),n=R(require("../img/char-sprites/player-4.png")),u=R(require("../img/char-sprites/player-5.png")),c=R(require("../img/char-sprites/player-1-long.png")),s=R(require("../img/char-sprites/player-2-long.png")),g=R(require("../img/char-sprites/player-3-long.png")),t=R(require("../img/char-sprites/player-4-long.png")),d=R(require("../img/char-sprites/player-5-long.png")),w=R(require("../img/cuecard-base.png")),m=R(require("../img/cuecard-timer.png")),h=R(require("../img/meter.png")),l=R(require("../img/background.png")),o=R(require("../img/silent-card-template.png")),I=R(require("../img/play-again-button.png")),S=require("excalibur"),f=require("excalibur-tiled");function R(e){return e&&e.__esModule?e:{default:e}}var q={swordImage:new S.Graphics.RawImage(e.default),icons:new S.Graphics.RawImage(a.default),charSheet1:new S.Graphics.RawImage(r.default),charSheet2:new S.Graphics.RawImage(i.default),charSheet3:new S.Graphics.RawImage(p.default),charSheet4:new S.Graphics.RawImage(n.default),charSheet5:new S.Graphics.RawImage(u.default),charSheet6:new S.Graphics.RawImage(c.default),charSheet7:new S.Graphics.RawImage(s.default),charSheet8:new S.Graphics.RawImage(g.default),charSheet9:new S.Graphics.RawImage(t.default),charSheet10:new S.Graphics.RawImage(d.default),cuecardBaseImage:new S.Graphics.RawImage(w.default),cuecardTimerSheet:new S.Graphics.RawImage(m.default),audienceMeterSheet:new S.Graphics.RawImage(h.default),map:new f.TiledResource("./map/map.json"),background:new S.Graphics.RawImage(l.default),titleCard:new S.Graphics.RawImage(o.default),playAgainButton:new S.Graphics.RawImage(I.default),music:new S.Sound("./mp3/background.mp3"),sndDoorOpen:new S.Sound("./wav/doorOpen.wav"),sndCardExpired:new S.Sound("./wav/cardExpired.wav"),sndCardSuccess:new S.Sound("./wav/cardSuccess.wav"),sndPickupItem:new S.Sound("./wav/pickupItem.wav"),sndNope:new S.Sound("./wav/nope2.wav"),applause:new S.Sound("./mp3/applause2.mp3"),boo:new S.Sound("./mp3/boo2.mp3")};exports.Resources=q;
},{"../img/sword.png":"uUt3","../img/icons.png":"Irga","../img/char-sprites/player-1.png":"KdKA","../img/char-sprites/player-2.png":"jB9D","../img/char-sprites/player-3.png":"AAAw","../img/char-sprites/player-4.png":"jVAI","../img/char-sprites/player-5.png":"SCPp","../img/char-sprites/player-1-long.png":"TNue","../img/char-sprites/player-2-long.png":"eIuB","../img/char-sprites/player-3-long.png":"FbJC","../img/char-sprites/player-4-long.png":"DyzN","../img/char-sprites/player-5-long.png":"mC8e","../img/cuecard-base.png":"BxMk","../img/cuecard-timer.png":"V2ej","../img/meter.png":"Uq7F","../img/background.png":"AReb","../img/silent-card-template.png":"Uhel","../img/play-again-button.png":"k7cQ","excalibur":"A6Lr","excalibur-tiled":"xbxH"}],"foLc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("excalibur"),r={AnalyticsEndpoint:"https://ludum46stats.azurewebsites.net/api/LD46Stats",RandomSeed:Date.now(),PlayerWidth:35,PlayerHeight:35,PlayerVel:250,PlayerSpriteHeight:45,PlayerSpriteWidth:45,GameWidth:1280,GameHeight:720,TomatoPercentage:.25,StagePos:(0,e.vec)(40,168),CueCardPadding:135,CueCardTopOffset:70,CueCardHeight:75,CueCardWidth:300,CueCardLifeMinSeconds:15,CueCardLifeMaxSeconds:25,CueCardScoreDelaySeconds:3,CueCardSuccessReplacementDelay:7e3,CueCardFailReplacementDelay:0,AudienceMeterXOffset:200,AudienceMeterMaxWidth:934,AudienceMeterStartingWidth:400,AudienceMeterHeight:20,SoundVolume:1,CueCardExpiredVolume:.1,CueCardSuccessVolume:.1,DoorOpenVolume:.1,PickupItemVolume:.1,BackgroundVolume:.05,ScoreDecayRate:5,ScoreBaseIncrease:0,ScoreIncreasePerProp:30,ScoreMultiplier:1.5,ScoreLossPerMissedCard:15,ScorePunishment:30,NumCueCardsToWin:7,GreatScoreCutoff:400,RoaringScoreCutoff:600};exports.default=r;
},{"excalibur":"A6Lr"}],"Q9FA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Stats=exports.Analytics=void 0;var e=t(require("./config"));function t(e){return e&&e.__esModule?e:{default:e}}var n=function(){function t(){}return t.publish=function(t){return fetch(e.default.AnalyticsEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},t}();exports.Analytics=n;var r=function(){function t(t){this._inventory=t,this.startTime=Date.now(),this.isGameOver=!1,this.numLinesDelivered=0,this.numPropsUsed=0,this.numCostumeChanges=0,this.currentAudienceScore=e.default.AudienceMeterStartingWidth}return Object.defineProperty(t.prototype,"start",{get:function(){return this.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return Date.now()-this.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inventory",{get:function(){return this._inventory},set:function(e){this._inventory=e},enumerable:!0,configurable:!0}),t.prototype.reduceAudienceMeter=function(e){e<this.currentAudienceScore?this.currentAudienceScore-=e:this.currentAudienceScore=0},t.prototype.increaseAudienceMeter=function(t){t<this.currentAudienceScore+e.default.AudienceMeterMaxWidth?this.currentAudienceScore+=t:this.currentAudienceScore=e.default.AudienceMeterMaxWidth},t.prototype.publishStats=function(){var t,r=null===(t=document.getElementById("commitRef"))||void 0===t?void 0:t.innerText;return n.publish({commit:r,date:(new Date).toISOString(),started:this.start,duration:this.duration,numPropsused:this.numPropsUsed,numCostumeChanges:this.numCostumeChanges,numLinesDelivered:this.numLinesDelivered,randomSeed:e.default.RandomSeed})},t}();exports.Stats=r;
},{"./config":"foLc"}],"RhqW":[function(require,module,exports) {
"use strict";var t,e,s;Object.defineProperty(exports,"__esModule",{value:!0}),exports.IconPosition=exports.Costumes=exports.StageProps=exports.Locations=void 0,exports.Locations=t,function(t){t.stageLeft="stageLeft",t.stageCenter="stageCenter",t.stageRight="stageRight"}(t||(exports.Locations=t={})),exports.StageProps=e,function(t){t.rubberChicken="rubberChicken",t.trumpet="trumpet",t.umbrella="umbrella",t.toiletPaper="toiletPaper",t.skull="skull",t.sword="sword"}(e||(exports.StageProps=e={})),exports.Costumes=s,function(t){t.vikingHat="vikingHat",t.jesterHat="jesterHat",t.topHat="topHat",t.sherifHat="sherifHat",t.magicianHat="magicianHat",t.bunnyEars="bunnyEars"}(s||(exports.Costumes=s={}));var r={rubberChicken:0,trumpet:1,umbrella:2,tomato:4,toiletPaper:3,skull:7,sword:5,vikingHat:10,jesterHat:11,topHat:12,sherifHat:13,magicianHat:14,bunnyEars:15,stageCenter:25,stageLeft:26,stageRight:27,redCheck:28};exports.IconPosition=r;
},{}],"rXhO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Player=void 0;var e=require("excalibur"),t=s(require("./config")),i=require("./resources"),r=require("./session");function s(e){return e&&e.__esModule?e:{default:e}}var a,o=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();!function(e){e[e.input_deny=0]="input_deny",e[e.input_accept=1]="input_accept"}(a||(a={}));var n=function(s){function n(e,i){var r=s.call(this,e,i,t.default.PlayerWidth,t.default.PlayerHeight)||this;return r.inputState=a.input_deny,r}return o(n,s),n.prototype.onInitialize=function(i){var s=this;this._setupDrawing(i),this.enableTileMapCollision(),i.input.keyboard.on("hold",function(i){if(s.inputState===a.input_accept&&1!=(0,r.stats)().isGameOver)switch(i.key){case e.Input.Keys.Up:case e.Input.Keys.W:s.vel.setTo(s.vel.x,-t.default.PlayerVel),s.graphics.show("walkUp");break;case e.Input.Keys.Down:case e.Input.Keys.S:s.vel.setTo(s.vel.x,t.default.PlayerVel),s.graphics.show("walkDown");break;case e.Input.Keys.Left:case e.Input.Keys.A:s.vel.setTo(-t.default.PlayerVel,s.vel.y),s.graphics.show("walkLeft");break;case e.Input.Keys.Right:case e.Input.Keys.D:s.vel.setTo(t.default.PlayerVel,s.vel.y),s.graphics.show("walkRight")}}),i.input.keyboard.on("release",function(i){if(s.inputState===a.input_accept&&1!=(0,r.stats)().isGameOver)switch(i.key){case e.Input.Keys.Up:case e.Input.Keys.W:s.graphics.show("up");break;case e.Input.Keys.Down:case e.Input.Keys.S:s.vel.setTo(s.vel.x,t.default.PlayerVel),s.graphics.show("down");break;case e.Input.Keys.Left:case e.Input.Keys.A:s.graphics.show("left");break;case e.Input.Keys.Right:case e.Input.Keys.D:s.graphics.show("right")}})},n.prototype.onPostUpdate=function(){this.inputState===a.input_accept&&this.vel.setTo(0,0)},n.prototype.beginEnterStage=function(){var r=this;return this.inputState=a.input_deny,this.graphics.show("walkLeft"),this.body.collider.type=e.CollisionType.PreventCollision,setTimeout(function(){i.Resources.sndDoorOpen.play()},800),this.actions.moveBy(-3*t.default.PlayerWidth,0,60).callMethod(function(){r.graphics.show("left"),r.body.collider.type=e.CollisionType.Active}).asPromise()},n.prototype.AllowUserControl=function(){this.inputState=a.input_accept},n.prototype._setupDrawing=function(i){var r,s,a,o,n,p,u,c;this.charImage=this.getCharSprite();var l=e.Graphics.SpriteSheet.fromGrid({image:this.charImage,grid:{rows:1,columns:10,spriteHeight:t.default.PlayerSpriteHeight,spriteWidth:t.default.PlayerSpriteWidth}}),h=l.sprites,d=h[0],y=h[3],f=h[7],g=h[9];null===(r=d.origin)||void 0===r||r.setTo(0,.2),null===(s=y.origin)||void 0===s||s.setTo(0,.2),null===(a=f.origin)||void 0===a||a.setTo(0,.2),null===(o=g.origin)||void 0===o||o.setTo(0,.2),this.graphics.add("down",d),this.graphics.add("up",y),this.graphics.add("left",f),this.graphics.add("right",g);var v=e.Graphics.Animation.fromSpriteSheet(l,[0,1,0,2],180);null===(n=v.origin)||void 0===n||n.setTo(0,.2),this.graphics.add("walkDown",v);var w=e.Graphics.Animation.fromSpriteSheet(l,[3,4,3,5],180);null===(p=w.origin)||void 0===p||p.setTo(0,.2),this.graphics.add("walkUp",w);var S=e.Graphics.Animation.fromSpriteSheet(l,[7,6],200);null===(u=S.origin)||void 0===u||u.setTo(0,.2),this.graphics.add("walkLeft",S);var _=e.Graphics.Animation.fromSpriteSheet(l,[9,8],200);null===(c=_.origin)||void 0===c||c.setTo(0,.2),this.graphics.add("walkRight",_)},n.prototype.getCharSprite=function(t){var r=new e.Random(Date.now()),s=[];for(var a in i.Resources)if(-1!=a.search("charSheet")){var o=i.Resources[a];if(t&&o===this.charImage)continue;s.push(o)}return r.shuffle(s)[0]},n}(e.Actor);exports.Player=n;
},{"excalibur":"A6Lr","./config":"foLc","./resources":"x5mp","./session":"cTZz"}],"p7mH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Item=exports.default=void 0;var e=require("excalibur"),t=require("./constants"),r=require("./resources"),o=require("./session"),s=require("./player"),i=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),n=function(){function o(){}return o.getIconSprite=function(e){var r=t.IconPosition[e];return o.sheet.sprites[r]},o.sheet=e.Graphics.SpriteSheet.fromGrid({image:r.Resources.icons,grid:{rows:6,columns:5,spriteHeight:80,spriteWidth:80}}),o}(),u=n;exports.default=u;var a=function(t){function n(e,r,o,s,i){var n=t.call(this,s,i)||this;return n.kind=e,n.resourceName=r,n.sprite=o,n}return i(n,t),n.prototype.onInitialize=function(){var t=this;this.body.collider.type=e.CollisionType.Passive,this.graphics.show(this.sprite),this.on("precollision",function(e){e.other instanceof s.Player&&("prop"===t.kind?((0,o.stats)().inventory.addProp(t.resourceName,t.pos),(0,o.stats)().numPropsUsed++):"costume"===t.kind&&((0,o.stats)().inventory.addCostume(t.resourceName,t.pos),(0,o.stats)().numCostumeChanges++),r.Resources.sndPickupItem.play(),t.kill())});var i=new e.Random,n=this.pos.y;this.actions.delay(i.integer(0,500)).easeTo(this.pos.x,this.pos.y-i.integer(3,9),1500,e.EasingFunctions.EaseInCubic).easeTo(this.pos.x,n,1e3,e.EasingFunctions.EaseOutCubic).repeatForever()},n}(e.Actor);exports.Item=a;
},{"excalibur":"A6Lr","./constants":"RhqW","./resources":"x5mp","./session":"cTZz","./player":"rXhO"}],"Tvvj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CueCard=exports.CueCardExpiredEvent=exports.CueCardEvents=void 0;var e=require("excalibur"),t=require("./resources"),i=o(require("./items")),r=require("./session");function o(e){return e&&e.__esModule?e:{default:e}}var a,s=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();exports.CueCardEvents=a,function(e){e.CueCardExpired="CueCardExpired",e.CueCardSatisfied="CueCardSatisfied"}(a||(exports.CueCardEvents=a={}));var n=function(e){function t(t){var i=e.call(this)||this;return i.cueCard=t,i}return s(t,e),t}(e.GameEvent);exports.CueCardExpiredEvent=n;var p=function(o){function p(e){var t=o.call(this)||this;return t._running=!0,t.failed=!1,t.timer=t.lifeTime=e.lifeTime,t.options=e,t.pos=e.cueCardLoc,t.cueCardHeight=e.cueCardHeight,t.cueCardWidth=e.cueCardWidth,t.xPaddingPercent=.15,t.xPadding=t.xPaddingPercent*t.cueCardWidth/4,t.symbolWidth=(1-t.xPaddingPercent)*t.cueCardWidth/3,t.yPaddingPercent=.2,t.yPadding=t.yPaddingPercent*t.cueCardHeight/2,t.symbolHeight=(1-t.yPaddingPercent)*t.cueCardHeight,t._setUpBackground(),t._setUpTimer(t.timer),t._setUpPropSymbol(e.requiredProp),t._setUpCostumeSymbol(e.requiredCostume),t._setUpFailedPropSymbol(),t._setUpFailedCostumeSymbol(),t}return s(p,o),p.prototype.onInitialize=function(e){},p.prototype.pause=function(){this._running=!1,this.timerAnimation.pause()},p.prototype.play=function(){this._running=!0,this.timerAnimation.play()},p.prototype.update=function(e,t){if(this._running)if(this.timer-=t/1e3,this.timer<=0){var i=new n(this);this.scene.emit(a.CueCardExpired,i),this.kill()}else!0===(0,r.stats)().isGameOver&&this.pause()},p.prototype.kill=function(){o.prototype.kill.call(this)},p.prototype.Satisfied=function(){var e=new n(this);this.scene.emit(a.CueCardSatisfied,e),this.kill()},p.prototype._calculateRelativePosition=function(t){var i=t*this.xPadding,r=(t-1)*this.symbolWidth;return(0,e.vec)(this.pos.x+i+r,this.pos.y+this.yPadding)},p.prototype._setUpBackground=function(){var i=this.graphics.createLayer({name:"background",order:-1}),r=e.Graphics.Sprite.from(t.Resources.cuecardBaseImage);i.offset=this.pos.add((0,e.vec)(90,-50)),i.show(r)},p.prototype._setUpTimer=function(i){var r=e.Graphics.SpriteSheet.fromGrid({image:t.Resources.cuecardTimerSheet,grid:{rows:1,columns:38,spriteWidth:53,spriteHeight:52}}),o=e.Graphics.Animation.fromSpriteSheet(r,e.Util.range(0,37),1e3*i/38,e.Graphics.AnimationStrategy.Freeze),a=this.graphics.createLayer({name:"timer",order:0});a.offset=this.pos.add((0,e.vec)(174,90)),a.show(o),this.timerAnimation=o},p.prototype._setUpLocationSymbol=function(e){var t=this.graphics.createLayer({name:"locationSymbol",order:2});t.offset=this._calculateRelativePosition(1);var r=i.default.getIconSprite(e);this._setUpSymbolWidthHeight(r),t.show(r)},p.prototype._setUpSymbolWidthHeight=function(e){},p.prototype._setUpPropSymbol=function(e){var t=this.graphics.createLayer({name:"propSymbol",order:3});t.offset=this._calculateRelativePosition(2);var r=i.default.getIconSprite(e);this._setUpSymbolWidthHeight(r),t.show(r)},p.prototype._setUpCostumeSymbol=function(e){var t=this.graphics.createLayer({name:"costumeSymbol",order:4});t.offset=this._calculateRelativePosition(3);var r=i.default.getIconSprite(e);this._setUpSymbolWidthHeight(r),t.show(r)},p.prototype._setUpFailedPropSymbol=function(){this.graphics.createLayer({name:"failedPropSymbol",order:5}).offset=this._calculateRelativePosition(2)},p.prototype._setUpFailedCostumeSymbol=function(){this.graphics.createLayer({name:"failedCostumeSymbol",order:5}).offset=this._calculateRelativePosition(3)},p.prototype.showFailedCostume=function(){var e,t=i.default.getIconSprite("redCheck");null===(e=this.graphics.getLayer("failedCostumeSymbol"))||void 0===e||e.show(t),this.pause()},p.prototype.showFailedProp=function(){var e,t=i.default.getIconSprite("redCheck");null===(e=this.graphics.getLayer("failedPropSymbol"))||void 0===e||e.show(t),this.pause()},p}(e.Actor);exports.CueCard=p;
},{"excalibur":"A6Lr","./resources":"x5mp","./items":"p7mH","./session":"cTZz"}],"Lzjl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CueCardManager=void 0;var e=require("./cuecard"),t=require("excalibur"),a=require("./constants"),r=d(require("./config")),s=require("./session"),i=require("./resources");function d(e){return e&&e.__esModule?e:{default:e}}var u=function(){function d(e){this._random=new t.Random(r.default.RandomSeed),this.cardPadding=r.default.CueCardPadding,this.cardTopOffset=r.default.CueCardTopOffset,this.cueCardHeight=r.default.CueCardHeight,this.cueCardWidth=r.default.CueCardWidth,this.scene=e,this.eventDispatcher=this.scene.eventDispatcher,this.SetUpEventHooks()}return d.prototype.start=function(){this.stageLeftCueCard=this._GenerateCueCard(1),this.stageCenterCueCard=this._GenerateCueCard(2),this.stageRightCueCard=this._GenerateCueCard(3),this.scene.add(this.stageLeftCueCard),this.scene.add(this.stageCenterCueCard),this.scene.add(this.stageRightCueCard)},d.prototype._calculateCueCardPosition=function(e){var a=this.cardPadding*(e-1),r=this.cueCardWidth*(e-1);return(0,t.vec)(a+r,this.cardTopOffset)},d.prototype.SetUpEventHooks=function(){this.eventDispatcher.on(e.CueCardEvents.CueCardExpired,this.CueCardExpiredEvent.bind(this)),this.eventDispatcher.on(e.CueCardEvents.CueCardSatisfied,this.CueCardSatisfiedEvent.bind(this))},d.prototype.randomEnum=function(e){var t=Object.keys(e);return t[this._random.integer(0,t.length-1)]},d.prototype._GenerateCueCard=function(t){var s=new e.CueCard({lifeTime:this._random.integer(r.default.CueCardLifeMinSeconds,r.default.CueCardLifeMaxSeconds),requiredCostume:this.randomEnum(a.Costumes),requiredLocation:Object.keys(a.Locations)[t-1],requiredProp:this.randomEnum(a.StageProps),cueCardHeight:this.cueCardHeight,cueCardWidth:this.cueCardWidth,cueCardLoc:this._calculateCueCardPosition(t)});switch(t){case 1:this.scene.leftSpotlight.setCueCard(s);break;case 2:this.scene.centerSpotlight.setCueCard(s);break;case 3:this.scene.rightSpotlight.setCueCard(s)}return s},d.prototype.CueCardExpiredEvent=function(e){var t=this;(0,s.stats)().reduceAudienceMeter(r.default.ScoreLossPerMissedCard),setTimeout(function(){t.ReplaceCueCard(e.cueCard)},r.default.CueCardFailReplacementDelay),i.Resources.sndCardExpired.play()},d.prototype.CueCardSatisfiedEvent=function(e){var t=this;setTimeout(function(){t.ReplaceCueCard(e.cueCard)},r.default.CueCardSuccessReplacementDelay),e.cueCard.failed||i.Resources.sndCardSuccess.play(),(0,s.stats)().numLinesDelivered++,(0,s.stats)().numLinesDelivered>=r.default.NumCueCardsToWin&&((0,s.stats)().isGameOver=!0)},d.prototype.ReplaceCueCard=function(e){e==this.stageLeftCueCard?(this.stageLeftCueCard=this._GenerateCueCard(1),this.scene.add(this.stageLeftCueCard)):e==this.stageCenterCueCard?(this.stageCenterCueCard=this._GenerateCueCard(2),this.scene.add(this.stageCenterCueCard)):e==this.stageRightCueCard&&(this.stageRightCueCard=this._GenerateCueCard(3),this.scene.add(this.stageRightCueCard))},d.prototype._trySatisfyCueCard=function(e,t){var a=e.getQueueCardScore(t);return(0,s.stats)().increaseAudienceMeter(a),a},d.prototype.SatisfyStageLeft=function(e){var t=this,a=this._trySatisfyCueCard(e,this.stageLeftCueCard);return setTimeout(function(){t.stageLeftCueCard.Satisfied()},this.stageLeftCueCard.failed?1e3:0),this.stageLeftCueCard.failed&&i.Resources.sndNope.play(),a},d.prototype.SatisfyStageCenter=function(e){var t=this,a=this._trySatisfyCueCard(e,this.stageCenterCueCard);return setTimeout(function(){t.stageCenterCueCard.Satisfied()},this.stageCenterCueCard.failed?1e3:0),this.stageCenterCueCard.failed&&i.Resources.sndNope.play(),a},d.prototype.SatisfyStageRight=function(e){var t=this,a=this._trySatisfyCueCard(e,this.stageRightCueCard);return setTimeout(function(){t.stageRightCueCard.Satisfied()},this.stageRightCueCard.failed?1e3:0),this.stageRightCueCard.failed&&i.Resources.sndNope.play(),a},d}();exports.CueCardManager=u;
},{"./cuecard":"Tvvj","excalibur":"A6Lr","./constants":"RhqW","./config":"foLc","./session":"cTZz","./resources":"x5mp"}],"g0sH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CueCardTrigger=exports.StageTriggerLocation=void 0;var t=require("excalibur"),e=require("./session"),i=r(require("./config"));function r(t){return t&&t.__esModule?t:{default:t}}var o,a=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();exports.StageTriggerLocation=o,function(t){t[t.StageLeft=0]="StageLeft",t[t.StageCenter=1]="StageCenter",t[t.StageRight=2]="StageRight"}(o||(exports.StageTriggerLocation=o={}));var s=function(r){function s(t,e,o,a){var s=r.call(this,a)||this;return s.player=t,s.cueCardManager=e,s.triggerPosition=o,s.triggered=!1,s.waitTime=i.default.CueCardScoreDelaySeconds,s.timer=0,s.minAlpha=.1,s.maxAlpha=.6,s._cueCard=null,s.active=!0,s}return a(s,r),s.prototype.onInitialize=function(){this.trigger=new t.Trigger({width:this.width,height:this.height,pos:this.pos,target:this.player,repeat:-1}),this.trigger.body.useBoxCollider(this.width,this.height,this.anchor),this.trigger.on("enter",this.onTriggerEnter.bind(this)),this.trigger.on("exit",this.onTriggerExit.bind(this)),this.rect=new t.Graphics.Circle({radius:this.width/2,color:t.Color.Yellow,lineDash:[5,3],lineWidth:3,strokeColor:t.Color.White,padding:1}),this.rect.color.a=this.minAlpha,this.graphics.add(this.rect),this.scene.add(this.trigger)},s.prototype.setCueCard=function(t){this._cueCard=t},s.prototype.update=function(i,a){if(r.prototype.update.call(this,i,a),this.triggered&&this.active&&this._cueCard&&(this.timer+=a/1e3,this.rect.color.a=this.maxAlpha*this.timer/this.waitTime+this.minAlpha,this.timer>=this.waitTime)){switch(t.Logger.getInstance().info("Stage trigger",this.triggerPosition),this.triggerPosition){case o.StageCenter:this.cueCardManager.SatisfyStageCenter((0,e.stats)().inventory),this._cueCard=null;break;case o.StageLeft:this.cueCardManager.SatisfyStageLeft((0,e.stats)().inventory),this._cueCard=null;break;case o.StageRight:this.cueCardManager.SatisfyStageRight((0,e.stats)().inventory),this._cueCard=null}this._reset()}},s.prototype._reset=function(){this.triggered=!1,this.timer=0,this.rect.opacity=1,this.rect.color.a=this.minAlpha},s.prototype.onTriggerEnter=function(t){var e;this.triggered=!0,null===(e=this._cueCard)||void 0===e||e.pause()},s.prototype.onTriggerExit=function(t){var e,i;this._reset(),(null===(e=this._cueCard)||void 0===e?void 0:e.failed)||null===(i=this._cueCard)||void 0===i||i.play()},s}(t.Actor);exports.CueCardTrigger=s;
},{"excalibur":"A6Lr","./session":"cTZz","./config":"foLc"}],"G1XI":[function(require,module,exports) {
var define;
var e;!function(){"use strict";var r={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var a=typeof o;if("string"===a||"number"===a)e.push(o);else if(Array.isArray(o)&&o.length){var s=n.apply(null,o);s&&e.push(s)}else if("object"===a)for(var u in o)r.call(o,u)&&o[u]&&e.push(u)}}return e.join(" ")}"undefined"!=typeof module&&module.exports?(n.default=n,module.exports=n):"function"==typeof e&&"object"==typeof e.amd&&e.amd?e("classnames",[],function(){return n}):window.classNames=n}();
},{}],"OlbK":[function(require,module,exports) {
var global = arguments[3];
var n=arguments[3],t=o(),r=u(),e=c(),i="undefined"!=typeof window?window:n;function o(){return Object.assign?Object.assign:function(n,t,r,e){for(var i=1;i<arguments.length;i++)l(Object(arguments[i]),function(t,r){n[r]=t});return n}}function u(){if(Object.create)return function(n,r,e,i){var o=a(arguments,1);return t.apply(this,[Object.create(n)].concat(o))};{function n(){}return function(r,e,i,o){var u=a(arguments,1);return n.prototype=r,t.apply(this,[new n].concat(u))}}}function c(){return String.prototype.trim?function(n){return String.prototype.trim.call(n)}:function(n){return n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function f(n,t){return function(){return t.apply(n,Array.prototype.slice.call(arguments,0))}}function a(n,t){return Array.prototype.slice.call(n,t||0)}function l(n,t){s(n,function(n,r){return t(n,r),!1})}function p(n,t){var r=y(n)?[]:{};return s(n,function(n,e){return r[e]=t(n,e),!1}),r}function s(n,t){if(y(n)){for(var r=0;r<n.length;r++)if(t(n[r],r))return n[r]}else for(var e in n)if(n.hasOwnProperty(e)&&t(n[e],e))return n[e]}function y(n){return null!=n&&"function"!=typeof n&&"number"==typeof n.length}function b(n){return n&&"[object Function]"==={}.toString.call(n)}function g(n){return n&&"[object Object]"==={}.toString.call(n)}module.exports={assign:t,create:r,trim:e,bind:f,slice:a,each:l,map:p,pluck:s,isList:y,isFunction:b,isObject:g,Global:i};
},{}],"iLeD":[function(require,module,exports) {
var e=require("./util"),t=e.slice,n=e.pluck,r=e.each,i=e.bind,a=e.create,s=e.isList,o=e.isFunction,u=e.isObject;module.exports={createStore:f};var c={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(n,r){e.call(t,t._deserialize(n),(r||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return f.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return f(this.storage,this.plugins,e)}};function l(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)}function f(e,f,h){h||(h=""),e&&!s(e)&&(e=[e]),f&&!s(f)&&(f=[f]);var d=h?"__storejs_"+h+"_":"",p=h?new RegExp("^"+d):null;if(!/^[a-zA-Z0-9_\-]*$/.test(h))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var g=a({_namespacePrefix:d,_namespaceRegexp:p,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(r){return!1}},_assignPluginFnProp:function(e,n){var i=this[n];this[n]=function(){var n=t(arguments,0),a=this;var s=[function(){if(i)return r(arguments,function(e,t){n[t]=e}),i.apply(a,n)}].concat(n);return e.apply(a,s)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(r){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(s(e))r(e,function(e){t._addPlugin(e)});else if(!n(this.plugins,function(t){return e===t})){if(this.plugins.push(e),!o(e))throw new Error("Plugins must be function values that return objects");var i=e.call(this);if(!u(i))throw new Error("Plugins must return an object of function properties");r(i,function(n,r){if(!o(n))throw new Error("Bad plugin property: "+r+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,r)})}},addStorage:function(e){l("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},c,{plugins:[]});return g.raw={},r(g,function(e,t){o(e)&&(g.raw[t]=i(g,e))}),r(e,function(e){g._addStorage(e)}),r(f,function(e){g._addPlugin(e)}),g}
},{"./util":"OlbK"}],"ydJg":[function(require,module,exports) {
var e=require("../src/util"),r=e.Global;function t(){return r.localStorage}function n(e){return t().getItem(e)}function o(e,r){return t().setItem(e,r)}function u(e){for(var r=t().length-1;r>=0;r--){var o=t().key(r);e(n(o),o)}}function a(e){return t().removeItem(e)}function l(){return t().clear()}module.exports={name:"localStorage",read:n,write:o,each:u,remove:a,clearAll:l};
},{"../src/util":"OlbK"}],"qnPi":[function(require,module,exports) {
var e=require("../src/util"),r=e.Global;module.exports={name:"oldFF-globalStorage",read:n,write:t,each:l,remove:a,clearAll:u};var o=r.globalStorage;function n(e){return o[e]}function t(e,r){o[e]=r}function l(e){for(var r=o.length-1;r>=0;r--){var n=o.key(r);e(o[n],n)}}function a(e){return o.removeItem(e)}function u(){l(function(e,r){delete o[e]})}
},{"../src/util":"OlbK"}],"ajOM":[function(require,module,exports) {
var e=require("../src/util"),t=e.Global;module.exports={name:"oldIE-userDataStorage",write:o,read:u,each:c,remove:l,clearAll:m};var n="storejs",r=t.document,a=f(),i=(t.navigator?t.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);function o(e,t){if(!i){var r=d(e);a(function(e){e.setAttribute(r,t),e.save(n)})}}function u(e){if(!i){var t=d(e),n=null;return a(function(e){n=e.getAttribute(t)}),n}}function c(e){a(function(t){for(var n=t.XMLDocument.documentElement.attributes,r=n.length-1;r>=0;r--){var a=n[r];e(t.getAttribute(a.name),a.name)}})}function l(e){var t=d(e);a(function(e){e.removeAttribute(t),e.save(n)})}function m(){a(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(n);for(var r=t.length-1;r>=0;r--)e.removeAttribute(t[r].name);e.save(n)})}var v=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function d(e){return e.replace(/^\d/,"___$&").replace(v,"___")}function f(){if(!r||!r.documentElement||!r.documentElement.addBehavior)return null;var e,t,a;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,a=e.createElement("div")}catch(i){a=r.createElement("div"),e=r.body}return function(t){var r=[].slice.call(arguments,0);r.unshift(a),e.appendChild(a),a.addBehavior("#default#userData"),a.load(n),t.apply(this,r),e.removeChild(a)}}
},{"../src/util":"OlbK"}],"zpTn":[function(require,module,exports) {
var e=require("../src/util"),c=e.Global,n=e.trim;module.exports={name:"cookieStorage",read:a,write:i,each:o,remove:t,clearAll:p};var r=c.document;function a(e){if(!e||!s(e))return null;var c="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(r.cookie.replace(new RegExp(c),"$1"))}function o(e){for(var c=r.cookie.split(/; ?/g),a=c.length-1;a>=0;a--)if(n(c[a])){var o=c[a].split("="),i=unescape(o[0]);e(unescape(o[1]),i)}}function i(e,c){e&&(r.cookie=escape(e)+"="+escape(c)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function t(e){e&&s(e)&&(r.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function p(){o(function(e,c){t(c)})}function s(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(r.cookie)}
},{"../src/util":"OlbK"}],"XZsG":[function(require,module,exports) {
var e=require("../src/util"),r=e.Global;function t(){return r.sessionStorage}function n(e){return t().getItem(e)}function o(e,r){return t().setItem(e,r)}function u(e){for(var r=t().length-1;r>=0;r--){var o=t().key(r);e(n(o),o)}}function a(e){return t().removeItem(e)}function i(){return t().clear()}module.exports={name:"sessionStorage",read:n,write:o,each:u,remove:a,clearAll:i};
},{"../src/util":"OlbK"}],"Ditp":[function(require,module,exports) {
module.exports={name:"memoryStorage",read:n,write:r,each:o,remove:t,clearAll:a};var e={};function n(n){return e[n]}function r(n,r){e[n]=r}function o(n){for(var r in e)e.hasOwnProperty(r)&&n(e[r],r)}function t(n){delete e[n]}function a(n){e={}}
},{}],"QNYQ":[function(require,module,exports) {
module.exports=[require("./localStorage"),require("./oldFF-globalStorage"),require("./oldIE-userDataStorage"),require("./cookieStorage"),require("./sessionStorage"),require("./memoryStorage")];
},{"./localStorage":"ydJg","./oldFF-globalStorage":"qnPi","./oldIE-userDataStorage":"ajOM","./cookieStorage":"zpTn","./sessionStorage":"XZsG","./memoryStorage":"Ditp"}],"FFlA":[function(require,module,exports) {
"object"!=typeof JSON&&(JSON={}),function(){"use strict";var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(t){return t<10?"0"+t:t}function this_value(){return this.valueOf()}function quote(t){return rx_escapable.lastIndex=0,rx_escapable.test(t)?'"'+t.replace(rx_escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var r,n,o,u,f,a=gap,i=e[t];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(t)),"function"==typeof rep&&(i=rep.call(e,t,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,f=[],"[object Array]"===Object.prototype.toString.apply(i)){for(u=i.length,r=0;r<u;r+=1)f[r]=str(r,i)||"null";return o=0===f.length?"[]":gap?"[\n"+gap+f.join(",\n"+gap)+"\n"+a+"]":"["+f.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(u=rep.length,r=0;r<u;r+=1)"string"==typeof rep[r]&&(o=str(n=rep[r],i))&&f.push(quote(n)+(gap?": ":":")+o);else for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o=str(n,i))&&f.push(quote(n)+(gap?": ":":")+o);return o=0===f.length?"{}":gap?"{\n"+gap+f.join(",\n"+gap)+"\n"+a+"}":"{"+f.join(",")+"}",gap=a,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;n<r;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var r,n,o=t[e];if(o&&"object"==typeof o)for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(void 0!==(n=walk(o,r))?o[r]=n:delete o[r]);return reviver.call(t,e,o)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();
},{}],"LxJh":[function(require,module,exports) {
function e(){return require("./lib/json2"),{}}module.exports=e;
},{"./lib/json2":"FFlA"}],"Xqes":[function(require,module,exports) {
var e=require("../src/store-engine"),r=require("../storages/all"),s=[require("../plugins/json2")];module.exports=e.createStore(r,s);
},{"../src/store-engine":"iLeD","../storages/all":"QNYQ","../plugins/json2":"LxJh"}],"B9Wb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.resetPreferences=o,exports.savePreferences=f,exports.loadPreferences=u,exports.Preferences=void 0;var e=r(require("store"));function r(e){return e&&e.__esModule?e:{default:e}}var t=function(){return(t=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var s in r=arguments[t])Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);return e}).apply(this,arguments)},n={muteBackgroundMusic:!1,muteAll:!1};exports.Preferences=n;var s=t({},n);function o(){exports.Preferences=n=t({},s)}function f(){e.default.set("pref",n)}function u(){exports.Preferences=n=t(t({},n),e.default.get("pref"))}
},{"store":"Xqes"}],"sNsT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoundManager=void 0;var e=require("excalibur"),u=n(require("classnames")),c=n(require("./config")),r=require("./preferences"),s=require("./resources");function n(e){return e&&e.__esModule?e:{default:e}}var o=function(){function n(){}return n.setSoundSpecificVolume=function(){s.Resources.sndCardExpired.volume=c.default.CueCardExpiredVolume,s.Resources.sndCardSuccess.volume=c.default.CueCardSuccessVolume,s.Resources.sndDoorOpen.volume=c.default.DoorOpenVolume,s.Resources.sndPickupItem.volume=c.default.PickupItemVolume},n.init=function(){n.setSoundSpecificVolume(),r.Preferences.muteBackgroundMusic&&n.muteBackgroundMusic(),r.Preferences.muteAll&&n.muteAll(),$("#mute-music").on("click",function(){return r.Preferences.muteBackgroundMusic?n.unmuteBackgroundMusic():n.muteBackgroundMusic(),(0,r.savePreferences)(),!1}),$("#mute-all").on("click",function(){return r.Preferences.muteAll?n.unmuteAll():n.muteAll(),(0,r.savePreferences)(),!1})},n.muteAll=function(){for(var u in r.Preferences.muteAll=!0,r.Preferences.muteBackgroundMusic=!0,s.Resources){var c=s.Resources[u];c instanceof e.Sound&&(c.volume=0)}n.muteBackgroundMusic(),n._updateMuteAllButton()},n.unmuteAll=function(){for(var u in r.Preferences.muteAll=!1,r.Preferences.muteBackgroundMusic=!1,s.Resources){var o=s.Resources[u];o instanceof e.Sound&&(o.volume=c.default.SoundVolume)}n.setSoundSpecificVolume(),n.unmuteBackgroundMusic(),n._updateMuteAllButton()},n.startBackgroundMusic=function(){s.Resources.music.volume=r.Preferences.muteBackgroundMusic?0:c.default.BackgroundVolume,s.Resources.music.loop=!0,s.Resources.music.isPlaying()||s.Resources.music.play()},n.stopBackgroundMusic=function(){s.Resources.music.loop=!1},n.muteBackgroundMusic=function(){r.Preferences.muteBackgroundMusic=!0,s.Resources.music.volume=0,n._updateMusicButton()},n.unmuteBackgroundMusic=function(){r.Preferences.muteBackgroundMusic=!1,s.Resources.music.volume=c.default.BackgroundVolume,n._updateMusicButton()},n._updateMusicButton=function(){$("#mute-music i").get(0).className=(0,u.default)("fa",{"fa-music":!r.Preferences.muteBackgroundMusic,"fa-play":r.Preferences.muteBackgroundMusic})},n._updateMuteAllButton=function(){$("#mute-all i").get(0).className=(0,u.default)("fa",{"fa-volume-up":!r.Preferences.muteAll,"fa-volume-off":r.Preferences.muteAll})},n}();exports.SoundManager=o;
},{"excalibur":"A6Lr","classnames":"G1XI","./config":"foLc","./preferences":"B9Wb","./resources":"x5mp"}],"oYuA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DialogCard=void 0;var t=require("excalibur"),r=require("./resources"),e=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function i(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),i=function(){return(i=Object.assign||function(t){for(var r,e=1,i=arguments.length;e<i;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t}).apply(this,arguments)},o=function(o){function n(t,r){var e=o.call(this,i(i({},r),{width:837,height:480}))||this;return e.text=t,e.topPadding=r.topPadding||0,e}return e(n,o),n.prototype.onInitialize=function(){var e=[];e.push({graphic:t.Graphics.Sprite.from(r.Resources.titleCard),pos:(0,t.vec)(0,0)});for(var i=0;i<this.text.length;i++)e.push({graphic:new t.Graphics.Text({text:this.text[i],color:t.Color.White,font:new t.Graphics.Font({family:"Century, Georgia, serif",size:36,textAlign:t.Graphics.TextAlign.Center})}),pos:(0,t.vec)(this.width/2,this.height*((i+1)/(this.text.length+1))+this.topPadding)});var o=new t.Graphics.GraphicsGroup({members:e});o.width=this.width,o.height=this.height,this.graphics.add(o)},n}(t.Actor);exports.DialogCard=o;
},{"excalibur":"A6Lr","./resources":"x5mp"}],"VSYx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DirectorNPC=void 0;var e=require("excalibur"),t=i(require("./config")),r=require("./dialogCard");function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),n=function(i){function n(e,t){var r=i.call(this,t)||this;return r._player=e,r}return o(n,i),n.prototype.onInitialize=function(e){this._engine=e,this._setupDrawing()},n.prototype.playGreetingSequence=function(){var t=this,i=(0,e.vec)(this._engine.halfDrawWidth,this._engine.halfDrawHeight),o=new r.DialogCard(["You're late! The audience is waiting..."],{pos:i}),n=new r.DialogCard(["Get ready and get out there!"],{pos:i}),a=new r.DialogCard(["(Use the arrow keys or WASD keys to move)"],{pos:i});return this.scene.add(a),this.scene.add(n),this.scene.add(o),this.actions.delay(4e3).callMethod(function(){o.kill()}).delay(4e3).callMethod(function(){n.kill()}).delay(4e3).callMethod(function(){a.kill(),t._player.AllowUserControl()}).asPromise()},n.prototype._setupDrawing=function(){var r,i=e.Graphics.SpriteSheet.fromGrid({image:this._player.getCharSprite(!0),grid:{rows:1,columns:10,spriteHeight:t.default.PlayerSpriteHeight,spriteWidth:t.default.PlayerSpriteWidth}}).sprites[9];null===(r=i.origin)||void 0===r||r.setTo(0,.2),this.graphics.add(i)},n}(e.Actor);exports.DirectorNPC=n;
},{"excalibur":"A6Lr","./config":"foLc","./dialogCard":"oYuA"}],"MDFX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AudienceMeter=void 0;var e=require("excalibur"),t=o(require("./config")),r=require("./session"),i=require("./resources");function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),n=function(o){function n(r){var i=o.call(this,{x:t.default.GameWidth/2,y:0,width:t.default.AudienceMeterMaxWidth,height:t.default.AudienceMeterHeight,anchor:(0,e.vec)(.5,0)})||this;return i.meterWidth=t.default.AudienceMeterMaxWidth,i.meterHeight=t.default.AudienceMeterHeight,i.meterSpeed=3,i.started=!1,i._tomatoes=r,i._setUpMeter(),i}return a(n,o),n.prototype.start=function(){this.started=!0,this.graphics.getLayer("meter").show(this._meterAnim)},n.prototype.update=function(e,i){o.prototype.update.call(this,e,i),this.started&&((0,r.stats)().reduceAudienceMeter(t.default.ScoreDecayRate*i/1e3),this._meterAnim.goToFrame(127-Math.floor((0,r.stats)().currentAudienceScore/t.default.AudienceMeterMaxWidth*128)),(0,r.stats)().currentAudienceScore/t.default.AudienceMeterMaxWidth<=t.default.TomatoPercentage&&this._tomatoes.show(),0==(0,r.stats)().currentAudienceScore&&((0,r.stats)().isGameOver=!0),this.started=!(0,r.stats)().isGameOver)},n.prototype._setUpMeter=function(){this.graphics.createLayer({name:"meter",order:0});this.meterRect=new e.Graphics.Rect({width:(0,r.stats)().currentAudienceScore,height:this.meterHeight,color:e.Color.Green});var o=e.Graphics.SpriteSheet.fromGrid({image:i.Resources.audienceMeterSheet,grid:{rows:128,columns:1,spriteWidth:934,spriteHeight:40}});this._meterAnim=e.Graphics.Animation.fromSpriteSheet(o,e.Util.range(0,127),200,e.Graphics.AnimationStrategy.Freeze),this._meterAnim.pause(),this._meterAnim.goToFrame(127-Math.floor(t.default.AudienceMeterStartingWidth/t.default.AudienceMeterMaxWidth*128))},n}(e.Actor);exports.AudienceMeter=n;
},{"excalibur":"A6Lr","./config":"foLc","./session":"cTZz","./resources":"x5mp"}],"QWkJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tomatoes=void 0;var e=require("excalibur"),t=r(require("./items")),i=r(require("./config"));function r(e){return e&&e.__esModule?e:{default:e}}var o=function(){function r(r){this._emitter=new e.ParticleEmitter({pos:(0,e.vec)(i.default.GameWidth/2,100),emitterType:e.EmitterType.Circle,radius:200,minVel:417,maxVel:589,minAngle:Math.PI,maxAngle:0,isEmitting:!1,emitRate:5,opacity:1,fadeFlag:!0,particleLife:2e3,maxSize:.75,minSize:.75,sprite:t.default.getIconSprite("tomato"),particleRotationalVelocity:Math.PI/2,randomRotation:!0}),r.add(this._emitter)}return r.prototype.show=function(){this._emitter.isEmitting=!0},r.prototype.hide=function(){this._emitter.isEmitting=!1},r}();exports.Tomatoes=o;
},{"excalibur":"A6Lr","./items":"p7mH","./config":"foLc"}],"g1KF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Theater=void 0;var e=require("excalibur"),t=p(require("./config")),r=require("./resources"),i=require("./cuecardmanager"),a=require("./player"),n=require("./cuecardtrigger"),o=require("./constants"),s=l(require("./items")),g=require("./soundManager"),c=require("./director"),u=require("./audienceMeter"),h=require("./tomatoEmitter");function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(r,a,n):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function p(e){return e&&e.__esModule?e:{default:e}}var f=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),y="walls",m="triggers",S="items",T="costume",w="stageProp",v={StageLeftTrigger:"stageLeftTrigger",StageCenterTrigger:"stageCenterTrigger",StageRightTrigger:"stageRightTrigger"},M=function(d){function l(){return null!==d&&d.apply(this,arguments)||this}return f(l,d),l.prototype.onInitialize=function(n){var o=this;this.tomatoes=new h.Tomatoes(this),window.tomatoes=this.tomatoes,this.cuecardmanager=new i.CueCardManager(this),this.audienceMeter=new u.AudienceMeter(this.tomatoes),this.add(this.audienceMeter),this.player=new a.Player(t.default.GameWidth,t.default.GameHeight-1.5*t.default.PlayerHeight),this.add(this.player),this.director=new c.DirectorNPC(this.player,{pos:(0,e.vec)(t.default.GameWidth-4*t.default.PlayerWidth,t.default.GameHeight-1.5*t.default.PlayerHeight)}),this.add(this.director),this.stageTileMap=r.Resources.map.getTileMap(t.default.StagePos.x,t.default.StagePos.y),this.stageTileMap.data.forEach(function(e){return e.transform.z=-3}),this.add(this.stageTileMap),r.Resources.map.data.layers.forEach(function(e){o.collectSolidTiles(e),o.collectStageTriggers(e)}),this.spawnItems();var s=new e.Actor({width:50,height:50,x:t.default.GameWidth/2,y:t.default.GameHeight/2});s.graphics.add(e.Graphics.Sprite.from(r.Resources.background)),this.add(s),s.z=-4},l.prototype.onActivate=function(){var e=this;g.SoundManager.startBackgroundMusic(),this.player.beginEnterStage().then(function(){return e.director.playGreetingSequence()}).then(function(){e.director.kill(),e.cuecardmanager.start(),e.audienceMeter.start()})},l.prototype.collectSolidTiles=function(e){if(e.name===y&&"string"!=typeof e.data&&e.data)for(var t=0;t<e.data.length;t++)0!==e.data[t]&&(this.stageTileMap.data[t].solid=!0)},l.prototype.collectStageTriggers=function(t){if(t.name===m&&"string"!=typeof t.data&&t.objects)for(var r=0,i=t.objects;r<i.length;r++){var a=i[r],o={anchor:(0,e.vec)(0,0),pos:(0,e.vec)(this.stageTileMap.x+a.x,this.stageTileMap.y+a.y),width:a.width,height:a.height};switch(a.name){case v.StageLeftTrigger:this.leftSpotlight=new n.CueCardTrigger(this.player,this.cuecardmanager,n.StageTriggerLocation.StageLeft,o),this.add(this.leftSpotlight),this.leftSpotlight.setZIndex(-2);break;case v.StageCenterTrigger:this.centerSpotlight=new n.CueCardTrigger(this.player,this.cuecardmanager,n.StageTriggerLocation.StageCenter,o),this.add(this.centerSpotlight),this.centerSpotlight.setZIndex(-2);break;case v.StageRightTrigger:this.rightSpotlight=new n.CueCardTrigger(this.player,this.cuecardmanager,n.StageTriggerLocation.StageRight,o),this.add(this.rightSpotlight),this.rightSpotlight.setZIndex(-2)}}},l.prototype.spawnItems=function(){for(var e=this.getPoints(T),t=this.getPoints(w),r=Object.keys(o.StageProps),i=Object.keys(o.Costumes),a=0;a<r.length;a++){var n=r[a],g=t[a],c=s.default.getIconSprite(n),u=new s.Item("prop",n,c,g.x,g.y);this.add(u)}for(a=0;a<i.length;a++){n=i[a],g=e[a],c=s.default.getIconSprite(n),u=new s.Item("costume",n,c,g.x,g.y);this.add(u)}},l.prototype.getPoints=function(t){for(var i=r.Resources.map.data.layers.find(function(e){return"items"==e.name}),a=[],n=0;n<i.objects.length;n++){var o=i.objects[n];o.type==t&&a.push(new e.Vector(o.x+25,o.y+170))}return a},l}(e.Scene);exports.Theater=M;
},{"excalibur":"A6Lr","./config":"foLc","./resources":"x5mp","./cuecardmanager":"Lzjl","./player":"rXhO","./cuecardtrigger":"g0sH","./constants":"RhqW","./items":"p7mH","./soundManager":"sNsT","./director":"VSYx","./audienceMeter":"MDFX","./tomatoEmitter":"QWkJ"}],"UVGs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Inventory=void 0;var e=require("excalibur"),t=s(require("./items")),r=o(require("./config"));function o(e){return e&&e.__esModule?e:{default:e}}function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function s(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var n=o?Object.getOwnPropertyDescriptor(e,s):null;n&&(n.get||n.set)?Object.defineProperty(r,s,n):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}var n=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),p=function(o){function i(e,t,r){var i=o.call(this,t,r,200,80)||this;return i._engine=e,i._setUpLayers(),i}return n(i,o),i.prototype.update=function(r,i){if(o.prototype.update.call(this,r,i),this._prop){var s=t.default.getIconSprite(this._prop);(n=this.graphics.getLayer("prop")).offset=new e.Vector(0,0),null==n||n.show(s)}if(this._costume){s=t.default.getIconSprite(this._costume);var n=this.graphics.getLayer("costume"),p=2*this.width/3-15;n.offset=new e.Vector(p,0),null==n||n.show(s)}},i.prototype.addCostume=function(e,r){if(this._costume){var o=this._costume,i=t.default.getIconSprite(o),s=new t.Item("costume",o,i,this._costumeX,this._costumeY);this.scene.add(s)}this._costume=e,this._costumeX=r.x,this._costumeY=r.y},i.prototype.addProp=function(e,r){if(this._prop){var o=this._prop,i=t.default.getIconSprite(this._prop),s=new t.Item("prop",o,i,this._propX,this._propY);this.scene.add(s)}this._prop=e,this._propX=r.x,this._propY=r.y},i.prototype.getQueueCardScore=function(e){var t=r.default.ScoreBaseIncrease,o=0;return e.options.requiredProp==this._prop?o+=r.default.ScoreIncreasePerProp:(e.failed=!0,e.showFailedProp()),e.options.requiredCostume==this._costume?o+=r.default.ScoreIncreasePerProp:(e.failed=!0,e.showFailedCostume()),e.options.requiredCostume==this._costume&&e.options.requiredProp==this._prop&&(o*=r.default.ScoreMultiplier),e.options.requiredProp!=this._prop&&e.options.requiredCostume!=this._costume&&(o=-r.default.ScorePunishment),t+o},i.prototype._setUpLayers=function(){var t=this.graphics.createLayer({name:"background",order:-1});this.graphics.createLayer({name:"costume",order:1}),this.graphics.createLayer({name:"prop",order:2});var r=new e.Graphics.Rect({width:this.width,height:this.height,color:e.Color.ExcaliburBlue});t.offset=this.vel,r.opacity=.33,t.show(r)},i}(e.Actor);exports.Inventory=p;
},{"excalibur":"A6Lr","./items":"p7mH","./config":"foLc"}],"DKYC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Button=void 0;var t=require("excalibur"),r=require("./resources"),e=function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),o=function(){return(o=Object.assign||function(t){for(var r,e=1,o=arguments.length;e<o;e++)for(var n in r=arguments[e])Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}).apply(this,arguments)},n=function(n){function i(t,r){var e=n.call(this,o({},r))||this;return e.text=t,e}return e(i,n),i.prototype.onInitialize=function(){var e=new t.Graphics.GraphicsGroup({members:[{graphic:t.Graphics.Sprite.from(r.Resources.playAgainButton),pos:(0,t.vec)(-this.width/4,0)}]});e.width=this.width,e.height=this.height,this.graphics.add(e)},i}(t.Actor);exports.Button=n;
},{"excalibur":"A6Lr","./resources":"x5mp"}],"CAY5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameOver=void 0;var e=require("excalibur"),t=require("./dialogCard"),o=n(require("./config")),a=require("./button"),i=require("./session"),s=require("./resources");function n(e){return e&&e.__esModule?e:{default:e}}var r=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function a(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),u=function(n){function u(){return n.call(this,o.default.GameWidth/2,2*o.default.GameHeight,600,600)||this}return r(u,n),u.prototype.onInitialize=function(t){this.engine=t,this.backShadowLayer=this.graphics.createLayer({name:"backshadow",order:1}),this.backShadow=new e.Graphics.Rect({width:o.default.GameWidth+500,height:o.default.GameHeight+500,color:e.Color.fromRGB(51,51,51,.5)})},u.prototype.updateEndScreen=function(){var n=this,r=(0,e.vec)(this.pos.x,this.pos.y),u="The audience was not impressed";if((0,i.stats)().numLinesDelivered>=o.default.NumCueCardsToWin){var c="";s.Resources.applause.play();var h=(0,i.stats)().currentAudienceScore;h>=o.default.GreatScoreCutoff&&(c="great "),h>=o.default.RoaringScoreCutoff&&(c="roaring "),u="The show was a "+c+"success!"}else s.Resources.boo.play();var d="You changed costumes "+(0,i.stats)().numCostumeChanges+" times.",f="You used "+(0,i.stats)().numPropsUsed+" props.";this.card=new t.DialogCard([u,d,f,""],{pos:r,topPadding:30}),this.scene.add(this.card),this.card.z=100,this.z=100,this.button=new a.Button("Play Again?",{pos:r,width:200,height:100}),this.button.on("pointerup",function(){if(!n.button.isKilled()){for(var t=0,o=n.scene.actors;t<o.length;t++){o[t].kill()}n.engine.removeScene(n.scene),n.button.pos.add((0,e.vec)(1e4,1e4)),(0,i.newgame)(n.engine)}}),this.scene.add(this.button),this.button.z=100},u.prototype.show=function(){this.backShadowLayer.show(this.backShadow),this.pos=(0,e.vec)(0,0),this.card.actions.easeTo(o.default.GameWidth/2,o.default.GameHeight/2,500,e.EasingFunctions.EaseInOutCubic),this.button.actions.easeTo(o.default.GameWidth/2,o.default.GameHeight/2+125,500,e.EasingFunctions.EaseInOutCubic)},u.prototype.hide=function(){this.backShadowLayer.hide(),this.card.actions.easeTo(o.default.GameWidth/2,2*o.default.GameHeight,500,e.EasingFunctions.EaseInOutCubic),this.button.actions.easeTo(o.default.GameWidth/2,2*o.default.GameHeight,500,e.EasingFunctions.EaseInOutCubic)},u}(e.Actor);exports.GameOver=u;
},{"excalibur":"A6Lr","./dialogCard":"oYuA","./config":"foLc","./button":"DKYC","./session":"cTZz","./resources":"x5mp"}],"cTZz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.stats=i,exports.newgame=s,exports.gameover=d;var e,t=u(require("./config")),n=require("./stats"),r=require("./theater-scene"),a=require("./inventory"),o=require("./gameover");function u(e){return e&&e.__esModule?e:{default:e}}function i(){return e}function s(u){var i=new a.Inventory(u,t.default.GameWidth/2,t.default.GameHeight-40);e=new n.Stats(i);var s=new r.Theater(u),d=new o.GameOver;window.gameOver=d,s.add(i),s.add(d),u.addScene("main",s),u.goToScene("main");var c=!1;u.on("postupdate",function(t){c||e.isGameOver&&(d.updateEndScreen(),d.show(),e.publishStats().then(function(){console.log("Stats collected â¤")}),c=!0)})}function d(e){e.stop()}
},{"./config":"foLc","./stats":"Q9FA","./theater-scene":"g1KF","./inventory":"UVGs","./gameover":"CAY5"}],"B6dB":[function(require,module,exports) {
"use strict";var e=require("excalibur"),r=require("./resources"),n=require("./session"),a=i(require("./config")),o=require("./soundManager"),u=require("./preferences");function i(e){return e&&e.__esModule?e:{default:e}}e.Engine._useWebGL=!0;var s=new e.Engine({canvasElementId:"game",height:a.default.GameHeight,width:a.default.GameWidth,backgroundColor:e.Color.fromHex("#333333")}),t=new e.Loader;for(var d in t.backgroundColor="#333333",r.Resources)t.addResource(r.Resources[d]);(0,u.loadPreferences)(),o.SoundManager.init(),s.start(t).then(function(){(0,n.newgame)(s)}),window.game=s;
},{"excalibur":"A6Lr","./resources":"x5mp","./session":"cTZz","./config":"foLc","./soundManager":"sNsT","./preferences":"B9Wb"}]},{},["B6dB"], null)
//# sourceMappingURL=/ludum-46/src.56e9a63a.js.map